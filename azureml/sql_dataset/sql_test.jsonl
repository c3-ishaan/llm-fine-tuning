{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the availability rate for each product based on the number of times it was in stock when ordered?"}, {"role": "assistant", "content": "SELECT p.ProductName, COUNT(CASE WHEN p.UnitsInStock > 0 THEN 1 END) / COUNT(od.ProductID) AS AvailabilityRate FROM Products p INNER JOIN [Order Details] od ON p.ProductID = od.ProductID GROUP BY 1;"}], "prompt_id": "c2dd5441-fe5a-4180-b158-df2e8e0dfda9"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the average customer lifetime value (CLV) for customers in each region?"}, {"role": "assistant", "content": "SELECT Customers.Region, AVG([Order Details].UnitPrice * [Order Details].Quantity) * COUNT(DISTINCT Orders.OrderID) * AVG(julianday(Orders.ShippedDate) - julianday(Orders.OrderDate)) AS CLV FROM Customers INNER JOIN Orders ON Customers.CustomerID = Orders.CustomerID INNER JOIN [Order Details] ON Orders.OrderID = [Order Details].OrderID GROUP BY Customers.Region;"}], "prompt_id": "c1ea2d21-4777-4cba-87f1-1c038a7c5b5f"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:How many territories are covered by each employee and which employees cover the most or least territories?"}, {"role": "assistant", "content": "SELECT Employees.EmployeeID, COUNT(EmployeeTerritories.TerritoryID) AS TerritoryCount FROM Employees INNER JOIN EmployeeTerritories ON Employees.EmployeeID = EmployeeTerritories.EmployeeID GROUP BY Employees.EmployeeID"}], "prompt_id": "05d15439-b11a-4c14-9e94-2c4b59865fb5"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:How does the sales share of each product category compare to the total sales?"}, {"role": "assistant", "content": "SELECT C.CategoryName, SUM(OD.UnitPrice * OD.Quantity) / (SELECT SUM(UnitPrice * Quantity) FROM [Order Details]) AS SalesShare FROM Categories C JOIN Products P ON C.CategoryID = P.CategoryID JOIN [Order Details] OD ON P.ProductID = OD.ProductID GROUP BY C.CategoryName"}], "prompt_id": "629af432-97b8-4ace-855c-0768effeea0c"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the product availability rate when ordered?"}, {"role": "assistant", "content": "SELECT p.ProductID, (SELECT COUNT(*) FROM [Order Details] WHERE Quantity <= p.UnitsInStock) / COUNT(*) AS ProductAvailabilityRate FROM Products p INNER JOIN [Order Details] od ON p.ProductID = od.ProductID GROUP BY p.ProductID;"}], "prompt_id": "433e8500-587e-45d8-95d4-361504ac9030"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the revenue growth rate compared to the previous period?"}, {"role": "assistant", "content": "SELECT (SUM(UnitPrice * Quantity) - (SELECT SUM(UnitPrice * Quantity) FROM [Order Details] WHERE OrderDate BETWEEN 'previous_start_date' AND 'previous_end_date')) / (SELECT SUM(UnitPrice * Quantity) FROM [Order Details] WHERE OrderDate BETWEEN 'previous_start_date' AND 'previous_end_date') AS RevenueGrowthRate FROM [Order Details] WHERE OrderDate BETWEEN 'start_date' AND 'end_date'"}], "prompt_id": "fd77902a-56e6-40cb-b4b8-e46bed2125ee"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the average order value (AOV) for all orders?"}, {"role": "assistant", "content": "SELECT AVG([Order Details].UnitPrice * [Order Details].Quantity) AS AOV FROM [Order Details]"}], "prompt_id": "8b4233da-7735-4e2e-9b3c-b4332990b193"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the shipping efficiency rate for each shipping company?"}, {"role": "assistant", "content": "SELECT ShipVia, SUM(CASE WHEN ShippedDate <= RequiredDate THEN 1 ELSE 0 END) / COUNT(*) AS shipping_efficiency FROM Orders GROUP BY ShipVia"}], "prompt_id": "054ad9d5-6651-4dc1-965a-9092a28b91cf"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:14. What is the average customer lifetime value for all customers?"}, {"role": "assistant", "content": "SELECT CustomerID, AVG(AvgOrderValue * COUNT(OrderID)) AS CustomerLifetimeValue FROM (SELECT CustomerID, AVG(UnitPrice * Quantity) AS AvgOrderValue, COUNT(OrderID) AS NumOrders FROM [Order Details] GROUP BY CustomerID)"}], "prompt_id": "6f9a5b3e-0056-467e-b6ea-f712a10c4982"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the average order value for each category of products?"}, {"role": "assistant", "content": "SELECT Categories.CategoryName, AVG([Order Details].UnitPrice * [Order Details].Quantity) AS AvgOrderValue FROM Categories INNER JOIN Products ON Categories.CategoryID = Products.CategoryID INNER JOIN [Order Details] ON Products.ProductID = [Order Details].ProductID GROUP BY Categories.CategoryName"}], "prompt_id": "2e24ee5d-c738-4a72-b76e-3aeb89fdcd0c"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the attrition rate of employees within the past year?"}, {"role": "assistant", "content": "SELECT COUNT(EmployeeID) / (SELECT COUNT(EmployeeID) FROM Employees) AS AttritionRate FROM Employees WHERE HireDate <= DATEADD(year, DATEDIFF(year, 0, GETDATE()) - 1, 0)"}], "prompt_id": "ad610e8b-8a23-493c-a001-bf3021b71eae"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the sales performance of each employee in terms of average sales generated per order?"}, {"role": "assistant", "content": "SELECT e.EmployeeID, e.FirstName, e.LastName, SUM(od.UnitPrice * od.Quantity) / COUNT(o.OrderID) AS Sales_Performance FROM Employees e LEFT JOIN Orders o ON e.EmployeeID = o.EmployeeID LEFT JOIN [Order Details] od ON o.OrderID = od.OrderID GROUP BY e.EmployeeID, e.FirstName, e.LastName"}], "prompt_id": "b3326b75-528e-45ce-9a53-afa14f8d9fed"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the efficiency of shipping for each employee?"}, {"role": "assistant", "content": "SELECT Employees.EmployeeID, (COUNT(CASE WHEN Orders.ShippedDate <= Orders.RequiredDate THEN 1 END) / COUNT(Orders.OrderID)) AS ShippingEfficiency FROM Employees LEFT JOIN Orders ON Employees.EmployeeID = Orders.EmployeeID GROUP BY Employees.EmployeeID;"}], "prompt_id": "f4eaeb7b-9f8c-48f9-8d45-eaeb2ae48478"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the fill rate of each supplier in terms of units received versus units ordered?"}, {"role": "assistant", "content": "SELECT SupplierID, SUM(UnitsReceived) / SUM(UnitsOrdered) AS FillRate FROM (SELECT ProductID, SupplierID, Quantity AS UnitsReceived, Quantity + UnitsOnOrder AS UnitsOrdered FROM Products JOIN [Order Details] ON Products.ProductID = [Order Details].ProductID) Subquery GROUP BY SupplierID"}], "prompt_id": "53be2e48-5ba1-4d40-8b08-a97368c85697"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the average sales performance for each employee in the last quarter?"}, {"role": "assistant", "content": "SELECT Employees.EmployeeID, SUM([Order Details].UnitPrice * [Order Details].Quantity) / COUNT(Orders.OrderID) AS SalesPerformance FROM Employees JOIN Orders ON Employees.EmployeeID = Orders.EmployeeID JOIN [Order Details] ON Orders.OrderID = [Order Details].OrderID WHERE Orders.OrderDate BETWEEN date('now', '-3 months') AND date('now') GROUP BY Employees.EmployeeID"}], "prompt_id": "c5e49f8f-43e2-4d15-b9e3-b579323539fa"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the sales share of each product category in relation to the total sales?"}, {"role": "assistant", "content": "SELECT C.CategoryID, (SUM(OD.UnitPrice * OD.Quantity) / (SELECT SUM(OD2.UnitPrice * OD2.Quantity) FROM [Order Details] OD2)) AS CategorySalesShare FROM Categories C JOIN Products P ON C.CategoryID = P.CategoryID JOIN [Order Details] OD ON P.ProductID = OD.ProductID GROUP BY C.CategoryID;"}], "prompt_id": "20e57db5-9365-47c9-aa5f-34f45d5119db"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:How are the customers distributed across different geographic locations?"}, {"role": "assistant", "content": "SELECT City, COUNT(CustomerID) AS CustomerCount FROM Customers GROUP BY City;"}], "prompt_id": "9a4651d0-169a-4efc-9ecb-7b9c4192b3e4"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the inventory turnover rate for each product category?"}, {"role": "assistant", "content": "SELECT Categories.CategoryName, SUM([Order Details].UnitPrice * [Order Details].Quantity) / AVG(Products.UnitsInStock) AS InventoryTurnover FROM Categories LEFT JOIN Products ON Categories.CategoryID = Products.CategoryID LEFT JOIN [Order Details] ON Products.ProductID = [Order Details].ProductID GROUP BY Categories.CategoryName"}], "prompt_id": "1013e7ca-dd5d-4171-83b8-d0e3dad3a57d"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the shipping efficiency rate for each shipping company (ShipperID)?"}, {"role": "assistant", "content": "SELECT s.CompanyName AS Shipper, COUNT(CASE WHEN o.ShippedDate <= o.RequiredDate THEN 1 END) * 100.0 / COUNT(*) AS ShippingEfficiency\nFROM Shippers s\nLEFT JOIN Orders o ON s.ShipperID = o.ShipVia\nGROUP BY s.ShipperID, s.CompanyName"}], "prompt_id": "51944b75-040a-4a0a-be84-f347d7191806"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:Can we visualize the geographic distribution of customers by city and region?"}, {"role": "assistant", "content": "SELECT City, Region, COUNT(CustomerID) AS CustomerCount FROM Customers GROUP BY City, Region;"}], "prompt_id": "0bdb71fc-88df-4425-a191-87733d5a2c3d"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the customer complaint rate for each product category?"}, {"role": "assistant", "content": "SELECT p.CategoryID, (COUNT(CASE WHEN o.Complaints > 0 THEN o.OrderID END) / COUNT(o.OrderID)) AS ComplaintRate FROM Products p LEFT JOIN (SELECT od.OrderID, COUNT(c.ComplaintID) AS Complaints FROM [Order Details] od LEFT JOIN Complaints c ON od.OrderID = c.OrderID GROUP BY od.OrderID) o ON p.ProductID = o.ProductID GROUP BY p.CategoryID"}], "prompt_id": "61b9c6af-ae74-4614-9439-245afc27d21e"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the revenue growth rate between the current period and the previous period?"}, {"role": "assistant", "content": "SELECT (SUM(([Order Details].UnitPrice * [Order Details].Quantity) * (1 - Discount)) - (SELECT SUM(([Order Details].UnitPrice * [Order Details].Quantity) * (1 - Discount)) FROM [Order Details])) / (SELECT SUM(([Order Details].UnitPrice * [Order Details].Quantity) * (1 - Discount)) FROM [Order Details]) AS RevenueGrowthRate FROM [Order Details];"}], "prompt_id": "f9443b1d-9a83-4c9f-96aa-c3d3b8cf4e6d"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the sales share of each product category compared to the total sales?"}, {"role": "assistant", "content": "SELECT c.CategoryID, c.CategoryName, SUM(od.UnitPrice * od.Quantity) / (SELECT SUM(UnitPrice * Quantity) FROM [Order Details]) AS SalesShare FROM Categories c JOIN Products p ON c.CategoryID = p.CategoryID JOIN [Order Details] od ON p.ProductID = od.ProductID GROUP BY c.CategoryID, c.CategoryName;"}], "prompt_id": "b545a579-8b99-4ee9-b743-ac65c5c59d07"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:How many territories does each employee cover?"}, {"role": "assistant", "content": "SELECT Employees.EmployeeID, COUNT(EmployeeTerritories.TerritoryID) AS TerritoryCount FROM Employees LEFT JOIN EmployeeTerritories ON Employees.EmployeeID = EmployeeTerritories.EmployeeID GROUP BY Employees.EmployeeID;"}], "prompt_id": "63df2b63-15a2-441f-9a71-09f1cc284e49"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the order cancellation rate based on the canceled orders and total orders placed?"}, {"role": "assistant", "content": "SELECT (COUNT(CASE WHEN Cancelled = 1 THEN 1 END) / COUNT(OrderID)) AS CancellationRate FROM Orders"}], "prompt_id": "811dfeac-646b-4461-a50d-c612d32b7f0d"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the complaint rate for each customer?"}, {"role": "assistant", "content": "SELECT c.CustomerID, (SELECT COUNT(*) FROM Orders o2 WHERE o2.CustomerID = c.CustomerID AND o2.Complaints > 0) / COUNT(*) AS ComplaintRate FROM Customers c LEFT JOIN Orders o ON c.CustomerID = o.CustomerID GROUP BY c.CustomerID;"}], "prompt_id": "6d976153-cf50-4785-8788-ea84000f8f08"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the sales share for each category of products?"}, {"role": "assistant", "content": "SELECT c.CategoryID, SUM(od.UnitPrice * od.Quantity) / (SELECT SUM(od2.UnitPrice * od2.Quantity) FROM [Order Details] od2) AS SalesShare FROM Categories c INNER JOIN Products p ON c.CategoryID = p.CategoryID INNER JOIN [Order Details] od ON p.ProductID = od.ProductID GROUP BY c.CategoryID"}], "prompt_id": "7704c38c-fd81-461b-97c5-b8cebfa2d84c"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:17. What is the order cancellation rate for all orders?"}, {"role": "assistant", "content": "SELECT (COUNT(CASE WHEN o.ShippedDate IS NULL THEN 1 END) / COUNT(o.OrderID)) AS CancellationRate FROM Orders o"}], "prompt_id": "7b472c09-ad85-412a-babd-4c7829fef472"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the average order fulfillment time?"}, {"role": "assistant", "content": "SELECT AVG(julianday(ShippedDate) - julianday(OrderDate)) AS fulfillment_time FROM Orders;"}], "prompt_id": "c9a787cb-158c-4385-9453-d888522bfb7a"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the revenue growth rate compared to the previous half-year period?"}, {"role": "assistant", "content": "SELECT strftime('%Y-%m', OrderDate) AS Month, (SUM([Order Details].UnitPrice * [Order Details].Quantity) - (SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity) FROM Orders WHERE OrderDate < date('now', '-6 months'))) / (SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity) FROM Orders WHERE OrderDate < date('now', '-6 months')) AS RevenueGrowth FROM Orders INNER JOIN [Order Details] ON Orders.OrderID = [Order Details].OrderID GROUP BY Month;"}], "prompt_id": "cd24bbba-0cbb-442c-991f-d2b71dacf185"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the retention rate of customers who made repeat purchases within the last 6 months?"}, {"role": "assistant", "content": "SELECT (COUNT(DISTINCT C.CustomerID) * 1.0) / (SELECT COUNT(DISTINCT CustomerID) FROM Orders WHERE OrderDate BETWEEN date('now', '-6 months') AND date('now')) AS RetentionRate FROM Customers C INNER JOIN Orders O ON C.CustomerID = O.CustomerID WHERE O.OrderDate BETWEEN date('now', '-6 months') AND date('now')"}], "prompt_id": "c4cc038f-d7ff-4858-9fa2-1aabfc813ea2"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the average order value for each customer?"}, {"role": "assistant", "content": "SELECT Customers.CustomerID, AVG([Order Details].UnitPrice * [Order Details].Quantity) AS AvgOrderValue\nFROM Customers\nJOIN Orders ON Customers.CustomerID = Orders.CustomerID\nJOIN [Order Details] ON Orders.OrderID = [Order Details].OrderID\nGROUP BY Customers.CustomerID;"}], "prompt_id": "69ea73fd-9de5-4bec-a82b-117ccf8ceaee"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the average order fulfillment time for each shipping company?"}, {"role": "assistant", "content": "SELECT Orders.ShipVia, AVG(julianday(Orders.ShippedDate) - julianday(Orders.OrderDate)) AS AvgFulfillmentTime FROM Orders GROUP BY Orders.ShipVia;"}], "prompt_id": "6fceb3a5-0ce7-4da9-9aae-182d8fd2d69d"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the shipping efficiency for orders with freight cost above and below the average freight cost?"}, {"role": "assistant", "content": "SELECT CASE WHEN o.Freight > (SELECT AVG(Freight) FROM Orders) THEN 'Above Average' ELSE 'Below Average' END AS FreightCategory, SUM(CASE WHEN o.ShippedDate <= o.RequiredDate THEN 1 ELSE 0 END) * 1.0 / COUNT(o.OrderID) AS ShippingEfficiency FROM Orders o GROUP BY FreightCategory"}], "prompt_id": "8d5d0b8e-49ee-424f-8ea1-edddcc1f4b45"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the revenue growth rate over time?"}, {"role": "assistant", "content": "SELECT (SUM(od.UnitPrice * od.Quantity) - LAG(SUM(od.UnitPrice * od.Quantity), 1, 0) OVER (ORDER BY o.OrderDate)) / LAG(SUM(od.UnitPrice * od.Quantity), 1, 0) OVER (ORDER BY o.OrderDate) AS RevenueGrowthRate FROM Orders o INNER JOIN [Order Details] od ON o.OrderID = od.OrderID"}], "prompt_id": "33739d05-d79f-48fd-9598-db4474da9def"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the availability rate for products under each category?"}, {"role": "assistant", "content": "SELECT p.ProductID, ((SELECT COUNT(CASE WHEN UnitsInStock > Quantity THEN 1 ELSE NULL END) FROM [Order Details] WHERE ProductID = p.ProductID) / (SELECT COUNT(Quantity) FROM [Order Details] WHERE ProductID = p.ProductID)) * 100 AS AvailabilityRate FROM Products p;"}], "prompt_id": "267e4057-7a95-4e14-8403-c7ba353c29c7"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:How are the customers distributed across different cities and regions?"}, {"role": "assistant", "content": "SELECT City, Region, COUNT(CustomerID) AS CustomerCount FROM Customers GROUP BY City, Region;"}], "prompt_id": "833e350b-5778-4346-9d4d-da9ebdebd392"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the sales performance of each employee in terms of average sales per order?"}, {"role": "assistant", "content": "SELECT e.EmployeeID, SUM(od.UnitPrice * od.Quantity) / COUNT(o.OrderID) AS SalesPerformance FROM Employees e LEFT JOIN Orders o ON e.EmployeeID = o.EmployeeID LEFT JOIN [Order Details] od ON o.OrderID = od.OrderID GROUP BY e.EmployeeID;"}], "prompt_id": "fb4c3494-14fb-46e9-9f6f-a0841f56f705"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the average customer lifetime value?"}, {"role": "assistant", "content": "SELECT AVG(UnitPrice * Quantity) * COUNT(DISTINCT Orders.OrderID) * AVG(julianday(ShippedDate) - julianday(OrderDate)) AS AvgCLV FROM Orders INNER JOIN Customers ON Orders.CustomerID = Customers.CustomerID INNER JOIN [Order Details] ON Orders.OrderID = [Order Details].OrderID;"}], "prompt_id": "6c7c4781-7942-4aa7-bfe9-936b2a8ba3c9"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the average order fulfillment time for each shipping company?"}, {"role": "assistant", "content": "SELECT Orders.ShipVia, AVG(JULIANDAY(Orders.ShippedDate) - JULIANDAY(Orders.OrderDate)) AS AvgFulfillmentTime\nFROM Orders"}], "prompt_id": "8ee0235f-0bcd-4f80-8e49-50a40b936ec5"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:How are customers distributed geographically based on city or region?"}, {"role": "assistant", "content": "SELECT City, COUNT(CustomerID) AS CustomerCount FROM Customers GROUP BY City;"}], "prompt_id": "4aece58f-22ea-4782-b4d8-3f04197aa70d"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the customer retention rate for the past year?"}, {"role": "assistant", "content": "SELECT COUNT(DISTINCT CASE WHEN EXISTS (SELECT 1 FROM Orders WHERE Orders.CustomerID = Customers.CustomerID AND Orders.OrderDate < DATE('now', '-1 year')) THEN Customers.CustomerID ELSE NULL END) / COUNT(DISTINCT Customers.CustomerID) AS CustomerRetentionRate FROM Customers;"}], "prompt_id": "2ff1eca1-2eb2-4acb-9802-7fa1969446f5"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the customer lifetime value (CLV) for customers in each region?"}, {"role": "assistant", "content": "SELECT cu.Region, (AVG(od.UnitPrice * od.Quantity) * AVG((SELECT COUNT(DISTINCT o2.OrderID) FROM Orders o2 WHERE o2.CustomerID = cu.CustomerID) / AVG(DATEDIFF(year, MIN(o.OrderDate), MAX(o.OrderDate))))) AS Customer_Lifetime_Value FROM Customers cu INNER JOIN Orders o ON cu.CustomerID = o.CustomerID INNER JOIN [Order Details] od ON o.OrderID = od.OrderID GROUP BY cu.Region"}], "prompt_id": "4118e011-f837-430b-910c-7b8e07524196"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the revenue growth rate for each product category compared to the previous period?"}, {"role": "assistant", "content": "SELECT strftime('%m-%Y', Orders.OrderDate) AS MonthYear, (SUM([Order Details].UnitPrice * [Order Details].Quantity) - (SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity) FROM [Order Details] WHERE Orders.OrderDate < date('now', '-1 year')) * 100.0 / (SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity) FROM [Order Details] WHERE Orders.OrderDate < date('now', '-1 year'))) AS RevenueGrowthRate FROM Orders LEFT JOIN [Order Details] ON Orders.OrderID = [Order Details].OrderID GROUP BY MonthYear;"}], "prompt_id": "bb158c1c-70fb-4503-adcd-ec2949f5d018"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the efficiency of shipping for each order in terms of being shipped on or before the required date?"}, {"role": "assistant", "content": "SELECT COUNT(CASE WHEN (julianday(Orders.ShippedDate) - julianday(Orders.RequiredDate)) <= 0 THEN 1 ELSE NULL END) / COUNT(Orders.OrderID) AS ShippingEfficiency FROM Orders"}], "prompt_id": "0eeeccf2-5b0c-457a-8734-26b04ec2b665"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:Which employee has the highest sales performance based on the total sales generated and the number of orders handled?"}, {"role": "assistant", "content": "SELECT Employees.FirstName, Employees.LastName, COALESCE(SUM([Order Details].UnitPrice * [Order Details].Quantity), 0) / COALESCE(COUNT(DISTINCT Orders.OrderID), 1) AS SalesPerformance FROM Employees LEFT JOIN Orders ON Employees.EmployeeID = Orders.EmployeeID LEFT JOIN [Order Details] ON Orders.OrderID = [Order Details].OrderID GROUP BY Employees.EmployeeID"}], "prompt_id": "2c7fdf76-d5e8-48ba-9145-a67366db0f7b"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:19. What is the availability rate of each product for each customer?"}, {"role": "assistant", "content": "SELECT Customers.CustomerID, SUM(CASE WHEN Products.UnitsInStock >= [Order Details].Quantity THEN 1 ELSE 0 END) / COUNT(Orders.OrderID) AS ProductAvailabilityRate FROM Orders INNER JOIN [Order Details] ON Orders.OrderID = [Order Details].OrderID INNER JOIN Products ON [Order Details].ProductID = Products.ProductID GROUP BY Customers.CustomerID"}], "prompt_id": "0d711b0c-e068-4f8b-b839-eab99dbedcf4"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the employee attrition rate over the last year?"}, {"role": "assistant", "content": "SELECT AVG(CASE WHEN DATE_DIFF(CURRENT_DATE, Employees.HireDate, YEAR) = 1 THEN 1 ELSE 0 END) / COUNT(DISTINCT Employees.EmployeeID) AS AttritionRate FROM Employees;"}], "prompt_id": "4ebe9fce-9ec4-4dd5-88bb-469f2df73d19"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:How frequently do products hit their reorder level within a specific time frame?"}, {"role": "assistant", "content": "SELECT (COUNT(CASE WHEN Products.UnitsInStock <= Products.ReorderLevel THEN 1 END) / COUNT(DISTINCT Orders.OrderID)) AS ReorderFrequency FROM Products INNER JOIN [Order Details] ON Products.ProductID = [Order Details].ProductID"}], "prompt_id": "c48a6126-6858-4a3f-828e-909e4759ecfd"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the average order value (AOV) for each category of products in the database?"}, {"role": "assistant", "content": "SELECT CategoryName, AVG(UnitPrice * Quantity) AS AOV FROM Categories c INNER JOIN Products p ON c.CategoryID = p.CategoryID INNER JOIN [Order Details] od ON p.ProductID = od.ProductID GROUP BY CategoryName;"}], "prompt_id": "4196fe0b-b35e-4e2d-ad9f-e1dc95fa370b"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the average fulfillment time for orders shipped to each region?"}, {"role": "assistant", "content": "SELECT Orders.ShipRegion, AVG(julianday(Orders.ShippedDate) - julianday(Orders.OrderDate)) AS AvgFulfillmentTime FROM Orders GROUP BY Orders.ShipRegion;"}], "prompt_id": "c81785aa-2be2-4860-b29d-18abe7e0c387"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the customer complaint rate in terms of the percentage of customer complaints received out of the total number of orders?"}, {"role": "assistant", "content": "SELECT COUNT(CASE WHEN ComplaintReceived THEN OrderID END) / COUNT(OrderID) AS CustomerComplaintRate FROM Orders"}], "prompt_id": "c3b93d0f-4e7c-4243-81e2-3aaaf84e7aff"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:17. What is the order cancellation rate for all orders placed?"}, {"role": "assistant", "content": "SELECT (SELECT COUNT(*) FROM Orders WHERE ShippedDate IS NULL) / COUNT(*) AS OrderCancellationRate FROM Orders"}], "prompt_id": "5ea0790b-4bab-4f45-b7d7-228824ac6042"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the customer lifetime value (CLV) for each customer?"}, {"role": "assistant", "content": "SELECT Customers.CustomerID, (AVG(UnitPrice * Quantity) * COUNT(DISTINCT Orders.OrderID) * (julianday(MAX(Orders.OrderDate)) - julianday(MIN(Orders.OrderDate)))) AS CLV FROM Customers INNER JOIN Orders ON Customers.CustomerID = Orders.CustomerID INNER JOIN [Order Details] ON Orders.OrderID = [Order Details].OrderID"}], "prompt_id": "a89d2633-cf83-414e-95d1-c067a412547d"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the product availability rate for each product category?"}, {"role": "assistant", "content": "SELECT Categories.CategoryName, (COUNT(CASE WHEN Products.UnitsInStock > [Order Details].Quantity THEN [Order Details].OrderID END) / COUNT([Order Details].OrderID)) AS AvailabilityRate FROM Products INNER JOIN [Order Details] ON Products.ProductID = [Order Details].ProductID INNER JOIN Categories ON Products.CategoryID = Categories.CategoryID GROUP BY Categories.CategoryName"}], "prompt_id": "439ecf9b-37d1-4ff9-9db0-c7ed2b518d15"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the ratio of orders shipped on or before the required date over the total number of orders?"}, {"role": "assistant", "content": "SELECT (COUNT(CASE WHEN julianday(Orders.ShippedDate) <= julianday(Orders.RequiredDate) THEN 1 ELSE NULL END) / COUNT(Orders.OrderID)) * 100 AS ShippingEfficiency FROM Orders"}], "prompt_id": "4ff9c5e6-0cac-49aa-a551-d76314a9ab65"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the fill rate for each supplier?"}, {"role": "assistant", "content": "SELECT (SUM([Order Details].Quantity) / SUM([Order Details].ReorderLevel)) AS FillRate, Suppliers.SupplierID, Suppliers.CompanyName FROM [Order Details] INNER JOIN Products ON [Order Details].ProductID = Products.ProductID INNER JOIN Suppliers ON Products.SupplierID = Suppliers.SupplierID"}], "prompt_id": "98a059c9-13ea-4f47-8bbd-af051b388ca0"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the customer retention rate for each region?"}, {"role": "assistant", "content": "SELECT Customers.Region, COUNT(DISTINCT CASE WHEN EXISTS (SELECT * FROM Orders WHERE Orders.CustomerID = Customers.CustomerID) THEN Customers.CustomerID ELSE NULL END) / COUNT( DISTINCT Customers.CustomerID) AS CustomerRetentionRate FROM Customers GROUP BY Customers.Region;"}], "prompt_id": "782f3fea-03a9-47d2-866a-d2393f6bf4ff"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the retention rate of customers who made repeat purchases within the last quarter?"}, {"role": "assistant", "content": "SELECT COUNT(DISTINCT o.CustomerID) / COUNT(c.CustomerID) AS RetentionRate FROM Customers c LEFT JOIN Orders o ON c.CustomerID = o.CustomerID WHERE o.OrderDate >= DATE('now', '-3 months')"}], "prompt_id": "c4bcf550-ac9c-495e-84d0-da0c5b5f90d9"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the customer retention rate for each region?"}, {"role": "assistant", "content": "SELECT Customers.Region, (COUNT(DISTINCT Orders.CustomerID) - COUNT(DISTINCT CASE WHEN Orders.ShippedDate IS NULL THEN Orders.CustomerID END)) / COUNT(DISTINCT Orders.CustomerID) AS CustomerRetentionRate FROM Customers LEFT JOIN Orders ON Customers.CustomerID = Orders.CustomerID GROUP BY Customers.Region;"}], "prompt_id": "1117f431-ccd2-45c7-8ae2-40aced593728"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the average order value for each customer?"}, {"role": "assistant", "content": "SELECT Orders.CustomerID, AVG([Order Details].UnitPrice * [Order Details].Quantity) AS AverageOrderValue FROM Orders INNER JOIN [Order Details] ON Orders.OrderID = [Order Details].OrderID GROUP BY Orders.CustomerID;"}], "prompt_id": "6ad94397-8863-4c56-8e17-5b4c434c3e85"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the sales share for each product category in the database?"}, {"role": "assistant", "content": "SELECT Categories.CategoryID, Categories.CategoryName, SUM([Order Details].UnitPrice * [Order Details].Quantity) / (SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity) FROM [Order Details]) AS SalesShare FROM Categories LEFT JOIN Products ON Categories.CategoryID = Products.CategoryID LEFT JOIN [Order Details] ON Products.ProductID = [Order Details].ProductID GROUP BY Categories.CategoryID, Categories.CategoryName;"}], "prompt_id": "cc3afab1-17b8-4f82-9289-f1674366974f"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the average cost of freight for all orders?"}, {"role": "assistant", "content": "SELECT SUM(Freight) / COUNT(OrderID) AS AverageFreightCost FROM Orders;"}], "prompt_id": "0c1f7f3e-0d47-4f95-bf1e-55190181a7bb"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the inventory turnover for each product category?"}, {"role": "assistant", "content": "SELECT Categories.CategoryName, SUM([Order Details].UnitPrice * [Order Details].Quantity) / AVG(Products.UnitsInStock) AS InventoryTurnover FROM Categories INNER JOIN Products ON Categories.CategoryID = Products.CategoryID INNER JOIN [Order Details] ON Products.ProductID = [Order Details].ProductID GROUP BY Categories.CategoryName"}], "prompt_id": "3c11231b-9628-49f8-98a7-354830e7f26b"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the revenue growth rate compared to the previous quarter?"}, {"role": "assistant", "content": "SELECT (SUM(UnitPrice * Quantity) - (SELECT SUM(UnitPrice * Quantity) FROM [Order Details] WHERE OrderDate BETWEEN DATEADD(month, -3, GETDATE()) AND DATEADD(month, -2, GETDATE()))) / (SELECT SUM(UnitPrice * Quantity) FROM [Order Details] WHERE OrderDate BETWEEN DATEADD(month, -3, GETDATE()) AND DATEADD(month, -2, GETDATE())) AS RevenueGrowthRate FROM [Order Details] WHERE OrderDate BETWEEN DATEADD(month, -3, GETDATE()) AND GETDATE()"}], "prompt_id": "32df5f7d-7c03-4f7a-b59a-accdee130c9e"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:How often does each product hit its reorder level within a specific time frame?"}, {"role": "assistant", "content": "SELECT ProductID, COUNT(*) AS ReorderFrequency FROM [Order Details] WHERE UnitsInStock <= ReorderLevel GROUP BY ProductID"}], "prompt_id": "1a4913c3-f409-4f65-be0d-f1b3776c7d32"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the inventory turnover rate for each product?"}, {"role": "assistant", "content": "SELECT ProductID, SUM([Order Details].UnitPrice * [Order Details].Quantity) / AVG(UnitsInStock + UnitsOnOrder) AS InventoryTurnover FROM Products INNER JOIN [Order Details] ON Products.ProductID = [Order Details].ProductID GROUP BY ProductID"}], "prompt_id": "a3645a2b-5286-45f1-ae2d-48c42054e9f7"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the complaint rate for each shipping method used by the company?"}, {"role": "assistant", "content": "SELECT ShipVia, COUNT(CASE WHEN ComplaintStatus = 'Received' THEN 1 ELSE NULL END) * 100.0 / COUNT(Orders.OrderID) AS ComplaintRate FROM Orders WHERE ComplaintStatus IS NOT NULL GROUP BY ShipVia;"}], "prompt_id": "835d66a3-1044-4006-b8e0-cf6add7a796c"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the inventory turnover for each product?"}, {"role": "assistant", "content": "SELECT p.ProductName, SUM(od.UnitPrice * od.Quantity) / AVG(p.UnitsInStock + p.UnitsOnOrder) AS InventoryTurnover FROM Products p INNER JOIN [Order Details] od ON p.ProductID = od.ProductID GROUP BY p.ProductName"}], "prompt_id": "2cbae379-64a4-4657-b542-13a35d19f39d"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the average order value for all orders?"}, {"role": "assistant", "content": "SELECT SUM(UnitPrice * Quantity) / COUNT(OrderID) AS AvgOrderValue FROM [Order Details]"}], "prompt_id": "47e8ec83-05b3-4f86-b4ce-76e3325ec4a3"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the average freight cost per order?"}, {"role": "assistant", "content": "SELECT AVG(Freight) AS AverageFreightCost FROM Orders;"}], "prompt_id": "7951a05f-9ffe-4494-b41d-3fe5dcaffda7"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:12. What is the fill rate of products supplied by 'Exotic Liquids'?"}, {"role": "assistant", "content": "SELECT s.CompanyName, SUM(CASE WHEN od.UnitPrice * od.Quantity IS NOT NULL THEN 1 ELSE 0 END) / COUNT(od.ProductID) AS FillRate FROM Suppliers s INNER JOIN Products p ON s.SupplierID = p.SupplierID LEFT JOIN [Order Details] od ON p.ProductID = od.ProductID"}], "prompt_id": "5ff05875-2161-42f0-bf2a-b10a13e26acf"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the fill rate for each supplier?"}, {"role": "assistant", "content": "SELECT Suppliers.CompanyName, SUM([Order Details].Quantity) / AVG([Order Details].Quantity) AS FillRate FROM Products JOIN [Order Details] ON Products.ProductID = [Order Details].ProductID JOIN Suppliers ON Products.SupplierID = Suppliers.SupplierID GROUP BY Suppliers.CompanyName"}], "prompt_id": "01f612cd-ef7f-4ab5-b4aa-a3b9af4a5a32"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:How does the product profitability vary across different product IDs?"}, {"role": "assistant", "content": "SELECT Products.ProductID, (Products.UnitPrice - [Order Details].UnitPrice) * [Order Details].Quantity AS Profitability FROM Products LEFT JOIN [Order Details] ON Products.ProductID = [Order Details].ProductID"}], "prompt_id": "ca8feadd-0f09-41ef-be92-c8a8498d9565"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:How are the customers distributed geographically in terms of cities and regions?"}, {"role": "assistant", "content": "SELECT City, Region, COUNT(CustomerID) AS CustomerCount FROM Customers GROUP BY City, Region;"}], "prompt_id": "3ba1f698-2fb1-44d5-8b9e-4e6e62fb0448"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the order cancellation rate?"}, {"role": "assistant", "content": "SELECT (SELECT COUNT(OrderID) FROM Orders WHERE Status = 'Canceled') / COUNT(OrderID) AS OrderCancellationRate FROM Orders;"}], "prompt_id": "00a77576-a40b-49c4-81c4-7b5879b95ccc"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the inventory turnover for each product category?"}, {"role": "assistant", "content": "SELECT Products.CategoryID, SUM([Order Details].UnitPrice * [Order Details].Quantity) / (SELECT AVG(UnitsInStock) FROM Products) AS InventoryTurnover\nFROM Products\nLEFT JOIN [Order Details] ON Products.ProductID = [Order Details].ProductID\nGROUP BY Products.CategoryID"}], "prompt_id": "80deb466-9ffd-45b9-a27f-48069ee2ced8"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:How profitable is each product based on the unit price, cost, and quantity sold?"}, {"role": "assistant", "content": "SELECT p.ProductID, ((od.UnitPrice - p.Cost) * od.Quantity) AS product_profitability FROM Products p JOIN [Order Details] od ON p.ProductID = od.ProductID"}], "prompt_id": "523bbdb3-b579-4a5f-93c3-b5c344365f45"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the customer complaint rate?"}, {"role": "assistant", "content": "SELECT COUNT(CASE WHEN Complaints IS NOT NULL THEN 1 END) / COUNT(*) AS ComplaintRate FROM Orders"}], "prompt_id": "a6fa362e-a59f-425d-a845-6fbb8b020418"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the complaint rate per order for the company?"}, {"role": "assistant", "content": "SELECT COUNT(CASE WHEN ComplaintReceived = 'Yes' THEN 1 END) / COUNT(OrderID) AS ComplaintRate FROM Orders"}], "prompt_id": "f631bd0e-126c-432d-97f1-c1df9cd3f77f"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the shipping efficiency rate for each shipping company?"}, {"role": "assistant", "content": "SELECT ShipVia, SUM(CASE WHEN ShippedDate <= RequiredDate THEN 1 ELSE 0 END) / COUNT(*) AS ShippingEfficiency FROM Orders GROUP BY ShipVia"}], "prompt_id": "0042259c-d59a-49f6-b421-d5d3f7117de6"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the average order value for all orders?"}, {"role": "assistant", "content": "SELECT SUM(UnitPrice * Quantity) / COUNT(DISTINCT OrderID) AS AverageOrderValue FROM [Order Details]"}], "prompt_id": "68f69f77-4c82-479a-aa5c-8383cfe4697f"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the average order value (AOV) for all orders?"}, {"role": "assistant", "content": "SELECT (SUM(UnitPrice * Quantity) / COUNT(DISTINCT OrderID)) AS AOV FROM [Order Details];"}], "prompt_id": "116fb189-e1ce-4539-be28-03aab4011fd6"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:Who are the top performing sales employees in terms of total sales?"}, {"role": "assistant", "content": "SELECT Employees.EmployeeID, SUM([Order Details].UnitPrice * [Order Details].Quantity) / COUNT(DISTINCT Orders.OrderID) AS SalesPerformance FROM Employees LEFT JOIN Orders ON Employees.EmployeeID = Orders.EmployeeID LEFT JOIN [Order Details] ON Orders.OrderID = [Order Details].OrderID GROUP BY Employees.EmployeeID"}], "prompt_id": "a3539bc0-d98f-496a-a4b1-b4bbff643ce1"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the sales share of each category of products?"}, {"role": "assistant", "content": "SELECT c.CategoryID, SUM(od.UnitPrice*od.Quantity) AS CategorySales, (SUM(od.UnitPrice*od.Quantity) / (SELECT SUM(od.UnitPrice*od.Quantity) FROM [Order Details] od)) AS SalesShare FROM Categories c JOIN Products p ON c.CategoryID = p.CategoryID JOIN [Order Details] od ON p.ProductID = od.ProductID GROUP BY c.CategoryID"}], "prompt_id": "24edaeee-08f2-4556-b801-f1eb871defc3"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the average customer lifetime value (CLV) for the customer base?"}, {"role": "assistant", "content": "SELECT AVG([Order Details].UnitPrice * [Order Details].Quantity) * SUM(Orders.Freight) AS CLV FROM Customers JOIN Orders ON Customers.CustomerID = Orders.CustomerID JOIN [Order Details] ON Orders.OrderID = [Order Details].OrderID"}], "prompt_id": "72b0168a-8e32-4e72-ad8f-5f3122a0606b"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the efficiency of shipping based on orders shipped on or before the required date?"}, {"role": "assistant", "content": "SELECT SUM(CASE WHEN julianday(ShippedDate) - julianday(RequiredDate) <= 0 THEN 1 ELSE 0 END) / COUNT(OrderID) AS ShippingEfficiency FROM Orders WHERE ShippedDate IS NOT NULL;"}], "prompt_id": "f1919402-0b1d-4d1f-a0cf-74f3afd4ff77"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the inventory turnover for each product category?"}, {"role": "assistant", "content": "SELECT p.CategoryID, SUM(od.UnitPrice * od.Quantity) / AVG(p.UnitsInStock + p.UnitsOnOrder) AS InventoryTurnover FROM Products p JOIN [Order Details] od ON p.ProductID = od.ProductID GROUP BY p.CategoryID"}], "prompt_id": "9b78875d-5ec7-495e-83cd-924d3ab7c7a6"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the average customer lifetime value (CLV) for all customers?"}, {"role": "assistant", "content": "SELECT C.CustomerID, AVG(OD.UnitPrice * OD.Quantity) * COUNT(DISTINCT O.OrderDate) * DATEDIFF(MAX(O.OrderDate), MIN(O.OrderDate)) AS CLV FROM Customers C INNER JOIN Orders O ON C.CustomerID = O.CustomerID INNER JOIN [Order Details] OD ON O.OrderID = OD.OrderID"}], "prompt_id": "8024d148-7c95-4ad7-b44a-4636e9582df1"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the average order fulfillment time for each shipping method?"}, {"role": "assistant", "content": "SELECT ShipVia, AVG(JULIANDAY(Orders.ShippedDate) - JULIANDAY(Orders.OrderDate)) AS AvgFulfillmentTime FROM Orders WHERE Orders.ShippedDate IS NOT NULL GROUP BY ShipVia;"}], "prompt_id": "75054362-c5c8-4e05-9073-b67b0a11240c"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:6. What is the sales share for each category in the current year?"}, {"role": "assistant", "content": "SELECT Categories.CategoryName, SUM([Order Details].UnitPrice * [Order Details].Quantity) / (SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity) FROM [Order Details]) AS SalesShare FROM Categories LEFT JOIN Products ON Categories.CategoryID = Products.CategoryID LEFT JOIN [Order Details] ON Products.ProductID = [Order Details].ProductID GROUP BY Categories.CategoryName;"}], "prompt_id": "b966b40b-4f17-4094-892f-49dc586f421d"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the average order fulfillment time for each customer?"}, {"role": "assistant", "content": "SELECT Customers.CustomerID, AVG(julianday(Orders.ShippedDate) - julianday(Orders.OrderDate)) AS AvgFulfillmentTime FROM Customers INNER JOIN Orders ON Customers.CustomerID = Orders.CustomerID GROUP BY Customers.CustomerID;"}], "prompt_id": "76bcf219-9541-412d-a4f4-4847108d4974"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the customer acquisition rate for the given period?"}, {"role": "assistant", "content": "SELECT COUNT(CustomerID)/DATEDIFF(MAX(OrderDate), MIN(OrderDate)) AS CustomerAcquisitionRate FROM Orders;"}], "prompt_id": "dea0a47a-63f8-487e-94da-9d7127f9d7cc"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the average order fulfillment time for all orders?"}, {"role": "assistant", "content": "SELECT AVG(julianday(ShippedDate) - julianday(OrderDate)) AS AvgFulfillmentTime FROM Orders"}], "prompt_id": "efa2e60a-114b-4e72-8d34-7c1eefc31118"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:Which products have the highest profitability in each category?"}, {"role": "assistant", "content": "SELECT c.CategoryID, c.CategoryName, p.ProductID, p.ProductName, (p.UnitPrice - p.Cost) * od.Quantity AS Product_Profitability FROM Categories c LEFT JOIN Products p ON c.CategoryID = p.CategoryID LEFT JOIN [Order Details] od ON p.ProductID = od.ProductID"}], "prompt_id": "01527ded-81bb-4890-9d4b-a3a88af76692"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:Which products have the highest profitability in terms of total profit generated?"}, {"role": "assistant", "content": "SELECT Products.ProductName, (Products.UnitPrice - [Order Details].UnitPrice) * [Order Details].Quantity AS Profit FROM Products LEFT JOIN [Order Details] ON Products.ProductID = [Order Details].ProductID GROUP BY Products.ProductName"}], "prompt_id": "a4bade0a-ffbb-4eef-b4a6-65e619888516"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the sales share for each category?"}, {"role": "assistant", "content": "SELECT c.CategoryID, SUM(od.UnitPrice * od.Quantity) AS TotalSales, (SUM(od.UnitPrice * od.Quantity) / (SELECT SUM(UnitPrice * Quantity) FROM [Order Details])) AS SalesShare FROM Categories c JOIN Products p ON c.CategoryID = p.CategoryID JOIN [Order Details] od ON p.ProductID = od.ProductID GROUP BY c.CategoryID"}], "prompt_id": "d2d3dd0d-91f5-483c-8361-cd1d9333b01b"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the distribution of customers by postal code?"}, {"role": "assistant", "content": "SELECT PostalCode, COUNT(CustomerID) AS CustomerCount FROM Customers GROUP BY PostalCode;"}], "prompt_id": "8d6c61ff-632f-4c23-8469-a4783c568c70"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:How often do products hit their reorder level within the last month?"}, {"role": "assistant", "content": "SELECT p.ProductName, COUNT(*) AS ReorderFrequency FROM Products p INNER JOIN [Order Details] od ON p.ProductID = od.ProductID WHERE od.OrderDate BETWEEN DATE_SUB(NOW(), INTERVAL 1 MONTH) AND NOW() AND p.UnitsInStock <= p.ReorderLevel GROUP BY p.ProductName"}], "prompt_id": "147db308-04de-4a68-b495-eaf466dfcd2c"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the inventory turnover rate for each product?"}, {"role": "assistant", "content": "SELECT (SUM([Order Details].UnitPrice * [Order Details].Quantity) / Products.UnitsInStock) AS InventoryTurnover, Products.ProductName FROM [Order Details] JOIN Products ON [Order Details].ProductID = Products.ProductID GROUP BY Products.ProductName"}], "prompt_id": "08909281-f840-42c5-9629-419f72c3e488"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:10. What is the geographic distribution of customers in terms of the number of customers in each city or region?"}, {"role": "assistant", "content": "SELECT City, Region, COUNT(CustomerID) AS CustomerGeographicDistribution FROM Customers GROUP BY City, Region"}], "prompt_id": "7b4ed917-9455-4408-82fc-d1c868d55860"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the customer geographic distribution by region and city? (List the number of customers in each region and city)"}, {"role": "assistant", "content": "SELECT c.Region, c.City, COUNT(c.CustomerID) AS NumCustomers FROM Customers c GROUP BY c.Region, c.City"}], "prompt_id": "433a63d8-1989-4840-b4f6-b90337831ce0"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:How many new customers were acquired each month?"}, {"role": "assistant", "content": "SELECT strftime('%Y-%m', Orders.OrderDate) AS MonthYear, COUNT(DISTINCT Customers.CustomerID) AS NewCustomersAcquired FROM Orders LEFT JOIN Customers ON Orders.CustomerID = Customers.CustomerID GROUP BY MonthYear"}], "prompt_id": "503f5f97-bac8-47d9-8bd5-bc93defa741a"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the reorder frequency for each product?"}, {"role": "assistant", "content": "SELECT Products.ProductName, COUNT(CASE WHEN [Order Details].UnitPrice * [Order Details].Quantity >= Products.ReorderLevel THEN 1 END) AS ReorderFrequency\nFROM Products\nINNER JOIN [Order Details] ON Products.ProductID = [Order Details].ProductID\nGROUP BY Products.ProductName"}], "prompt_id": "a5fa649f-825e-4277-9904-2b48572876d8"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the efficiency of shipping based on the percentage of orders shipped on or before the required date?"}, {"role": "assistant", "content": "SELECT SUM(CASE WHEN o.ShippedDate <= o.RequiredDate THEN 1 ELSE 0 END) / COUNT(o.OrderID) AS ShippingEfficiency FROM Orders o WHERE o.ShippedDate IS NOT NULL AND o.RequiredDate IS NOT NULL;"}], "prompt_id": "c97b5043-4a95-4ceb-b032-57f4dfe5c909"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the revenue growth rate?"}, {"role": "assistant", "content": "SELECT (SUM(UnitPrice * Quantity) - LAG(SUM(UnitPrice * Quantity), 1) OVER (ORDER BY OrderDate)) / LAG(SUM(UnitPrice * Quantity), 1) OVER (ORDER BY OrderDate) AS RevenueGrowthRate FROM [Order Details] JOIN Orders ON [Order Details].OrderID = Orders.OrderID"}], "prompt_id": "ed1a4a5d-8940-4f66-95c3-91de8c200ac4"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:How many orders were placed in each city?"}, {"role": "assistant", "content": "SELECT City, COUNT(OrderID) AS OrdersPlaced FROM Customers c INNER JOIN Orders o ON c.CustomerID = o.CustomerID GROUP BY City"}], "prompt_id": "7c9abae6-77b3-4c20-b17f-bc2502d3486d"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:How many territories are covered by each employee?"}, {"role": "assistant", "content": "SELECT e.EmployeeID, COUNT(et.TerritoryID) AS NumTerritories FROM Employees e JOIN EmployeeTerritories et ON e.EmployeeID = et.EmployeeID GROUP BY e.EmployeeID"}], "prompt_id": "36ae474b-628e-4efb-ae4d-c87e0b83eba3"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the rate of order cancellations in relation to the total number of orders placed?"}, {"role": "assistant", "content": "SELECT CAST(COUNT(CASE WHEN ShippedDate IS NULL THEN 1 ELSE NULL END) AS REAL) / COUNT(*) AS CancellationRate FROM Orders"}], "prompt_id": "2c037af8-51f7-4e5f-86bc-50fb32843a85"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the sales share of each category in comparison to the total sales?"}, {"role": "assistant", "content": "SELECT Categories.CategoryName, (SUM([Order Details].UnitPrice * [Order Details].Quantity) / SUM(SUM([Order Details].UnitPrice * [Order Details].Quantity)) OVER ()) AS SalesShare FROM Categories INNER JOIN Products ON Categories.CategoryID = Products.CategoryID INNER JOIN [Order Details] ON Products.ProductID = [Order Details].ProductID GROUP BY Categories.CategoryName;"}], "prompt_id": "355a5750-9ca1-4f0e-ab30-b0dc2d831521"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the order cancellation rate for each product category?"}, {"role": "assistant", "content": "SELECT CategoryID, COUNT(CASE WHEN ShippedDate IS NOT NULL THEN 1 END) / COUNT(Orders.OrderID) AS CancellationRate FROM [Order Details] JOIN Products ON [Order Details].ProductID = Products.ProductID JOIN Orders ON [Order Details].OrderID = Orders.OrderID GROUP BY CategoryID;"}], "prompt_id": "6ec4687d-bf5e-4a22-a2ae-8c377d5f6483"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the average freight cost for all orders?"}, {"role": "assistant", "content": "SELECT SUM(Freight) / COUNT(*) AS AvgFreightCost FROM Orders;"}], "prompt_id": "8fa1b25f-0a47-479a-8edf-1913f5c5921f"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the average order value for all orders?"}, {"role": "assistant", "content": "SELECT SUM(UnitPrice * Quantity) / COUNT(*) AS AverageOrderValue FROM [Order Details];"}], "prompt_id": "313a655f-cb86-4345-8b69-7fd22af6b841"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the average customer lifetime value (CLV) for each customer?"}, {"role": "assistant", "content": "SELECT Customers.CustomerID, (AVG([Order Details].UnitPrice * [Order Details].Quantity) * COUNT(Orders.OrderID) * (julianday(MAX(Orders.OrderDate)) - julianday(MIN(Orders.OrderDate)))) AS CLV FROM Customers LEFT JOIN Orders ON Customers.CustomerID = Orders.CustomerID LEFT JOIN [Order Details] ON Orders.OrderID = [Order Details].OrderID GROUP BY Customers.CustomerID"}], "prompt_id": "ab13878d-a453-472a-b46b-0e734e3108e8"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the attrition rate for employees by job title and department?"}, {"role": "assistant", "content": "SELECT Employees.Title, Employees.Region, (COUNT(CASE WHEN Employees.ReportsTo IS NULL THEN 1 ELSE NULL END) * 1.0 / (SELECT COUNT(EmployeeID) FROM Employees WHERE ReportsTo IS NOT NULL)) AS AttritionRate FROM Employees WHERE HireDate >= date('now', '-1 year') GROUP BY Employees.Title, Employees.Region;"}], "prompt_id": "5d41ae70-a52f-4bb2-a9dc-86f4188c673a"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the complaint rate for each product category?"}, {"role": "assistant", "content": "SELECT Categories.CategoryName, (COUNT(CASE WHEN Orders.Complaints IS NOT NULL THEN 1 ELSE NULL END) * 100.0 / COUNT(Orders.OrderID)) AS ComplaintRate FROM [Order Details] LEFT JOIN Products ON [Order Details].ProductID = Products.ProductID LEFT JOIN Categories ON Products.CategoryID = Categories.CategoryID LEFT JOIN Orders ON [Order Details].OrderID = Orders.OrderID GROUP BY Categories.CategoryName;"}], "prompt_id": "bb0b19d0-a2a8-4007-980c-e623d107aed0"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the average cost of freight for all orders?"}, {"role": "assistant", "content": "SELECT SUM(Freight) / COUNT(OrderID) AS AverageFreightCost FROM Orders"}], "prompt_id": "58f75a28-cb50-493b-abbd-f79bb7dfc585"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:How many new customers were acquired each month?"}, {"role": "assistant", "content": "SELECT strftime('%Y-%m', o.OrderDate) AS Month, COUNT(c.CustomerID) AS NewCustomerCount FROM Orders o INNER JOIN Customers c ON o.CustomerID = c.CustomerID GROUP BY Month;"}], "prompt_id": "aad36c78-6e30-41d5-b112-c43a8af98a23"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the sales share for each category in terms of total sales?"}, {"role": "assistant", "content": "SELECT Categories.CategoryName, SUM([Order Details].UnitPrice * [Order Details].Quantity) AS CategoryTotalSales, (SUM([Order Details].UnitPrice * [Order Details].Quantity) / (SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity) FROM [Order Details])) AS SalesShare FROM Categories LEFT JOIN Products ON Categories.CategoryID = Products.CategoryID LEFT JOIN [Order Details] ON Products.ProductID = [Order Details].ProductID GROUP BY Categories.CategoryName;"}], "prompt_id": "b063e30c-832d-4440-ad9d-dac31e22c92a"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:How many new customers were acquired each month?"}, {"role": "assistant", "content": "SELECT strftime('%Y-%m', Orders.OrderDate) AS Month, COUNT(DISTINCT Customers.CustomerID) AS NewCustomers FROM Customers INNER JOIN Orders ON Customers.CustomerID = Orders.CustomerID GROUP BY Month;"}], "prompt_id": "263d7f19-0598-424d-813a-3e9cfe45543c"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the attrition rate of employees over the last two years?"}, {"role": "assistant", "content": "SELECT COUNT(CASE WHEN julianday('now') - julianday(HireDate) < 730 THEN 1 ELSE NULL END) / AVG(julianday('now') - julianday(HireDate)) AS AttritionRate FROM Employees"}], "prompt_id": "051e29b3-8ac6-4655-85a7-a0122a243b0d"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the sales performance of each employee in terms of total sales generated per order handled?"}, {"role": "assistant", "content": "SELECT e.EmployeeID, SUM(od.UnitPrice * od.Quantity) / COUNT(o.OrderID) AS sales_performance FROM Employees e JOIN Orders o ON e.EmployeeID = o.EmployeeID JOIN [Order Details] od ON o.OrderID = od.OrderID GROUP BY e.EmployeeID;"}], "prompt_id": "efab9391-0e8f-4711-9c90-60ee0ee8a04d"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the sales share of each category?"}, {"role": "assistant", "content": "SELECT c.CategoryID, c.CategoryName, (SUM(od.UnitPrice * od.Quantity) / (SELECT SUM(UnitPrice * Quantity) FROM [Order Details])) * 100 AS sales_share FROM Categories c INNER JOIN Products p ON c.CategoryID = p.CategoryID INNER JOIN [Order Details] od ON p.ProductID = od.ProductID GROUP BY c.CategoryID;"}], "prompt_id": "3604af3b-492c-42c3-b02c-3f4d5f50b28f"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:How many territories are covered by each employee and what is the average coverage per employee?"}, {"role": "assistant", "content": "SELECT EmployeeTerritories.EmployeeID, COUNT(EmployeeTerritories.TerritoryID) AS TerritoryCount, COUNT(EmployeeTerritories.TerritoryID) * 1.0 / (SELECT COUNT(TerritoryID) FROM EmployeeTerritories) AS AverageCoverage FROM EmployeeTerritories GROUP BY EmployeeTerritories.EmployeeID;"}], "prompt_id": "f3a6f1fb-0896-4027-ada8-791ff75f922c"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:Which products are the most profitable in terms of total profit generated?"}, {"role": "assistant", "content": "SELECT Products.ProductName, (UnitPrice - Cost) * Quantity AS Profit FROM Products JOIN [Order Details] ON Products.ProductID = [Order Details].ProductID;"}], "prompt_id": "7137645e-41c4-450b-9f30-c9e86b72ff18"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the fill rate for each supplier in terms of units received versus units ordered?"}, {"role": "assistant", "content": "SELECT Suppliers.SupplierID, (SUM([Order Details].Quantity) / (SELECT SUM(Products.UnitsOnOrder) FROM Products)) AS FillRate FROM Suppliers JOIN Products ON Suppliers.SupplierID = Products.SupplierID JOIN [Order Details] ON Products.ProductID = [Order Details].ProductID GROUP BY Suppliers.SupplierID"}], "prompt_id": "93303e15-038f-4514-be5d-1cbb7c030afa"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the customer complaint rate for the last quarter?"}, {"role": "assistant", "content": "SELECT COUNT(Complaints) / COUNT(DISTINCT OrderID) AS ComplaintRate FROM Orders"}], "prompt_id": "ccd98ff2-52ae-4400-854a-0e0bcd9bb107"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the customer acquisition rate for each employee?"}, {"role": "assistant", "content": "SELECT e.EmployeeID, (SELECT COUNT(CustomerID) / DATEDIFF(MAX(HireDate), MIN(HireDate)) FROM Customers WHERE EmployeeID = e.EmployeeID) AS AcquisitionRate FROM Employees e;"}], "prompt_id": "af42cd87-0d9e-4516-9618-70878468bcde"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the average fulfillment time for orders shipped to each region?"}, {"role": "assistant", "content": "SELECT Orders.ShipRegion, AVG(DATEDIFF(day, Orders.OrderDate, Orders.ShippedDate)) AS AvgFulfillmentTime FROM Orders GROUP BY Orders.ShipRegion;"}], "prompt_id": "562c636a-75c2-42f5-afbf-888a0bc958c6"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the shipping efficiency rate for all orders?"}, {"role": "assistant", "content": "SELECT (COUNT(CASE WHEN JULIANDAY(o.ShippedDate) <= JULIANDAY(o.RequiredDate) THEN o.OrderID END) / COUNT(o.OrderID)) AS ShippingEfficiencyRate FROM Orders o"}], "prompt_id": "94f4871c-eabc-40c1-9c1c-8bec8157d8c2"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the retention rate of customers who made repeat purchases within the last month?"}, {"role": "assistant", "content": "SELECT COUNT(DISTINCT cust.CustomerID) / COUNT(DISTINCT cust.start_date) AS CustomerRetentionRate FROM (SELECT CustomerID, MIN(OrderDate) AS start_date FROM Orders GROUP BY CustomerID) AS cust"}], "prompt_id": "73b07e64-8602-4f6c-9088-9afe19503ac3"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the average freight cost for each order?"}, {"role": "assistant", "content": "SELECT AVG(Orders.Freight) AS AvgFreightCost FROM Orders;"}], "prompt_id": "8ce8483d-7375-462e-8025-80b734addad0"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the rate of order cancellations in the last quarter?"}, {"role": "assistant", "content": "SELECT SUM(CASE WHEN T.Status = 'cancelled' THEN 1 ELSE 0 END) / COUNT(*) AS OrderCancellationRate FROM (SELECT O.OrderID, CASE WHEN C.Status IS NOT NULL THEN 'cancelled' ELSE 'not cancelled' END AS Status FROM Orders O LEFT JOIN Cancellations C ON O.OrderID = C.OrderID);"}], "prompt_id": "c1463f53-6a65-4b24-8a70-e6aa839e2b6a"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the fill rate for each supplier in terms of units received versus units ordered?"}, {"role": "assistant", "content": "SELECT Suppliers.CompanyName, SUM(SELECT ([Order Details].Quantity * [Order Details].UnitPrice) WHERE Discontinued='No') / SUM([Order Details].Quantity * Products.UnitPrice) AS FillRate FROM [Order Details] LEFT JOIN Products ON [Order Details].ProductID = Products.ProductID LEFT JOIN Suppliers ON Products.SupplierID = Suppliers.SupplierID GROUP BY Suppliers.CompanyName"}], "prompt_id": "865c51bb-a951-45ea-a9a5-23cb320ac53b"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the employee attrition rate?"}, {"role": "assistant", "content": "SELECT (COUNT(CASE WHEN julianday(HireDate, 'start of month') = julianday(Orders.OrderDate, 'start of month') THEN 1 END) / AVG([YearlyAvgEmployeeCount])) AS AttritionRate, Employees.EmployeeID, Employees.LastName, Employees.FirstName, (SELECT COUNT(EmployeeID) / COUNT(DISTINCT julianday(HireDate, 'start of month')) AS YearlyAvgEmployeeCount FROM Employees) FROM Employees INNER JOIN Orders ON Employees.EmployeeID = Orders.EmployeeID"}], "prompt_id": "17846136-fbb1-45f8-bcb1-02cc688d879c"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the average order value (AOV) for all orders?"}, {"role": "assistant", "content": "SELECT SUM(UnitPrice * Quantity) / COUNT(DISTINCT OrderID) AS AOV FROM [Order Details];"}], "prompt_id": "d5eb6bba-5b7f-4a17-b908-d62d852224b2"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the revenue growth rate month over month?"}, {"role": "assistant", "content": "SELECT STRFTIME('%Y-%m', OrderDate) AS Month, (SUM([Order Details].UnitPrice * [Order Details].Quantity) - LAG(SUM([Order Details].UnitPrice * [Order Details].Quantity)) OVER (ORDER BY STRFTIME('%Y-%m', OrderDate)))*1.0 / LAG(SUM([Order Details].UnitPrice * [Order Details].Quantity)) OVER (ORDER BY STRFTIME('%Y-%m', OrderDate)) AS RevenueGrowthRate FROM Orders JOIN [Order Details] ON Orders.OrderID = [Order Details].OrderID GROUP BY Month"}], "prompt_id": "d98a85f9-43af-4155-8b81-7e91db847bb6"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the average number of territories covered by each employee?"}, {"role": "assistant", "content": "SELECT e.EmployeeID, COUNT(et.TerritoryID) AS TerritoryCount, AVG(COUNT(et.TerritoryID)) OVER () AS AverageTerritories FROM Employees e LEFT JOIN EmployeeTerritories et ON e.EmployeeID = et.EmployeeID GROUP BY e.EmployeeID ORDER BY AverageTerritories"}], "prompt_id": "bdf96201-ea31-4a98-a969-f2d522cc2b38"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the complaint rate per order?"}, {"role": "assistant", "content": "SELECT COUNT(Complaints) / COUNT(*) AS ComplaintRate FROM Orders WHERE Complaints IS NOT NULL"}], "prompt_id": "b5af0d9e-781b-4a20-8eb7-d40fda5e4bf2"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the inventory turnover rate for each product category?"}, {"role": "assistant", "content": "SELECT Categories.CategoryName, (SUM([Order Details].UnitPrice * [Order Details].Quantity) * 1.0 / AVG(Products.UnitsInStock)) AS InventoryTurnover FROM Categories LEFT JOIN Products ON Categories.CategoryID = Products.CategoryID LEFT JOIN [Order Details] ON Products.ProductID = [Order Details].ProductID GROUP BY Categories.CategoryName;"}], "prompt_id": "c2769389-81b2-44a9-b945-5a364dc5f9b8"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the average order value (AOV) for all orders?"}, {"role": "assistant", "content": "SELECT (SUM([Order Details].UnitPrice * [Order Details].Quantity) / COUNT(Orders.OrderID)) AS AOV FROM [Order Details] INNER JOIN Orders ON [Order Details].OrderID = Orders.OrderID"}], "prompt_id": "2b88d365-84ba-490f-895d-9afb98a0e39c"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the customer retention rate within a specific period?"}, {"role": "assistant", "content": "SELECT COUNT(RepeatCustomers) / COUNT(InitialCustomers) AS RetentionRate FROM (SELECT COUNT(CustomerID) AS InitialCustomers, SUM(CASE WHEN COUNT(CustomerID) > 1 THEN 1 ELSE 0 END) AS RepeatCustomers FROM Customers LEFT JOIN Orders ON Customers.CustomerID = Orders.CustomerID WHERE Orders.OrderDate BETWEEN 'start_date' AND 'end_date' GROUP BY Customers.CustomerID);"}], "prompt_id": "a46a94ba-bc20-4b30-9d0e-0f5470c5c69d"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the fill rate for each supplier in terms of units received and units ordered?"}, {"role": "assistant", "content": "SELECT Suppliers.CompanyName, SUM([Order Details].Quantity * (1.0 * Products.UnitPrice)) / SUM([Order Details].Quantity) AS FillRate FROM Suppliers LEFT JOIN Products ON Suppliers.SupplierID = Products.SupplierID LEFT JOIN [Order Details] ON Products.ProductID = [Order Details].ProductID GROUP BY Suppliers.CompanyName"}], "prompt_id": "74561e60-95e2-428e-9dbb-aa73a40efc21"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the customer retention rate for the current period?"}, {"role": "assistant", "content": "SELECT COUNT(DISTINCT o.CustomerID) / COUNT(c.CustomerID) AS RetentionRate FROM Customers c LEFT JOIN Orders o ON c.CustomerID = o.CustomerID WHERE o.OrderDate >= 'start_date' AND o.OrderDate <= 'end_date';"}], "prompt_id": "fd256195-96a5-40df-8b0a-2ec63a1d53b9"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the average sales generated by each employee?"}, {"role": "assistant", "content": "SELECT Employees.EmployeeID, (SUM([Order Details].UnitPrice * [Order Details].Quantity) / COUNT(Orders.OrderID)) AS SalesPerformance FROM Employees INNER JOIN Orders ON Employees.EmployeeID = Orders.EmployeeID INNER JOIN [Order Details] ON Orders.OrderID = [Order Details].OrderID GROUP BY Employees.EmployeeID;"}], "prompt_id": "93d06aa9-6282-4896-9399-70ef620c7a4b"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the geographic distribution of customers for each category of products?"}, {"role": "assistant", "content": "SELECT Categories.CategoryName, Customers.City, SUM(Orders.OrderID) * 1.0 / COUNT(DISTINCT Customers.CustomerID) AS GeographicDistribution FROM Customers INNER JOIN Orders ON Customers.CustomerID = Orders.CustomerID INNER JOIN [Order Details] ON Orders.OrderID = [Order Details].OrderID INNER JOIN Products ON [Order Details].ProductID = Products.ProductID INNER JOIN Categories ON Products.CategoryID = Categories.CategoryID GROUP BY Categories.CategoryName, Customers.City;"}], "prompt_id": "4c19cd47-6b48-41bd-9e7b-a37440ee1e4a"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the rate of order cancellations for each employee?"}, {"role": "assistant", "content": "SELECT o.EmployeeID, e.FirstName, e.LastName, (COUNT(CASE WHEN o.ShippedDate IS NULL THEN 1 END) / COUNT(o.OrderID)) AS CancellationRate FROM Orders o JOIN Employees e ON o.EmployeeID = e.EmployeeID GROUP BY o.EmployeeID, e.FirstName, e.LastName;"}], "prompt_id": "0a13d19f-4a83-4786-b2c5-4562ee800613"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the average customer lifetime value (CLV) for customers in each region?"}, {"role": "assistant", "content": "SELECT Customers.Region, AVG([Order Details].UnitPrice * [Order Details].Quantity) AS AOV, COUNT(DISTINCT Orders.OrderID) / COUNT(DISTINCT Customers.CustomerID) AS PurchaseFrequency, ROUND(julianday(MAX(Orders.OrderDate)) - min(julianday(Orders.OrderDate)), 2) AS CustomerLifespan, ROUND(AVG([Order Details].UnitPrice * [Order Details].Quantity) * (COUNT(DISTINCT Orders.OrderID) / COUNT(DISTINCT Customers.CustomerID)) * (julianday(MAX(Orders.OrderDate)) - min(julianday(Orders.OrderDate))), 2) AS CLV FROM Customers INNER JOIN Orders ON Customers.CustomerID = Orders.CustomerID LEFT JOIN [Order Details] ON Orders.OrderID = [Order Details].OrderID GROUP BY Customers.Region;"}], "prompt_id": "a2641a3a-a942-4c01-aa19-38e1cc5d923d"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the order cancellation rate based on the number of canceled orders?"}, {"role": "assistant", "content": "SELECT COUNT(CASE WHEN Status = 'canceled' THEN 1 END) / COUNT(OrderID) AS OrderCancellationRate FROM Orders"}], "prompt_id": "6cca99d0-adc0-48c1-b1c2-25de3fb6e5e8"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:How does the geographic distribution of customers vary by city and region?"}, {"role": "assistant", "content": "SELECT City, Region, COUNT(CustomerID) AS CustomerCount FROM Customers GROUP BY City, Region"}], "prompt_id": "9afa7b64-bdf3-4c25-a124-2e4cb13d59a9"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the product availability rate for each product?"}, {"role": "assistant", "content": "SELECT od.ProductID, COUNT(CASE WHEN p.UnitsInStock >= od.Quantity THEN 1 ELSE 0 END) / COUNT(od.OrderID) AS availability_rate FROM [Order Details] od JOIN Products p ON od.ProductID = p.ProductID GROUP BY od.ProductID"}], "prompt_id": "ebab4bfe-76e9-47ae-ade6-43cb7d55439e"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the average time taken to fulfill an order?"}, {"role": "assistant", "content": "SELECT AVG(julianday(o.ShippedDate) - julianday(o.OrderDate)) AS AvgFulfillmentTime FROM Orders o;"}], "prompt_id": "2f217ee2-97bb-41c7-9326-13303a4c2089"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the revenue growth rate between the current and previous periods?"}, {"role": "assistant", "content": "SELECT (SUM(od.UnitPrice * od.Quantity) - (SELECT SUM(UnitPrice * Quantity) FROM [Order Details] WHERE OrderDate >= 'previous_start_date' AND OrderDate <= 'previous_end_date')) / (SELECT SUM(UnitPrice * Quantity) FROM [Order Details] WHERE OrderDate >= 'previous_start_date' AND OrderDate <= 'previous_end_date') AS RevenueGrowthRate FROM [Order Details] od WHERE OrderDate >= 'current_start_date' AND OrderDate <= 'current_end_date';"}], "prompt_id": "273bf325-4e56-4058-8775-04ffa5d3e4b1"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:13. How often do products hit their reorder level within the last 90 days?"}, {"role": "assistant", "content": "SELECT ProductID, COUNT(*) AS ReorderFrequency FROM [Order Details] WHERE julianday('now') - julianday(OrderDate) <= 90 GROUP BY ProductID"}], "prompt_id": "9b44a4b5-7203-4c94-80c3-c64dd218573a"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the efficiency of shipping for each region in terms of on-time deliveries?"}, {"role": "assistant", "content": "SELECT Orders.ShipRegion, (SUM(CASE WHEN Orders.ShippedDate <= Orders.RequiredDate THEN 1 ELSE 0 END) / COUNT(Orders.OrderID)) AS ShippingEfficiency FROM Orders GROUP BY Orders.ShipRegion;"}], "prompt_id": "807a797c-4903-4e6a-9410-c1a96062d078"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:Which products are the most profitable based on the calculated profitability value?"}, {"role": "assistant", "content": "SELECT P.ProductID, P.ProductName, (P.UnitPrice - P.Cost) * D.Quantity AS Profitability FROM Products P INNER JOIN [Order Details] D ON P.ProductID = D.ProductID"}], "prompt_id": "5c35cc41-fda1-43fa-9556-623cda98d501"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the shipping efficiency in terms of on-time delivery?"}, {"role": "assistant", "content": "SELECT SUM(CASE WHEN ShippedDate <= RequiredDate THEN 1 ELSE 0 END) / COUNT(OrderID) AS ShippingEfficiency FROM Orders;"}], "prompt_id": "615ac152-6c74-4405-8668-c1e826563f95"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the product availability rate for each product?"}, {"role": "assistant", "content": "SELECT Products.ProductName, COUNT(CASE WHEN Products.UnitsInStock > ([Order Details].Quantity * 2) THEN 1 END) / COUNT([Order Details].ProductID) AS AvailabilityRate FROM Products JOIN [Order Details] ON Products.ProductID = [Order Details].ProductID GROUP BY Products.ProductName"}], "prompt_id": "160a342d-82a6-4c9c-9a65-2c10651a8b88"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the customer retention rate for the current period?"}, {"role": "assistant", "content": "SELECT COUNT(DISTINCT Orders.CustomerID) / (SELECT COUNT(*) FROM Customers) AS CustomerRetentionRate FROM Orders;"}], "prompt_id": "0d7c6df0-66da-4f23-9cc9-510fd195d5c5"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the inventory turnover for each product category?"}, {"role": "assistant", "content": "SELECT Categories.CategoryName, SUM([Order Details].UnitPrice * [Order Details].Quantity) / AVG(Products.UnitsInStock) AS InventoryTurnover FROM Categories LEFT JOIN Products ON Categories.CategoryID = Products.CategoryID LEFT JOIN [Order Details] ON Products.ProductID = [Order Details].ProductID GROUP BY Categories.CategoryName"}], "prompt_id": "12d48ec9-7110-4d41-9a74-d80a87d94135"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:How many territories are covered by each employee?"}, {"role": "assistant", "content": "SELECT E.EmployeeID, COUNT(ET.TerritoryID) AS TerritoriesCovered FROM Employees E LEFT JOIN EmployeeTerritories ET ON E.EmployeeID = ET.EmployeeID GROUP BY E.EmployeeID"}], "prompt_id": "4389d6ec-f55b-41a1-aa58-08e3f77b4155"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the revenue growth rate compared to the previous period?"}, {"role": "assistant", "content": "SELECT (SUM([Order Details].UnitPrice * [Order Details].Quantity) - (SELECT SUM(UnitPrice * Quantity) FROM [Order Details] WHERE julianday(OrderDate) > (SELECT MAX(julianday(OrderDate)) FROM Orders WHERE julianday(OrderDate) < (SELECT MAX(julianday(OrderDate)) FROM Orders)))) / (SELECT SUM(UnitPrice * Quantity) FROM [Order Details] WHERE julianday(OrderDate) > (SELECT MAX(julianday(OrderDate)) FROM Orders WHERE julianday(OrderDate) < (SELECT MAX(julianday(OrderDate)) FROM Orders))) AS RevenueGrowthRate FROM [Order Details] INNER JOIN Orders ON [Order Details].OrderID = Orders.OrderID;"}], "prompt_id": "d5f9375e-a9b1-4067-abd0-f3a97a35526b"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the fill rate for each supplier based on units received and units ordered?"}, {"role": "assistant", "content": "SELECT s.CompanyName, SUM(od.UnitsReceived) / SUM(od.UnitsOrdered) AS FillRate FROM Suppliers s INNER JOIN Products p ON s.SupplierID = p.SupplierID INNER JOIN [Order Details] od ON p.ProductID = od.ProductID GROUP BY s.CompanyName"}], "prompt_id": "7d88fd54-735f-4a82-82fc-5d9da7a9b918"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the revenue growth rate for each product category?"}, {"role": "assistant", "content": "SELECT Categories.CategoryID, (SUM([Order Details].UnitPrice * [Order Details].Quantity) - LAG(SUM([Order Details].UnitPrice * [Order Details].Quantity)) OVER (ORDER BY Orders.OrderDate)) / LAG(SUM([Order Details].UnitPrice * [Order Details].Quantity)) OVER (ORDER BY Orders.OrderDate) * 100.0 AS GrowthRate FROM [Order Details] INNER JOIN Orders ON [Order Details].OrderID = Orders.OrderID INNER JOIN Products ON [Order Details].ProductID = Products.ProductID INNER JOIN Categories ON Products.CategoryID = Categories.CategoryID GROUP BY Categories.CategoryID"}], "prompt_id": "6eb63147-eaba-4902-85c7-382e70947dc5"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the total sales generated by each employee and the average sales per order?"}, {"role": "assistant", "content": "SELECT e.EmployeeID, e.LastName, e.FirstName, SUM(od.UnitPrice * od.Quantity) AS TotalSales, SUM(od.UnitPrice * od.Quantity) / COUNT(o.OrderID) AS AvgSalesPerOrder FROM Employees e JOIN Orders o ON e.EmployeeID = o.EmployeeID JOIN [Order Details] od ON o.OrderID = od.OrderID GROUP BY e.EmployeeID, e.LastName, e.FirstName"}], "prompt_id": "d6166a39-ebcb-4cd0-be8d-7f42d66514c2"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:How many territories are covered by each employee?"}, {"role": "assistant", "content": "SELECT e.EmployeeID, COUNT(et.TerritoryID) AS NumTerritories FROM Employees e JOIN EmployeeTerritories et ON e.EmployeeID = et.EmployeeID GROUP BY e.EmployeeID"}], "prompt_id": "4e3b70c6-757e-491c-882a-772aebaf892a"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:How often do products hit their reorder level within the last 6 months?"}, {"role": "assistant", "content": "SELECT ProductID, COUNT(DATEADD(MONTH, -6, GETDATE()) <= OrderDate) AS ReorderFrequency FROM [Order Details] WHERE DATEADD(MONTH, -6, GETDATE()) <= OrderDate GROUP BY ProductID"}], "prompt_id": "65a38015-549f-4bab-a874-69a3b17fdb0f"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:Which employee is responsible for the most number of territories?"}, {"role": "assistant", "content": "SELECT e.EmployeeID, COUNT(DISTINCT et.TerritoryID) AS TerritoryCount FROM Employees e JOIN EmployeeTerritories et ON e.EmployeeID = et.EmployeeID GROUP BY e.EmployeeID"}], "prompt_id": "5a79df73-2850-46c5-afb6-0702667a6bc4"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the average order fulfillment time?"}, {"role": "assistant", "content": "SELECT AVG(JULIANDAY(ShippedDate) - JULIANDAY(OrderDate)) AS FulfillmentTime FROM Orders;"}], "prompt_id": "31af6dba-2033-4eff-a17d-40fe3bf0560d"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:In which cities do we have the highest customer concentration?"}, {"role": "assistant", "content": "SELECT Customers.City, COUNT(DISTINCT Customers.CustomerID) AS CustomerCount FROM Customers GROUP BY Customers.City"}], "prompt_id": "11abddbd-4e47-4eda-95f8-459e2a95f498"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the average order fulfillment time?"}, {"role": "assistant", "content": "SELECT AVG(julianday(Orders.ShippedDate) - julianday(Orders.OrderDate)) AS AvgFulfillmentTime FROM Orders;"}], "prompt_id": "a9aa86b7-8c20-4bcc-9b3f-16a51756d0c0"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the average order fulfillment time for all orders?"}, {"role": "assistant", "content": "SELECT AVG(JULIANDAY(O.ShippedDate) - JULIANDAY(O.OrderDate)) AS OrderFulfillmentTime FROM Orders O;"}], "prompt_id": "6d1ff057-5c13-4e01-9943-e2cdb2fbfc95"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the average freight cost for all orders?"}, {"role": "assistant", "content": "SELECT AVG(Freight) AS AverageFreightCost FROM Orders"}], "prompt_id": "8bfe258e-9317-4af8-9926-ea3e6fc9d3ce"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the sales performance (total sales per order handled) for each employee?"}, {"role": "assistant", "content": "SELECT e.EmployeeID, SUM([Order Details].UnitPrice * [Order Details].Quantity) / COUNT(DISTINCT o.OrderID) AS SalesPerformance FROM Employees e INNER JOIN Orders o ON e.EmployeeID = o.EmployeeID INNER JOIN [Order Details] ON o.OrderID = [Order Details].OrderID GROUP BY e.EmployeeID"}], "prompt_id": "49adb211-86d5-4399-8a7b-19deb512143d"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the customer retention rate within a specific period?"}, {"role": "assistant", "content": "SELECT (COUNT(DISTINCT o.CustomerID) - (SELECT COUNT(DISTINCT CustomerID) FROM Orders WHERE OrderDate < '[start_date]')) / COUNT(DISTINCT CustomerID) AS CustomerRetentionRate FROM Orders o"}], "prompt_id": "6ba329d1-17ab-413e-b78b-b721ddba5eed"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the attrition rate of employees in the past year?"}, {"role": "assistant", "content": "SELECT COUNT(CASE WHEN julianday(HireDate) - julianday(TerminationDate) <= 365 THEN 1 END) / AVG(julianday(HireDate) - julianday(TerminationDate)) AS AttritionRate FROM Employees"}], "prompt_id": "59134a3a-9a78-4d42-ae6a-0bc3febf16e9"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:How many new customers were acquired per day in the last quarter?"}, {"role": "assistant", "content": "SELECT COUNT(CustomerID) / COUNT(DISTINCT OrderDate) AS CustomerAcquisitionRate FROM Customers"}], "prompt_id": "eeed8fe1-afce-4c1b-bf0a-4b308e00b0ab"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the sales share for each category?"}, {"role": "assistant", "content": "SELECT Categories.CategoryID, SUM(UnitPrice * Quantity * (1 - Discount)) / (SELECT SUM(UnitPrice * Quantity * (1 - Discount)) FROM [Order Details]) AS SalesShare FROM [Order Details] LEFT JOIN Products ON [Order Details].ProductID = Products.ProductID LEFT JOIN Categories ON Products.CategoryID = Categories.CategoryID GROUP BY Categories.CategoryID"}], "prompt_id": "413f84e7-88c0-4805-87fd-305c0f2fbf54"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the customer lifetime value (CLV) for each customer?"}, {"role": "assistant", "content": "SELECT c.CustomerID, AVG(od.UnitPrice * od.Quantity) * COUNT(o.OrderID) * (julianday(MAX(o.OrderDate)) - julianday(MIN(o.OrderDate))) AS CLV FROM Customers c JOIN Orders o ON c.CustomerID = o.CustomerID JOIN [Order Details] od ON o.OrderID = od.OrderID GROUP BY c.CustomerID"}], "prompt_id": "8704dfaf-f39f-46d7-8b3f-85c8019e8105"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:How many territories are covered by each employee?"}, {"role": "assistant", "content": "SELECT EmployeeID, COUNT(TerritoryID) AS CoveredTerritories FROM EmployeeTerritories GROUP BY EmployeeID;"}], "prompt_id": "2d237705-f469-4815-98c4-ba2f22dfcfe4"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the fill rate for each supplier?"}, {"role": "assistant", "content": "SELECT s.CompanyName, SUM(od.Quantity) / SUM(p.UnitsInStock + p.UnitsOnOrder) AS FillRate FROM Suppliers s LEFT JOIN Products p ON s.SupplierID = p.SupplierID LEFT JOIN [Order Details] od ON p.ProductID = od.ProductID GROUP BY s.SupplierID;"}], "prompt_id": "88bbfe04-16c0-4854-9922-8e164d9d45ec"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the retention rate of customers who made repeat purchases compared to new customers within the last quarter?"}, {"role": "assistant", "content": "SELECT strftime('%Y-%m', o.OrderDate) AS Month, (COUNT(DISTINCT o.CustomerID, o.OrderID) * 1.0 / COUNT(DISTINCT o.CustomerID)) AS RetentionRate FROM Orders o WHERE o.OrderDate BETWEEN date('now', '-3 month') AND date('now') GROUP BY Month;"}], "prompt_id": "9ef2eb08-8069-479d-aa0b-5459d1537c34"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the total sales generated by each employee and their corresponding average sales performance rate?"}, {"role": "assistant", "content": "SELECT Employees.EmployeeID, SUM(UnitPrice * Quantity) AS TotalSales, COUNT(Orders.OrderID) AS OrderCount, SUM(UnitPrice * Quantity) / COUNT(Orders.OrderID) AS SalesPerformance FROM Employees JOIN Orders ON Employees.EmployeeID = Orders.EmployeeID JOIN [Order Details] ON Orders.OrderID = [Order Details].OrderID GROUP BY Employees.EmployeeID"}], "prompt_id": "1eea2472-5d4e-48b6-aaf5-ab47056e549f"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the average freight cost for each shipper?"}, {"role": "assistant", "content": "SELECT Orders.ShipVia, AVG(Orders.Freight) AS AverageFreightCost FROM Orders GROUP BY Orders.ShipVia"}], "prompt_id": "e9fe7b1d-fe95-4921-a222-99dd930ed514"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the average freight cost for all orders?"}, {"role": "assistant", "content": "SELECT SUM(Freight) / COUNT(OrderID) AS AverageFreightCost FROM Orders"}], "prompt_id": "a36f1769-38c3-4783-8b43-1a0f06d6b988"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:Which employee has the highest sales performance?"}, {"role": "assistant", "content": "SELECT Employees.EmployeeID, SUM([Order Details].UnitPrice * [Order Details].Quantity) / COUNT(DISTINCT Orders.OrderID) AS SalesPerformance FROM Employees JOIN Orders ON Employees.EmployeeID = Orders.EmployeeID JOIN [Order Details] ON Orders.OrderID = [Order Details].OrderID GROUP BY Employees.EmployeeID"}], "prompt_id": "51ac9c8e-97b7-4a65-a0c7-6b6851c4bbab"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the complaint rate for each customer?"}, {"role": "assistant", "content": "SELECT Customers.CustomerID, COUNT(*) * 1.0 / (SELECT COUNT(*) FROM Orders) AS ComplaintRate FROM Orders JOIN Customers ON Customers.CustomerID = Orders.CustomerID WHERE Orders.Complaint IS NOT NULL GROUP BY Customers.CustomerID"}], "prompt_id": "76953d6d-23a4-4f67-84f3-33fb8fc9a646"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the sales share of each category in the total sales?"}, {"role": "assistant", "content": "SELECT c.CategoryID, (SUM(od.UnitPrice * od.Quantity) / (SELECT SUM(od.UnitPrice * od.Quantity) FROM [Order Details] od)) AS sales_share FROM Categories c JOIN Products p ON c.CategoryID = p.CategoryID JOIN [Order Details] od ON p.ProductID = od.ProductID GROUP BY c.CategoryID"}], "prompt_id": "8840a6f8-72a4-4282-a266-a45d30d9056b"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the fill rate for each supplier based on received and ordered units?"}, {"role": "assistant", "content": "SELECT s.SupplierID, (SUM(od.UnitsReceived) / SUM(od.Quantity)) AS FillRate FROM Suppliers s INNER JOIN Products p ON s.SupplierID = p.SupplierID INNER JOIN [Order Details] od ON p.ProductID = od.ProductID GROUP BY s.SupplierID"}], "prompt_id": "fd1e4242-4e7e-4d9f-96d2-fb86d896d14b"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:How is the customer geographic distribution across different countries?"}, {"role": "assistant", "content": "SELECT Customers.Country, COUNT(CustomerID) AS CustomerCount FROM Customers GROUP BY Customers.Country"}], "prompt_id": "18bf4778-f663-40dd-871f-fdab4573089c"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:How many territories are covered by each employee?"}, {"role": "assistant", "content": "SELECT e.EmployeeID, COUNT(et.TerritoryID) AS TerritoryCount\nFROM Employees e\nJOIN EmployeeTerritories et ON e.EmployeeID = et.EmployeeID\nGROUP BY e.EmployeeID;"}], "prompt_id": "74d94308-cbcf-4e71-93c4-4bdca2525707"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the average order fulfillment time for all orders?"}, {"role": "assistant", "content": "SELECT AVG(JULIANDAY(ShippedDate) - JULIANDAY(OrderDate)) AS AvgFulfillmentTime FROM Orders"}], "prompt_id": "b340af57-61ac-4cf7-bca3-91a3da86e179"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the inventory turnover for each product?"}, {"role": "assistant", "content": "SELECT p.ProductID, p.ProductName, (SUM(od.UnitPrice * od.Quantity) / ((p.UnitsInStock + p.UnitsOnOrder) / 2)) AS InventoryTurnover FROM Products p LEFT JOIN [Order Details] od ON p.ProductID = od.ProductID GROUP BY p.ProductID, p.ProductName"}], "prompt_id": "af7d9473-ffd0-4774-802a-12a011ab0fe6"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the employee sales performance by region?"}, {"role": "assistant", "content": "SELECT Employees.Region, Employees.LastName, Employees.FirstName, SUM([Order Details].UnitPrice * [Order Details].Quantity) / COUNT(Orders.OrderID) AS SalesPerformance FROM Employees LEFT JOIN Orders ON Employees.EmployeeID = Orders.EmployeeID LEFT JOIN [Order Details] ON Orders.OrderID = [Order Details].OrderID GROUP BY Employees.Region, Employees.LastName, Employees.FirstName"}], "prompt_id": "9e8f96b9-0a29-4a6b-8c4b-d9e013438641"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the attrition rate of employees within the past year?"}, {"role": "assistant", "content": "SELECT (COUNT(CASE WHEN (julianday(HireDate) - julianday(BirthDate)) <= 365 THEN 1 END)) / (COUNT(HireDate) / COUNT(DISTINCT HireDate)) AS AttritionRate FROM Employees WHERE julianday(HireDate) - julianday(TODAY) <= 365;"}], "prompt_id": "211ab7f4-5f30-4bc4-9f85-16c1992bbd94"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the order cancellation rate for the past month?"}, {"role": "assistant", "content": "SELECT (COUNT(CASE WHEN DATE('now', '-1 month') = DATE(RequiredDate) THEN 1 END) / COUNT(*)) AS CancellationRate FROM Orders;"}], "prompt_id": "4f2fe141-c72f-46fc-bc3a-bd07cae891f1"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the average order fulfillment time for each employee?"}, {"role": "assistant", "content": "SELECT Employees.EmployeeID, AVG(julianday(Orders.ShippedDate) - julianday(Orders.OrderDate)) AS AvgFulfillmentTime FROM Employees INNER JOIN Orders ON Employees.EmployeeID = Orders.EmployeeID GROUP BY Employees.EmployeeID;"}], "prompt_id": "1916fe5e-0560-4711-8951-7fc96cbd10fb"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the reorder frequency for each product within the last 6 months?"}, {"role": "assistant", "content": "SELECT ProductID, COUNT(CASE WHEN OrderDate BETWEEN DATEADD(month, -6, GETDATE()) AND GETDATE() THEN 1 END) AS ReorderFrequency FROM [Order Details] GROUP BY ProductID"}], "prompt_id": "1511ccd4-09e0-468c-9d84-d75cf91662fc"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:How many new customers were acquired each month?"}, {"role": "assistant", "content": "SELECT strftime('%Y-%m', Orders.OrderDate) AS Month, COUNT(DISTINCT Customers.CustomerID) AS NewCustomersAcquired FROM Orders JOIN Customers ON Orders.CustomerID = Customers.CustomerID GROUP BY Month;"}], "prompt_id": "94d21331-4d48-4633-afe0-520a6bd6d283"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:How many employees have handled more than 100 orders?"}, {"role": "assistant", "content": "SELECT EmployeeID, COUNT(*) AS order_count FROM Orders GROUP BY EmployeeID HAVING order_count > 100"}], "prompt_id": "601bf380-e4b0-42ed-8095-708ba5b40c3c"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the rate of customer complaints compared to the total orders?"}, {"role": "assistant", "content": "SELECT COUNT(CASE WHEN ComplaintReceived = 'Yes' THEN 1 ELSE NULL END) / COUNT(*) AS ComplaintRate FROM Orders"}], "prompt_id": "93c1e1e6-dc62-4c30-91b9-e6ba8adfb792"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the average sales performance of employees in terms of total sales generated per order handled?"}, {"role": "assistant", "content": "SELECT Employees.EmployeeID, (SUM(UnitPrice * Quantity) / COUNT(DISTINCT Orders.OrderID)) AS SalesPerformance FROM Employees LEFT JOIN Orders ON Employees.EmployeeID = Orders.EmployeeID INNER JOIN [Order Details] ON Orders.OrderID = [Order Details].OrderID GROUP BY Employees.EmployeeID;"}], "prompt_id": "89c1bf4e-63e9-4ffa-a964-7cb0298715c6"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:Can you determine the order cancellation rate for each employee and compare it based on their hire date?"}, {"role": "assistant", "content": "SELECT Employees.FirstName, Employees.LastName, COUNT(DISTINCT Orders.OrderID) * 1.0 / COUNT(DISTINCT Employees.EmployeeID) AS CancellationRate FROM Employees LEFT JOIN Orders ON Employees.EmployeeID = Orders.EmployeeID GROUP BY Employees.FirstName, Employees.LastName;"}], "prompt_id": "1aaa6232-dfa3-4671-a980-fa42a9acd9c0"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:How often are our products available when ordered?"}, {"role": "assistant", "content": "SELECT p.ProductID, p.ProductName, SUM(CASE WHEN UnitsInStock >= od.Quantity THEN 1 ELSE 0 END) / COUNT(od.Quantity) AS AvailabilityRate FROM Products p JOIN [Order Details] od ON p.ProductID = od.ProductID GROUP BY p.ProductID, p.ProductName"}], "prompt_id": "0a98f4a9-697f-48fe-911f-baf1a9d4bfe2"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the availability rate of a specific product when ordered?"}, {"role": "assistant", "content": "SELECT p.ProductName, COUNT(CASE WHEN UnitsInStock - Quantity >= 0 THEN 1 ELSE NULL END) / COUNT(*) AS AvailabilityRate FROM Products p JOIN [Order Details] od ON p.ProductID = od.ProductID"}], "prompt_id": "c203da01-88b2-4f38-a458-d2c05e1829f4"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the attrition rate of employees within a given period?"}, {"role": "assistant", "content": "SELECT strftime('%Y',HireDate) as Year, COUNT(DISTINCT EmployeeID) AS attrition_count, COUNT(DISTINCT EmployeeID) / (julianday(MAX(HireDate)) - julianday(MIN(HireDate))) AS attrition_rate FROM Employees GROUP BY Year"}], "prompt_id": "cac1564a-6452-4fe9-9e7a-46bbd3a3b2c3"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the efficiency of shipping based on on-time delivery?"}, {"role": "assistant", "content": "SELECT SUM(IIF(RequiredDate >= ShippedDate, 1, 0)) / COUNT(*) AS ShippingEfficiency FROM Orders;"}], "prompt_id": "7fc6799a-60c2-4d61-8a2e-8bf4eaeea067"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:How efficient is the shipping process in terms of orders shipped on or before the required date?"}, {"role": "assistant", "content": "SELECT e.EmployeeID, SUM(CASE WHEN julianday(o.ShippedDate) - julianday(o.RequiredDate) <= 0 THEN 1 ELSE 0 END) * 100.0 / COUNT(o.OrderID) AS ShippingEfficiency FROM Employees e JOIN Orders o ON e.EmployeeID = o.EmployeeID GROUP BY e.EmployeeID"}], "prompt_id": "c95133a2-1e11-4c3e-ae95-69d7426a72d6"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the average freight cost for all orders?"}, {"role": "assistant", "content": "SELECT AVG(Orders.Freight) AS AvgFreightCost FROM Orders"}], "prompt_id": "21a72803-2eff-43c7-9b77-ff247ab27db6"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the average freight cost for each order?"}, {"role": "assistant", "content": "SELECT AVG(Freight) AS AvgFreightCost FROM Orders;"}], "prompt_id": "065e2111-4fce-446b-810b-1d44d6581b5d"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:How does the sales performance vary across different employees?"}, {"role": "assistant", "content": "SELECT e.EmployeeID, (SUM(od.UnitPrice * od.Quantity) / COUNT(o.OrderID)) AS SalesPerformance FROM Employees e LEFT JOIN Orders o ON e.EmployeeID = o.EmployeeID LEFT JOIN [Order Details] od ON o.OrderID = od.OrderID GROUP BY e.EmployeeID"}], "prompt_id": "1258b5d1-18bd-4069-9aff-886fd36ae74f"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:How many territories are covered by each employee?"}, {"role": "assistant", "content": "SELECT e.EmployeeID, COUNT(et.TerritoryID) AS TerritoryCount FROM Employees e INNER JOIN EmployeeTerritories et ON e.EmployeeID = et.EmployeeID GROUP BY e.EmployeeID"}], "prompt_id": "d122cee5-0b56-4da9-b989-a204a5c4ffc6"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:Which products are the most profitable in terms of net profit?"}, {"role": "assistant", "content": "SELECT Products.ProductID, (Products.UnitPrice - [Order Details].UnitPrice) * [Order Details].Quantity AS NetProfit FROM Products INNER JOIN [Order Details] ON Products.ProductID = [Order Details].ProductID;"}], "prompt_id": "0611fe67-c1d1-41b8-9fbc-afbff06ead1c"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the inventory turnover rate for each product category?"}, {"role": "assistant", "content": "SELECT Categories.CategoryID, SUM([Order Details].UnitPrice * [Order Details].Quantity) / AVG(Products.UnitsInStock) AS InventoryTurnover FROM Categories JOIN Products ON Categories.CategoryID = Products.CategoryID JOIN [Order Details] ON Products.ProductID = [Order Details].ProductID GROUP BY Categories.CategoryID;"}], "prompt_id": "e9af0dd7-b6cc-48af-a296-1f9d11fe0159"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the fill rate for each supplier in terms of units received and units ordered?"}, {"role": "assistant", "content": "SELECT SupplierID, SUM(([Order Details].Quantity * (1 - [Order Details].Discount))) / SUM([Order Details].Quantity) AS FillRate FROM [Order Details] LEFT JOIN Products ON [Order Details].ProductID = Products.ProductID GROUP BY SupplierID"}], "prompt_id": "89782e95-4e13-4793-bf5a-46502a751225"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the availability rate for each product based on orders placed in the last quarter?"}, {"role": "assistant", "content": "SELECT Products.ProductID, COUNT(CASE WHEN Products.UnitsInStock >= [Order Details].Quantity THEN 1 END) / CAST(COUNT([Order Details].OrderID) AS REAL) AS AvailabilityRate FROM Products INNER JOIN [Order Details] ON Products.ProductID = [Order Details].ProductID WHERE OrderDate > date('now', '-3 month')"}], "prompt_id": "cac42eb8-298c-44ad-a337-4a5811119669"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the complaint rate for each customer?"}, {"role": "assistant", "content": "SELECT CustomerID, COUNT(Orders.OrderID) / (JULIANDAY(MAX(Orders.OrderDate)) - JULIANDAY(MIN(Orders.OrderDate))) AS complaint_rate FROM Orders GROUP BY CustomerID"}], "prompt_id": "bbd6e996-35e7-42b6-9422-cbaa216ad028"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the average order fulfillment time for all orders in the database?"}, {"role": "assistant", "content": "SELECT AVG(JULIANDAY(o.ShippedDate) - JULIANDAY(o.OrderDate)) AS AvgFulfillmentTime FROM Orders o"}], "prompt_id": "5f4f7708-9242-4512-99b8-07f3c7d0c45f"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:How are the customers distributed geographically in terms of city and region?"}, {"role": "assistant", "content": "SELECT City, COUNT(CustomerID) AS CustomerCount FROM Customers GROUP BY City"}], "prompt_id": "81a1e910-4755-4f5d-b2f1-4d8cf6eb664d"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the customer acquisition rate for the past year?"}, {"role": "assistant", "content": "SELECT COUNT(CustomerID) / COUNT(DISTINCT OrderDate) AS CustomerAcquisitionRate FROM Orders"}], "prompt_id": "5caa4890-8f0e-4ec5-935e-b40b80a303a8"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the inventory turnover rate for each product category?"}, {"role": "assistant", "content": "SELECT p.CategoryID, SUM(od.UnitPrice * od.Quantity) / AVG((p.UnitsInStock + p.UnitsOnOrder) / 2) AS InventoryTurnover FROM Products p LEFT JOIN [Order Details] od ON p.ProductID = od.ProductID GROUP BY p.CategoryID;"}], "prompt_id": "49732eba-ecc5-43a6-adf4-efb883391ce5"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the average freight cost for all orders?"}, {"role": "assistant", "content": "SELECT AVG(Freight) AS AverageFreightCost FROM Orders"}], "prompt_id": "2d3a9f0c-19da-44bd-a4c0-d502faec58a7"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the average order fulfillment time for each customer?"}, {"role": "assistant", "content": "SELECT Customers.CustomerID, AVG(julianday(Orders.ShippedDate) - julianday(Orders.OrderDate)) AS FulfillmentTime FROM Customers INNER JOIN Orders ON Customers.CustomerID = Orders.CustomerID GROUP BY Customers.CustomerID;"}], "prompt_id": "ff932dfe-be85-474e-aa49-e0baf025918b"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the geographic distribution of customers by city and region?"}, {"role": "assistant", "content": "SELECT City, COUNT(CustomerID) AS CustomerCount FROM Customers GROUP BY City"}], "prompt_id": "a1bf9bb7-8645-46f0-a83a-6af01c2e7e9c"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the inventory turnover for each product category?"}, {"role": "assistant", "content": "SELECT Categories.CategoryName, SUM([Order Details].UnitPrice * [Order Details].Quantity) / AVG(Products.UnitsInStock) AS InventoryTurnover FROM Categories INNER JOIN Products ON Categories.CategoryID = Products.CategoryID INNER JOIN [Order Details] ON Products.ProductID = [Order Details].ProductID GROUP BY Categories.CategoryName;"}], "prompt_id": "244e431c-eb86-4672-8934-ea35fe4b6681"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:19. What is the product availability rate for each product?"}, {"role": "assistant", "content": "SELECT p.ProductName, COUNT(o.OrderID) * 1.0 / (SELECT COUNT(OrderID) FROM Orders) AS AvailabilityRate FROM Products p INNER JOIN [Order Details] od ON p.ProductID = od.ProductID INNER JOIN Orders o ON od.OrderID = o.OrderID WHERE p.UnitsInStock > od.Quantity GROUP BY p.ProductName"}], "prompt_id": "be564ff1-a266-4eea-9dcc-4bc1ac8b625a"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the efficiency of shipping in meeting required dates?"}, {"role": "assistant", "content": "SELECT SUM(CASE WHEN ShippedDate <= RequiredDate THEN 1 ELSE 0 END) / COUNT(OrderID) AS ShippingEfficiency FROM Orders"}], "prompt_id": "e0eb5a2e-35ed-43bb-a0fc-1c1f4b313480"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the distribution of customers across different cities and regions?"}, {"role": "assistant", "content": "SELECT City, COUNT(CustomerID) AS CustomerCount FROM Customers GROUP BY City"}], "prompt_id": "574e4568-4cac-48a2-9cfb-05bdee80f4fe"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the customer retention rate for the last quarter?"}, {"role": "assistant", "content": "SELECT COUNT(DISTINCT CustomerID) / (SELECT COUNT(DISTINCT CustomerID) FROM Customers WHERE DATEPART(QUARTER, OrderDate) = DATEPART(QUARTER, GETDATE()) - 1) AS CustomerRetentionRate FROM Orders WHERE DATEPART(QUARTER, OrderDate) = DATEPART(QUARTER, GETDATE()) - 1"}], "prompt_id": "880ac85b-b1f0-4024-bc3e-d04e66b61576"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the product availability rate for each product?"}, {"role": "assistant", "content": "SELECT Products.ProductID, SUM(CASE WHEN Products.UnitsInStock > [Order Details].Quantity THEN 1 ELSE 0 END) / COUNT([Order Details].OrderID) AS AvailabilityRate FROM Products LEFT JOIN [Order Details] ON Products.ProductID = [Order Details].ProductID GROUP BY Products.ProductID;"}], "prompt_id": "269e45ec-7446-4287-a682-d530e0bafcc6"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:Which employee has the highest sales performance based on total sales and number of orders handled?"}, {"role": "assistant", "content": "SELECT e.EmployeeID, SUM(od.UnitPrice * od.Quantity) / COUNT(o.OrderID) AS SalesPerformance FROM Employees e INNER JOIN Orders o ON e.EmployeeID = o.EmployeeID INNER JOIN [Order Details] od ON o.OrderID = od.OrderID GROUP BY e.EmployeeID"}], "prompt_id": "4a26c7cf-3c27-4e99-8478-b8527f8d17e8"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:Which products are the most profitable based on the profit generated from each product?"}, {"role": "assistant", "content": "SELECT Products.ProductName, (Products.UnitPrice - [Order Details].UnitPrice) * [Order Details].Quantity AS Profit FROM Products INNER JOIN [Order Details] ON Products.ProductID = [Order Details].ProductID"}], "prompt_id": "27f17d43-4415-4626-9172-85d5671d28be"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the average freight cost for each shipping company?"}, {"role": "assistant", "content": "SELECT ShipVia, AVG(Freight) AS AvgFreightCost FROM Orders GROUP BY ShipVia"}], "prompt_id": "3eec3f6b-366c-463a-9bbc-3ecdc713c110"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the customer acquisition rate for each customer type?"}, {"role": "assistant", "content": "SELECT CustomerDemographics.CustomerTypeID, COUNT(Customers.CustomerID) / COUNT(DISTINCT Orders.OrderDate) AS CustomerAcquisitionRate FROM Customers LEFT JOIN Orders ON Customers.CustomerID = Orders.CustomerID WHERE Orders.OrderDate BETWEEN 'start_date' AND 'end_date' GROUP BY CustomerDemographics.CustomerTypeID;"}], "prompt_id": "6c78680c-9333-49fa-b1ff-b23ed99010fe"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:1. What is the average order value (AOV) for all orders?"}, {"role": "assistant", "content": "SELECT SUM(UnitPrice * Quantity) / COUNT(*) AS AOV FROM [Order Details]"}], "prompt_id": "33aa6d75-5ba4-44af-a5a3-1e7d3b99ace2"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the customer complaint rate by country?"}, {"role": "assistant", "content": "SELECT Customers.Country, COUNT(CASE WHEN Complaints IS NOT NULL THEN OrderID END) / COUNT(OrderID) AS ComplaintRate FROM Customers INNER JOIN Orders ON Customers.CustomerID = Orders.CustomerID GROUP BY Customers.Country"}], "prompt_id": "8fccb895-99e0-45b7-b543-8bdfe0fc45d2"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:20. What is the revenue growth rate compared to the previous period?"}, {"role": "assistant", "content": "SELECT (SUM(o.Freight) - LAG(SUM(o.Freight)) OVER (ORDER BY OrderDate)) / LAG(SUM(o.Freight)) OVER (ORDER BY OrderDate) AS RevenueGrowthRate FROM Orders o"}], "prompt_id": "a7717862-2d10-430e-a553-7661d5d1f124"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the average order value (AOV) for all orders?"}, {"role": "assistant", "content": "SELECT SUM(UnitPrice * Quantity) / COUNT(OrderID) AS AOV FROM [Order Details];"}], "prompt_id": "d049068d-0684-4346-9fbc-6d411592d445"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the inventory turnover for the 'Beverages' category?"}, {"role": "assistant", "content": "SELECT (SUM([Order Details].UnitPrice * [Order Details].Quantity) / (COALESCE((P1.UnitsInStock + P1.UnitsOnOrder) / 2, 1))) AS InventoryTurnover FROM Products P1 JOIN Categories ON P1.CategoryID = Categories.CategoryID JOIN [Order Details] ON P1.ProductID = [Order Details].ProductID WHERE Categories.CategoryName = 'Beverages';"}], "prompt_id": "1e1f99ce-baaa-4aa5-8e4f-57d25864e446"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:15. What is the employee attrition rate for a specific period?"}, {"role": "assistant", "content": "SELECT COUNT(e.EmployeeID) / CAST(SUM(julianday(e.HireDate) - julianday(e.BirthDate)) AS NUMERIC) AS AttritionRate FROM Employees e"}], "prompt_id": "a46948d0-9fb9-4ef2-a570-ab2f52d0d33b"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the average order fulfillment time for each employee?"}, {"role": "assistant", "content": "SELECT Employees.FirstName, Employees.LastName, AVG(julianday(Orders.ShippedDate) - julianday(Orders.OrderDate)) AS AvgFulfillmentTime FROM Employees INNER JOIN Orders ON Employees.EmployeeID = Orders.EmployeeID GROUP BY Employees.EmployeeID;"}], "prompt_id": "449945a9-065a-4ed5-87fe-d538ec3eefde"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the sales performance of each employee in terms of total sales and number of orders handled?"}, {"role": "assistant", "content": "SELECT e.EmployeeID, e.FirstName, e.LastName, SUM(od.UnitPrice * od.Quantity) AS TotalSales, COUNT(o.OrderID) AS TotalOrders, SUM(od.UnitPrice * od.Quantity) / COUNT(o.OrderID) AS SalesPerOrder FROM Employees e LEFT JOIN Orders o ON e.EmployeeID = o.EmployeeID LEFT JOIN [Order Details] od ON o.OrderID = od.OrderID GROUP BY e.EmployeeID;"}], "prompt_id": "429975fe-5ceb-4f55-8dc5-4676e7b9c45d"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the customer retention rate over a specific period?"}, {"role": "assistant", "content": "SELECT (COUNT(DISTINCT C1.CustomerID) / COUNT(DISTINCT O1.CustomerID)) AS RetentionRate FROM Customers C1 INNER JOIN Orders O1 ON C1.CustomerID = O1.CustomerID"}], "prompt_id": "6cb65478-c4a4-4a43-b74e-8f81ba257641"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:How are customers distributed geographically in terms of city and region?"}, {"role": "assistant", "content": "SELECT Customers.City, COUNT(Customers.CustomerID) AS CustomerCount FROM Customers GROUP BY Customers.City;"}], "prompt_id": "7a5c55b4-a389-4e6b-bf9f-6d0469281bef"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:Which products are the most profitable based on unit price, cost, and quantity sold?"}, {"role": "assistant", "content": "SELECT p.ProductID, (p.UnitPrice - p.Cost) * od.Quantity AS Profit FROM Products p INNER JOIN [Order Details] od ON p.ProductID = od.ProductID"}], "prompt_id": "655d2735-895f-4ad5-a037-3f5925443d4a"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:How many territories are covered by each employee?"}, {"role": "assistant", "content": "SELECT Employees.EmployeeID, COUNT(TerritoryID) AS TerritoryCount FROM Employees LEFT JOIN EmployeeTerritories ON Employees.EmployeeID = EmployeeTerritories.EmployeeID GROUP BY Employees.EmployeeID;"}], "prompt_id": "c52b73db-cc9a-4c01-b161-da3c46fecf83"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the customer complaint rate for each product category?"}, {"role": "assistant", "content": "SELECT Categories.CategoryID, COUNT(Orders.OrderID) * 1.0 / (SELECT COUNT(Orders.OrderID) FROM Orders) AS ComplaintRate FROM Categories INNER JOIN Products ON Categories.CategoryID = Products.CategoryID INNER JOIN [Order Details] ON Products.ProductID = [Order Details].ProductID INNER JOIN Orders ON [Order Details].OrderID = Orders.OrderID WHERE Orders.Complaints IS NOT NULL GROUP BY Categories.CategoryID;"}], "prompt_id": "a84bca50-46e2-4a4d-9ba0-cf1582acc221"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:How many new customers were acquired each month in the past year?"}, {"role": "assistant", "content": "SELECT strftime('%Y-%m', Orders.OrderDate) AS Month, COUNT(DISTINCT Customers.CustomerID) AS NewCustomers FROM Customers INNER JOIN Orders ON Customers.CustomerID = Orders.CustomerID WHERE Orders.OrderDate BETWEEN date('now', 'start of year', '-1 year') AND date('now', 'start of year', '-1 day') GROUP BY Month;"}], "prompt_id": "a535a7a9-2728-4f74-91ac-589a1ae9bd47"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the employee attrition rate for the company?"}, {"role": "assistant", "content": "SELECT EXTRACT(YEAR FROM e.HireDate) AS Year, COUNT(CASE WHEN e.TerminationDate IS NOT NULL THEN 1 END) / COUNT(DISTINCT e.EmployeeID) AS AttritionRate\nFROM Employees e\nGROUP BY Year"}], "prompt_id": "9f3d3a0a-ec89-4155-9901-6bda1d7b9ed6"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the complaint rate for each customer based on the number of complaints received?"}, {"role": "assistant", "content": "SELECT Customers.CustomerID, COUNT(Orders.OrderID) / COUNT(CASE WHEN Orders.ComplaintReceived = 'Yes' THEN 1 END) AS ComplaintRate FROM Customers JOIN Orders ON Customers.CustomerID = Orders.CustomerID GROUP BY Customers.CustomerID"}], "prompt_id": "5f3a4701-7a40-4247-b77f-a9d81baf2032"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the customer retention rate for the past quarter?"}, {"role": "assistant", "content": "SELECT (COUNT(DISTINCT Orders.CustomerID) - COUNT(DISTINCT IIF(ShippedDate IS NULL, Orders.CustomerID, NULL))) / COUNT(DISTINCT Orders.CustomerID) AS RetentionRate FROM Orders WHERE OrderDate BETWEEN date('now', '-3 month') AND date('now');"}], "prompt_id": "68a2f950-5490-4624-8797-aceaaed8b4ed"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the supplier fill rate for each supplier in the product orders?"}, {"role": "assistant", "content": "SELECT s.SupplierID, s.CompanyName, SUM(od.UnitsReceived) / SUM(od.UnitsOrdered) AS FillRate FROM Suppliers s INNER JOIN Products p ON s.SupplierID = p.SupplierID INNER JOIN [Order Details] od ON p.ProductID = od.ProductID GROUP BY s.SupplierID, s.CompanyName"}], "prompt_id": "14ad11f6-b646-4871-baff-3e4d24a8b402"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the average order value for all orders?"}, {"role": "assistant", "content": "SELECT SUM(UnitPrice * Quantity) / COUNT(OrderID) AS average_order_value FROM [Order Details]"}], "prompt_id": "466f7cbe-3ce9-4a2c-b6be-409a0c5050a4"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the total sales generated by each employee and the average sales per order they handle?"}, {"role": "assistant", "content": "SELECT e.EmployeeID, SUM(od.UnitPrice * od.Quantity) AS TotalSales, COUNT(o.OrderID) AS OrderCount, SUM(od.UnitPrice * od.Quantity) / COUNT(o.OrderID) AS AverageSalesPerOrder FROM Employees e INNER JOIN Orders o ON e.EmployeeID = o.EmployeeID INNER JOIN [Order Details] od ON o.OrderID = od.OrderID GROUP BY e.EmployeeID"}], "prompt_id": "10043d5f-400f-4d7b-82dd-5a705c58ea35"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the customer retention rate for the previous year?"}, {"role": "assistant", "content": "SELECT (COUNT(DISTINCT o2.CustomerID) / COUNT(DISTINCT o1.CustomerID)) AS CustomerRetentionRate FROM Orders o1 JOIN Orders o2 ON o1.CustomerID = o2.CustomerID WHERE o1.OrderDate = [start_date] AND o2.OrderDate = [end_date];"}], "prompt_id": "5436e1e9-63f8-493d-982c-0e0b9f810ea5"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the average cost of freight for all orders?"}, {"role": "assistant", "content": "SELECT AVG(Freight) AS AverageFreightCost FROM Orders"}], "prompt_id": "a20efef4-8039-4d40-82d2-3d40181c45c6"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the customer complaint rate for each shipping company?"}, {"role": "assistant", "content": "SELECT Shippers.CompanyName, COUNT(CASE WHEN Orders.Complaints IS NOT NULL THEN 1 ELSE 0 END) * 1.0 / COUNT(Orders.OrderID) AS ComplaintRate FROM Orders JOIN Shippers ON Orders.ShipVia = Shippers.ShipperID GROUP BY Shippers.CompanyName"}], "prompt_id": "081eade2-abc1-43d9-8b28-c3c288b4f1b0"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:3. What is the customer retention rate for the past quarter?"}, {"role": "assistant", "content": "SELECT COUNT(DISTINCT o.CustomerID) / COUNT(DISTINCT c.CustomerID) AS CustomerRetentionRate FROM Customers c LEFT JOIN Orders o ON c.CustomerID = o.CustomerID WHERE o.OrderDate BETWEEN 'start_date' AND 'end_date'"}], "prompt_id": "c491de93-11fd-4a15-b94a-5b08e3d4c0fb"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:How many territories are covered by each employee?"}, {"role": "assistant", "content": "SELECT EmployeeID, COUNT(DISTINCT TerritoryID) AS Coverage FROM EmployeeTerritories GROUP BY EmployeeID"}], "prompt_id": "cd00ed28-15d5-411b-a511-fb93589fd2d5"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:How efficient is the shipping process?"}, {"role": "assistant", "content": "SELECT (COUNT(CASE WHEN Orders.ShippedDate <= Orders.RequiredDate THEN 1 END) / COUNT(Orders.OrderID)) AS ShippingEfficiency FROM Orders"}], "prompt_id": "6a2455c5-5433-49ca-bb28-2c0d3d134fee"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the shipping efficiency for each shipper?"}, {"role": "assistant", "content": "SELECT Shippers.CompanyName, (COUNT(Orders.ShippedDate <= Orders.RequiredDate) / (SELECT COUNT(Orders.OrderID) FROM Orders)) AS ShippingEfficiency FROM Shippers INNER JOIN Orders ON Shippers.ShipperID = Orders.ShipVia GROUP BY Shippers.CompanyName;"}], "prompt_id": "9cc6610e-16ff-4910-8e8a-e9328c2c37b9"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the reorder frequency for each product within a specific time frame?"}, {"role": "assistant", "content": "SELECT p.ProductName, COUNT(p.ProductID) / DATEDIFF('d', MIN(od.OrderDate), MAX(od.OrderDate)) AS ReorderFrequency FROM Products p JOIN [Order Details] od ON p.ProductID = od.ProductID GROUP BY p.ProductName"}], "prompt_id": "8e330ef6-49b1-4c67-bdf5-21b6a62e3721"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the average order fulfillment time for orders shipped in the last quarter?"}, {"role": "assistant", "content": "SELECT AVG(julianday(ShippedDate) - julianday(OrderDate)) AS AverageFulfillmentTime FROM Orders WHERE ShippedDate IS NOT NULL AND OrderDate BETWEEN date('now', '-3 months') AND date('now')"}], "prompt_id": "93bdf871-d360-4f93-9e28-9959390af2ba"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the average order fulfillment time?"}, {"role": "assistant", "content": "SELECT AVG(julianday(ShippedDate) - julianday(OrderDate)) AS OrderFulfillmentTime FROM Orders"}], "prompt_id": "d9c475e3-fd08-4f74-82bf-0bdbf9263e2a"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the customer lifetime value (CLV) for each customer?"}, {"role": "assistant", "content": "SELECT c.CustomerID, AVG(od.UnitPrice * od.Quantity) * COUNT(o.OrderID) * (JULIANDAY(MAX(o.OrderDate)) - JULIANDAY(MIN(o.OrderDate))) AS CLV FROM Customers c LEFT JOIN Orders o ON c.CustomerID = o.CustomerID LEFT JOIN [Order Details] od ON o.OrderID = od.OrderID GROUP BY c.CustomerID"}], "prompt_id": "d20920f0-c970-4cb4-b58d-777cd26673b7"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the customer complaint rate for last month?"}, {"role": "assistant", "content": "SELECT STRFTIME('%m', OrderDate) AS Month, (SELECT COUNT(OrderID) FROM Orders WHERE ComplaintStatus = 'complaint') / COUNT(OrderID) AS ComplaintRate FROM Orders GROUP BY Month"}], "prompt_id": "33a8a151-e7a4-4430-b3d8-2d7f08fccaeb"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:How often do products hit their reorder level within the last six months?"}, {"role": "assistant", "content": "SELECT ProductID, COUNT(*) AS ReorderFrequency FROM [Order Details] WHERE UnitsInStock <= ReorderLevel AND OrderDate BETWEEN date('now', '-6 month') AND date('now') GROUP BY ProductID;"}], "prompt_id": "42de3f91-fd06-4de0-8084-c0b12696f6c2"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the average order value for all orders?"}, {"role": "assistant", "content": "SELECT SUM(od.UnitPrice * od.Quantity) / COUNT(DISTINCT o.OrderID) AS AOV FROM [Order Details] od JOIN Orders o ON od.OrderID = o.OrderID"}], "prompt_id": "2c5ba27b-d3f4-4896-b479-c72a2e2cb439"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the shipping efficiency in terms of on-time shipments?"}, {"role": "assistant", "content": "SELECT SUM(CASE WHEN (julianday(ShippedDate) - julianday(RequiredDate)) <= 0 THEN 1 ELSE 0 END) / COUNT(*) AS ShippingEfficiency FROM Orders"}], "prompt_id": "4353fc4e-961d-4d0e-841f-03b3681e6d7f"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the customer lifetime value for each customer?"}, {"role": "assistant", "content": "SELECT Customers.CustomerID, AVG([Order Details].UnitPrice * [Order Details].Quantity) * COUNT(Orders.OrderID) * (JULIANDAY(MAX(Orders.OrderDate)) - JULIANDAY(MIN(Orders.OrderDate))) AS CLV FROM Customers INNER JOIN Orders ON Customers.CustomerID = Orders.CustomerID INNER JOIN [Order Details] ON Orders.OrderID = [Order Details].OrderID;"}], "prompt_id": "463001d2-ee72-4010-8443-55dfed02202b"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:How many days does it take on average to fulfill an order?"}, {"role": "assistant", "content": "SELECT AVG(julianday(ShippedDate) - julianday(OrderDate)) AS AvgFulfillmentTime FROM Orders;"}], "prompt_id": "87583408-3bcb-489b-a34a-3dd58c9ba2e7"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:How many territories are covered by each employee?"}, {"role": "assistant", "content": "SELECT Employees.EmployeeID, COUNT(TerritoryID) AS TerritoryCount FROM Employees LEFT JOIN EmployeeTerritories ON Employees.EmployeeID = EmployeeTerritories.EmployeeID GROUP BY Employees.EmployeeID;"}], "prompt_id": "109cc0b1-fb19-4d4c-ab92-3b5e0293b975"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the shipping efficiency for each shipper?"}, {"role": "assistant", "content": "SELECT s.CompanyName, COUNT(CASE WHEN o.ShippedDate <= o.RequiredDate THEN 1 END) / COUNT(o.OrderID) AS ShippingEfficiency FROM Suppliers s INNER JOIN Products p ON s.SupplierID = p.SupplierID INNER JOIN [Order Details] od ON p.ProductID = od.ProductID INNER JOIN Orders o ON od.OrderID = o.OrderID GROUP BY s.CompanyName"}], "prompt_id": "e0ec0316-3086-4273-8af6-b2d3218f2b98"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the revenue growth rate for each supplier?"}, {"role": "assistant", "content": "SELECT s.CompanyName, (SELECT ((SUM(UnitPrice * Quantity) - (SELECT SUM(UnitPrice * Quantity) FROM Orders o INNER JOIN [Order Details] od ON o.OrderID = od.OrderID WHERE o.ShipVia = s.SupplierID AND o.OrderDate < DATEADD(YEAR, -1, GETDATE()))) / (SELECT SUM(UnitPrice * Quantity) FROM Orders o INNER JOIN [Order Details] od ON o.OrderID = od.OrderID WHERE o.ShipVia = s.SupplierID AND o.OrderDate < DATEADD(YEAR, -1, GETDATE()))) / DATEDIFF(MAX(OrderDate), MIN(OrderDate))) FROM Orders o INNER JOIN [Order Details] od ON o.OrderID = od.OrderID WHERE o.ShipVia = s.SupplierID) / (COUNT(OrderID) / DATEDIFF(MAX(OrderDate), MIN(OrderDate))) AS RevenueGrowthRate FROM Suppliers s;"}], "prompt_id": "b2e7678a-7f67-4458-8651-b2195a75b1a7"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the average order value (AOV) for each customer?"}, {"role": "assistant", "content": "SELECT Customers.CustomerID, AVG([Order Details].UnitPrice * [Order Details].Quantity) AS AOV FROM Customers LEFT JOIN Orders ON Customers.CustomerID = Orders.CustomerID LEFT JOIN [Order Details] ON Orders.OrderID = [Order Details].OrderID GROUP BY Customers.CustomerID"}], "prompt_id": "04dd87cb-be0d-409c-aa43-3433ac945ec9"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the supplier fill rate for each supplier?"}, {"role": "assistant", "content": "SELECT Suppliers.CompanyName, SUM([Order Details].Quantity) AS TotalUnitsReceived, SUM([Order Details].Quantity) / (Products.UnitsOnOrder + [Order Details].Quantity) AS SupplierFillRate FROM Suppliers INNER JOIN Products ON Suppliers.SupplierID = Products.SupplierID INNER JOIN [Order Details] ON Products.ProductID = [Order Details].ProductID GROUP BY Suppliers.CompanyName;"}], "prompt_id": "aaa90a3c-ddbd-4b53-94f4-c3d194273db1"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:Which employee has the highest sales performance in terms of total sales generated?"}, {"role": "assistant", "content": "SELECT Employees.EmployeeID, SUM([Order Details].UnitPrice * [Order Details].Quantity) / COUNT(DISTINCT Orders.OrderID) AS SalesPerformance FROM Employees INNER JOIN Orders ON Employees.EmployeeID = Orders.EmployeeID INNER JOIN [Order Details] ON Orders.OrderID = [Order Details].OrderID GROUP BY Employees.EmployeeID;"}], "prompt_id": "1ec02921-83d7-402e-a282-9db963b87ce1"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the revenue growth rate compared to the previous period?"}, {"role": "assistant", "content": "SELECT strftime('%Y-%m', OrderDate) AS Month, (SUM([Order Details].UnitPrice * [Order Details].Quantity) - LAG(SUM([Order Details].UnitPrice * [Order Details].Quantity)) OVER (ORDER BY OrderDate)) * 100.0 / LAG(SUM([Order Details].UnitPrice * [Order Details].Quantity)) OVER (ORDER BY OrderDate) AS RevenueGrowthRate FROM Orders INNER JOIN [Order Details] ON Orders.OrderID = [Order Details].OrderID GROUP BY Month;"}], "prompt_id": "f16959dc-e676-429c-9fa1-df05d1cb4fca"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the employee attrition rate?"}, {"role": "assistant", "content": "SELECT (COUNT(e.EmployeeID) - (COUNT(e.EmployeeID) - (COUNT(e.hiredate) / 30) + COUNT(e.EmployeeID))) / (COUNT(e.EmployeeID) - (COUNT(e.EmployeeID) - (COUNT(e.hiredate) / 30))) AS AttritionRate FROM Employees e"}], "prompt_id": "bddbf649-f8c0-4826-a031-5b1af845f508"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the average customer lifetime value for each region?"}, {"role": "assistant", "content": "SELECT Customers.Region, AVG([Order Details].UnitPrice * [Order Details].Quantity) * COUNT(Orders.OrderID) * DATEDIFF(DAY, MIN(OrderDate), GETDATE()) AS CLV FROM Customers INNER JOIN Orders ON Customers.CustomerID = Orders.CustomerID INNER JOIN [Order Details] ON Orders.OrderID = [Order Details].OrderID GROUP BY Customers.Region"}], "prompt_id": "0611d329-9dfa-45a9-b4b7-440eb12f350b"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:How is the geographic distribution of customers across different cities and regions?"}, {"role": "assistant", "content": "SELECT City, Region, COUNT(CustomerID) AS CustomerCount FROM Customers GROUP BY City, Region"}], "prompt_id": "0107a800-fca2-4776-9b59-abcb18183245"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the rate of customer complaints for orders?"}, {"role": "assistant", "content": "SELECT 1.0 * COUNT(CASE WHEN ComplaintReceived = 'Yes' THEN 1 END) / COUNT(*) AS CustomerComplaintRate FROM Orders;"}], "prompt_id": "2ff1a13e-5fbd-494e-bb09-e780de8fe5f6"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:How many new customers were acquired each day?"}, {"role": "assistant", "content": "SELECT COUNT(CustomerID) / COUNT(DISTINCT OrderDate) AS CustomerAcquisitionRate FROM Orders"}], "prompt_id": "a460b5bd-af68-4561-b788-072794e0a712"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the customer retention rate?"}, {"role": "assistant", "content": "SELECT (COUNT(DISTINCT Orders.CustomerID) - COUNT(Orders.CustomerID)) / COUNT(DISTINCT Orders.CustomerID) AS RetentionRate FROM Orders JOIN Customers ON Orders.CustomerID = Customers.CustomerID;"}], "prompt_id": "48a378e1-0fdb-4166-b207-71d53f6e0e72"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the retention rate of customers who made repeat purchases within the last 6 months?"}, {"role": "assistant", "content": "SELECT COUNT(DISTINCT repeated_customers.CustomerID) * 100.0 / COUNT(DISTINCT initial_customers.CustomerID) AS RetentionRate FROM (SELECT CustomerID FROM Orders WHERE Orders.OrderDate BETWEEN date('now', '-6 months') AND date('now')) AS repeated_customers JOIN (SELECT CustomerID FROM Orders WHERE Orders.OrderDate < date('now', '-6 months')) AS initial_customers"}], "prompt_id": "b977ecf8-9973-4b63-8c6f-c67a58a80c9b"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the availability rate of each product in stock when ordered?"}, {"role": "assistant", "content": "SELECT p.ProductID, p.ProductName, COUNT(CASE WHEN p.UnitsInStock >= od.Quantity THEN 1 ELSE 0 END) / COUNT(DISTINCT od.OrderID) AS AvailabilityRate FROM Products p INNER JOIN [Order Details] od ON p.ProductID = od.ProductID GROUP BY p.ProductID, p.ProductName"}], "prompt_id": "1dc27815-fa22-428f-aa3f-03842a1870d5"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the retention rate of customers for each employee?"}, {"role": "assistant", "content": "SELECT Employees.EmployeeID, Employees.FirstName, Employees.LastName, (COUNT(DISTINCT Orders.OrderID) - COUNT(DISTINCT Orders.CustomerID)) / COUNT(DISTINCT Orders.CustomerID) AS RetentionRate FROM Employees LEFT JOIN Orders ON Employees.EmployeeID = Orders.EmployeeID GROUP BY Employees.EmployeeID;"}], "prompt_id": "2c444ee9-2240-4d75-9b69-cd250e33f951"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the customer complaint rate for each region?"}, {"role": "assistant", "content": "SELECT Customers.Region, COUNT(CASE WHEN Orders.Complaint IS NOT NULL THEN 1 END) / COUNT(*) AS ComplaintRate FROM Customers INNER JOIN Orders ON Customers.CustomerID = Orders.CustomerID GROUP BY Customers.Region;"}], "prompt_id": "80068ad7-39b8-4e32-81f0-0f34fe46094a"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the retention rate of customers who made repeat purchases within the last quarter?"}, {"role": "assistant", "content": "SELECT strftime('%Y-Q%q', Orders.OrderDate) AS Quarter, COUNT(DISTINCT CASE WHEN EXISTS (SELECT 1 FROM Orders O WHERE O.CustomerID = C.CustomerID AND O.OrderDate < DATE_SUB(Orders.OrderDate, INTERVAL 1 YEAR)) THEN C.CustomerID END) / COUNT(DISTINCT C.CustomerID) AS CustomerRetentionRate FROM Customers C INNER JOIN Orders ON C.CustomerID = Orders.CustomerID GROUP BY Quarter"}], "prompt_id": "15982513-f414-4440-aedf-efc7abaf9fec"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the total sales generated by each employee and the average sales per order handled by that employee?"}, {"role": "assistant", "content": "SELECT EmployeeID, SUM(UnitPrice * Quantity) AS TotalSales, SUM(Quantity) / COUNT(DISTINCT OrderID) AS AvgSalesPerOrder FROM [Order Details] INNER JOIN Orders ON [Order Details].OrderID = Orders.OrderID GROUP BY EmployeeID;"}], "prompt_id": "20925067-0015-4a77-97ea-28b840e372df"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:How many territories are covered by each employee on average?"}, {"role": "assistant", "content": "SELECT e.EmployeeID, COUNT(TerritoryID) AS TerritoryCount FROM Employees e LEFT JOIN EmployeeTerritories et ON e.EmployeeID = et.EmployeeID GROUP BY e.EmployeeID;"}], "prompt_id": "848683a9-ba5c-454f-9c61-dc41273c666f"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the distribution of customer geographic locations for a specific country?"}, {"role": "assistant", "content": "SELECT Customers.Country, Customers.City, COUNT(Customers.CustomerID) AS CustomerCount FROM Customers GROUP BY Customers.Country, Customers.City"}], "prompt_id": "96f2b928-2896-46f3-b631-2f87dceff4cf"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the product availability rate for each product?"}, {"role": "assistant", "content": "SELECT Products.ProductName, (COUNT(CASE WHEN Products.UnitsInStock + Products.UnitsOnOrder > [Order Details].Quantity THEN 1 ELSE NULL END) / COUNT(Orders.OrderID)) * 100 AS AvailabilityRate FROM Products JOIN [Order Details] ON Products.ProductID = [Order Details].ProductID JOIN Orders ON [Order Details].OrderID = Orders.OrderID GROUP BY Products.ProductName"}], "prompt_id": "939adab7-49ec-4da0-9707-61cc61012a49"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the sales share of each category compared to the total sales?"}, {"role": "assistant", "content": "SELECT Categories.CategoryID, SUM([Order Details].UnitPrice * [Order Details].Quantity) / (SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity) FROM [Order Details]) AS SalesShare FROM Categories INNER JOIN Products ON Categories.CategoryID = Products.CategoryID INNER JOIN [Order Details] ON Products.ProductID = [Order Details].ProductID GROUP BY Categories.CategoryID;"}], "prompt_id": "65ad3c3a-9db8-418f-b6f8-0df20ad37b25"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the average customer lifetime value (CLV) for each customer?"}, {"role": "assistant", "content": "SELECT Customers.CustomerID, AVG([Order Details].UnitPrice * [Order Details].Quantity) * COUNT(DISTINCT Orders.OrderID) * (julianday('now') - julianday(MIN(Orders.OrderDate))) AS CLV FROM [Order Details] INNER JOIN Orders ON [Order Details].OrderID = Orders.OrderID INNER JOIN Customers ON Orders.CustomerID = Customers.CustomerID;"}], "prompt_id": "be5aaec5-507e-4211-b22d-0f517fecab31"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the reorder frequency of each product within a specific time frame?"}, {"role": "assistant", "content": "SELECT p.ProductID, COUNT(*) AS ReorderFrequency FROM Products p INNER JOIN [Order Details] od ON p.ProductID = od.ProductID WHERE reorder_condition GROUP BY p.ProductID"}], "prompt_id": "2924a51e-650a-4739-ae28-bcad1a3f840b"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the customer lifetime value (CLV) for each customer?"}, {"role": "assistant", "content": "SELECT C.CustomerID, (AVG(OD.UnitPrice * OD.Quantity) * COUNT(DISTINCT O.OrderID) * (JULIANDAY(MAX(O.OrderDate)) - JULIANDAY(MIN(O.OrderDate)))) AS CLV FROM Customers C JOIN Orders O ON C.CustomerID = O.CustomerID JOIN [Order Details] OD ON O.OrderID = OD.OrderID;"}], "prompt_id": "76dbdd1e-bac7-4c49-887c-9389f22da888"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:Which employee covers the most territories, and how many?"}, {"role": "assistant", "content": "SELECT e.EmployeeID, e.LastName, e.FirstName, COUNT(et.TerritoryID) AS TerritoriesCovered FROM Employees e LEFT JOIN EmployeeTerritories et ON e.EmployeeID = et.EmployeeID GROUP BY e.EmployeeID, e.LastName, e.FirstName"}], "prompt_id": "7991a44e-ff41-479c-90a8-976115a91627"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the average order fulfillment time for each shipping company?"}, {"role": "assistant", "content": "SELECT ShipVia, AVG(julianday(ShippedDate) - julianday(OrderDate)) AS AvgFulfillmentTime FROM Orders GROUP BY ShipVia;"}], "prompt_id": "14317b5d-e378-4938-b21d-f3afbb94446e"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the customer lifetime value (CLV) for each customer?"}, {"role": "assistant", "content": "SELECT c.CustomerID, AVG((od.UnitPrice * od.Quantity) * COUNT(DISTINCT o.OrderID)) * DATEDIFF(day, MIN(o.OrderDate), MAX(o.OrderDate)) AS CLV FROM Customers c JOIN Orders o ON c.CustomerID = o.CustomerID JOIN [Order Details] od ON o.OrderID = od.OrderID"}], "prompt_id": "ad17cf58-9172-4c3b-bbdb-6f6d83a17c2c"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:How efficient is the shipping process for each shipping company?"}, {"role": "assistant", "content": "SELECT Shippers.CompanyName, SUM(CASE WHEN ShippedDate <= RequiredDate THEN 1 ELSE 0 END) / COUNT(Orders.OrderID) AS ShippingEfficiency FROM Shippers INNER JOIN Orders ON Shippers.ShipperID = Orders.ShipVia GROUP BY Shippers.CompanyName;"}], "prompt_id": "9243df58-353b-441a-b4ed-41ed89fa53e1"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:Which employee has the highest coverage of territories?"}, {"role": "assistant", "content": "SELECT e.EmployeeID, COUNT(t.TerritoryID) AS TerritoryCount\nFROM Employees e\nJOIN EmployeeTerritories t ON e.EmployeeID = t.EmployeeID\nGROUP BY e.EmployeeID;"}], "prompt_id": "a0c8af92-bf33-48ab-9184-d5c4c02d023d"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the average customer lifetime value (CLV) for the company?"}, {"role": "assistant", "content": "SELECT AVG((UnitPrice * Quantity) * COUNT(DISTINCT Orders.OrderID)) AS CLV FROM [Order Details] JOIN Orders ON [Order Details].OrderID = Orders.OrderID"}], "prompt_id": "3e625686-1d17-4357-ac20-c50e91463dbd"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the fill rate of each supplier based on total units received and units ordered?"}, {"role": "assistant", "content": "SELECT p.SupplierID, s.CompanyName, SUM(od.UnitsReceived) / SUM(od.UnitsOrdered) AS FillRate FROM Products p JOIN [Order Details] od ON p.ProductID = od.ProductID JOIN Suppliers s ON p.SupplierID = s.SupplierID"}], "prompt_id": "119f5d4e-2a79-4654-9aef-1a369307ee08"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the revenue growth rate by month over the last year?"}, {"role": "assistant", "content": "SELECT strftime('%Y-%m', OrderDate) AS Month, ((SUM([Order Details].UnitPrice * [Order Details].Quantity) - LAG(SUM([Order Details].UnitPrice * [Order Details].Quantity)) OVER (ORDER BY OrderDate)) / LAG(SUM([Order Details].UnitPrice * [Order Details].Quantity)) OVER (ORDER BY OrderDate)) AS RevenueGrowthRate\nFROM Orders\nJOIN [Order Details] ON Orders.OrderID = [Order Details].OrderID\nGROUP BY Month"}], "prompt_id": "f2df5b1c-a42f-4a85-8a82-1f34b1bbd684"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the employee attrition rate for the last year?"}, {"role": "assistant", "content": "SELECT COUNT(CASE WHEN EmploymentEndDate >= DATE('now', '-1 year') THEN 1 ELSE NULL END) / AVG(JULIANDAY( EmploymentStartDate) - JULIANDAY(EmploymentEndDate) ) AS Attrition_Rate FROM Employees"}], "prompt_id": "267459fd-1d3b-4142-88a0-308059146c1d"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:How many territories are covered by each employee?"}, {"role": "assistant", "content": "SELECT Employees.EmployeeID, COUNT(EmployeeTerritories.TerritoryID) AS TerritoryCount FROM Employees LEFT JOIN EmployeeTerritories ON Employees.EmployeeID = EmployeeTerritories.EmployeeID GROUP BY Employees.EmployeeID;"}], "prompt_id": "e6737eca-d0f5-487c-a062-d0dde09daca4"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:How many territories are covered by each employee?"}, {"role": "assistant", "content": "SELECT EmployeeID, COUNT(TerritoryID) AS TerritoryCount FROM EmployeeTerritories GROUP BY EmployeeID;"}], "prompt_id": "c3b530bf-664d-4b94-af13-79818e916dad"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:How is the geographic distribution of customers across cities and regions?"}, {"role": "assistant", "content": "SELECT Customers.City, COUNT(Customers.CustomerID) AS CustomerCount FROM Customers GROUP BY Customers.City"}], "prompt_id": "6000d039-3768-44e0-a7c7-2e3cfe294aa9"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the customer retention rate for the past year?"}, {"role": "assistant", "content": "SELECT COUNT(DISTINCT r.CustomerID) / COUNT(DISTINCT cu.CustomerID) AS RetentionRate FROM Customers cu LEFT JOIN (SELECT CustomerID FROM Orders WHERE OrderDate < date('now', '-1 year')) r ON cu.CustomerID = r.CustomerID"}], "prompt_id": "1a191d32-ea75-4809-8255-be32984e24a3"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the average order fulfillment time?"}, {"role": "assistant", "content": "SELECT AVG(DATEDIFF(ShippedDate, OrderDate)) AS AvgFulfillmentTime FROM Orders;"}], "prompt_id": "9a3a011f-73b3-4cb8-80d6-40f0be8560ab"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the average lifetime value of our customers?"}, {"role": "assistant", "content": "SELECT AVG((SUM(od.UnitPrice * od.Quantity) / COUNT(DISTINCT o.CustomerID)) * (COUNT(DISTINCT o.OrderID) / COUNT(DISTINCT o.CustomerID)) * DATEDIFF(year, MIN(o.OrderDate), MAX(o.OrderDate))) AS CLV FROM Customers c JOIN Orders o ON c.CustomerID = o.CustomerID JOIN [Order Details] od ON o.OrderID = od.OrderID"}], "prompt_id": "18196f78-a88f-4974-9614-8802dfa6e8e8"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the average order fulfillment time for each employee?"}, {"role": "assistant", "content": "SELECT Employees.EmployeeID, AVG(julianday(Orders.ShippedDate) - julianday(Orders.OrderDate)) AS AvgFulfillmentTime FROM Employees LEFT JOIN Orders ON Employees.EmployeeID = Orders.EmployeeID GROUP BY Employees.EmployeeID;"}], "prompt_id": "f6e61b79-3b84-401d-bb6f-e89aee751013"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the customer lifetime value for each customer?"}, {"role": "assistant", "content": "SELECT Customers.CustomerID, AVG([Order Details].UnitPrice * [Order Details].Quantity) * COUNT(Orders.OrderID) * (julianday(MAX(Orders.OrderDate)) - julianday(MIN(Orders.OrderDate))) AS CLV FROM Customers INNER JOIN Orders ON Customers.CustomerID = Orders.CustomerID INNER JOIN [Order Details] ON Orders.OrderID = [Order Details].OrderID GROUP BY Customers.CustomerID;"}], "prompt_id": "418509af-0fcb-4323-afd9-b489478eada3"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the total sales of products in each category and the total sales of all categories for category sales share calculation?"}, {"role": "assistant", "content": "SELECT c.CategoryName, SUM(od.UnitPrice * od.Quantity) / (SELECT SUM(UnitPrice * Quantity) FROM [Order Details]) AS SalesShare FROM Categories c JOIN Products p ON c.CategoryID = p.CategoryID JOIN [Order Details] od ON p.ProductID = od.ProductID GROUP BY c.CategoryName;"}], "prompt_id": "afe15302-4f2a-407f-9bc1-1d1bbcdcb551"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the average order fulfillment time for each shipping company?"}, {"role": "assistant", "content": "SELECT ShipVia, AVG(julianday(ShippedDate) - julianday(OrderDate)) AS AvgFulfillmentTime FROM Orders GROUP BY ShipVia;"}], "prompt_id": "8f1e4e8c-2614-4087-a8e6-1d8b92589668"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:How profitable is each product based on unit price, cost, and quantity sold?"}, {"role": "assistant", "content": "SELECT p.ProductID, (p.UnitPrice - p.Cost) * od.Quantity AS Profitability FROM Products p JOIN [Order Details] od ON p.ProductID = od.ProductID"}], "prompt_id": "9e73adb9-3ed0-4aad-b10f-f4a68a41e976"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the average order value (AOV) for each customer?"}, {"role": "assistant", "content": "SELECT Customers.CustomerID, AVG([Order Details].UnitPrice * [Order Details].Quantity) AS AOV FROM Customers LEFT JOIN Orders ON Customers.CustomerID = Orders.CustomerID LEFT JOIN [Order Details] ON Orders.OrderID = [Order Details].OrderID GROUP BY Customers.CustomerID"}], "prompt_id": "6b2a7447-1b6b-4c48-8f3c-7622042f95d9"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the cancellation rate for each customer?"}, {"role": "assistant", "content": "SELECT CustomerID, CAST(COUNT(CASE WHEN ShippedDate IS NULL THEN 1 ELSE NULL END) AS REAL) / COUNT(Orders.OrderID) AS CancellationRate FROM Orders GROUP BY CustomerID;"}], "prompt_id": "eca8fbe4-12e2-4237-b70c-5db5c0e1e2df"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:Which employee has the highest sales performance in terms of total sales generated?"}, {"role": "assistant", "content": "SELECT e.LastName, e.FirstName, SUM(od.UnitPrice * od.Quantity) / COUNT(DISTINCT o.OrderID) AS SalesPerformance FROM Employees e INNER JOIN Orders o ON e.EmployeeID = o.EmployeeID INNER JOIN [Order Details] od ON o.OrderID = od.OrderID GROUP BY e.LastName, e.FirstName ORDER BY SalesPerformance DESC"}], "prompt_id": "7ec66a14-723a-4182-b6b8-0b547d53673f"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the average freight cost per order?"}, {"role": "assistant", "content": "SELECT SUM(Freight) / COUNT(OrderID) AS AvgFreightCost FROM Orders;"}], "prompt_id": "c6025675-18ac-4be9-a350-29e28ae051f7"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the sales share for each category?"}, {"role": "assistant", "content": "SELECT CategoryName, (SUM(UnitPrice * Quantity) / (SELECT SUM(UnitPrice * Quantity) FROM [Order Details])) AS SalesShare FROM Categories INNER JOIN Products ON Categories.CategoryID = Products.CategoryID INNER JOIN [Order Details] ON Products.ProductID = [Order Details].ProductID GROUP BY CategoryName"}], "prompt_id": "3fdd97f9-30eb-4c87-aa15-8110e6666129"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the average order value (AOV) for all orders?"}, {"role": "assistant", "content": "SELECT SUM(od.UnitPrice * od.Quantity) / COUNT(o.OrderID) AS AverageOrderValue FROM [Order Details] od INNER JOIN Orders o ON od.OrderID = o.OrderID"}], "prompt_id": "d36b6d27-3997-4c7f-a3af-99b568579964"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:How does the sales share vary across different regions?"}, {"role": "assistant", "content": "SELECT Regions.RegionDescription, Categories.CategoryName, SUM([Order Details].UnitPrice * [Order Details].Quantity) / (SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity) FROM Categories JOIN Products ON Categories.CategoryID = Products.CategoryID JOIN [Order Details] ON Products.ProductID = [Order Details].ProductID) AS SalesShare FROM Regions JOIN Territories ON Regions.RegionID = Territories.RegionID JOIN [Order Details] ON Territories.TerritoryID = [Order Details].TerritoryID JOIN Products ON [Order Details].ProductID = Products.ProductID JOIN Categories ON Products.CategoryID = Categories.CategoryID GROUP BY Regions.RegionDescription, Categories.CategoryName"}], "prompt_id": "cf45369b-fe85-4782-b6a2-e44030df382f"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the sales share of each category in the total sales?"}, {"role": "assistant", "content": "SELECT Categories.CategoryID, (SUM([Order Details].UnitPrice * [Order Details].Quantity) * 100.0 / (SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity) FROM [Order Details])) AS SalesShare FROM Categories LEFT JOIN Products ON Categories.CategoryID = Products.CategoryID LEFT JOIN [Order Details] ON Products.ProductID = [Order Details].ProductID GROUP BY Categories.CategoryID;"}], "prompt_id": "838852fd-76bd-4aaa-ab93-07dd88687f90"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the average order value (AOV) for all orders?"}, {"role": "assistant", "content": "SELECT SUM(UnitPrice * Quantity) / COUNT(OrderID) AS AOV FROM [Order Details];"}], "prompt_id": "0978aa7c-4ebc-46f7-b4f6-2f6ecb6bdace"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the sales share for each category in the total sales?"}, {"role": "assistant", "content": "SELECT Categories.CategoryID, SUM([Order Details].UnitPrice * [Order Details].Quantity) / (SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity) FROM Categories INNER JOIN Products ON Categories.CategoryID = Products.CategoryID INNER JOIN [Order Details] ON Products.ProductID = [Order Details].ProductID) AS SalesShare FROM Categories INNER JOIN Products ON Categories.CategoryID = Products.CategoryID INNER JOIN [Order Details] ON Products.ProductID = [Order Details].ProductID GROUP BY Categories.CategoryID;"}], "prompt_id": "5e6e969b-7099-4389-bf99-5b23a208250e"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the average customer lifetime value (CLV)?"}, {"role": "assistant", "content": "SELECT c.CompanyName, AVG(od.UnitPrice * od.Quantity) * COUNT(DISTINCT o.OrderID) * AVG(julianday(o.RequiredDate) - julianday(o.OrderDate)) AS CLV FROM Customers c LEFT JOIN Orders o ON c.CustomerID = o.CustomerID LEFT JOIN [Order Details] od ON o.OrderID = od.OrderID;"}], "prompt_id": "9faaa922-1ebb-4b3f-9471-56fd9165839c"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the sales share of each category compared to the total sales in the 'Beverages' category?"}, {"role": "assistant", "content": "SELECT c.CategoryName, SUM(p.UnitPrice * od.Quantity) / (SELECT SUM(p.UnitPrice * od.Quantity) FROM Products p JOIN [Order Details] od ON p.ProductID = od.ProductID JOIN Categories c ON p.CategoryID = c.CategoryID WHERE c.CategoryName = 'Beverages') AS SalesShare FROM Products p JOIN [Order Details] od ON p.ProductID = od.ProductID JOIN Categories c ON p.CategoryID = c.CategoryID"}], "prompt_id": "c0a3351b-b3a2-4687-a8d6-7d6d8dfcd329"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the attrition rate for each employee title?"}, {"role": "assistant", "content": "SELECT Title, COUNT(EmployeeID) / ((julianday(MAX(HireDate)) - julianday(MIN(HireDate))) / 365) AS AttritionRate FROM Employees GROUP BY Title;"}], "prompt_id": "8671972c-aab1-4ca6-afd8-3fd50f401354"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:How are the customers distributed geographically in terms of the number of customers in each city or region?"}, {"role": "assistant", "content": "SELECT City, Region, COUNT(CustomerID) AS CustomerCount FROM Customers GROUP BY City, Region"}], "prompt_id": "b34ee059-16a8-4853-a53e-c695924e8b85"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the customer lifetime value for each customer segment (e.g., based on customer type or region)?"}, {"role": "assistant", "content": "SELECT Customers.CustomerTypeID, AVG([Order Details].UnitPrice * [Order Details].Quantity) * (SELECT COUNT(Orders.OrderID) FROM Orders WHERE Orders.CustomerID = Customers.CustomerID) * AverageCustomerLifespan AS CLV FROM Customers LEFT JOIN [Order Details] ON Customers.CustomerID = [Order Details].CustomerID"}], "prompt_id": "dec707e0-659f-4106-b51b-700a18251bb0"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the customer retention rate for a specific period of time?"}, {"role": "assistant", "content": "SELECT COUNT(DISTINCT customer.CustomerID) / COUNT(DISTINCT temp1.CustomerID) AS CustomerRetentionRate FROM Customers customer LEFT JOIN (SELECT DISTINCT CustomerID FROM Orders WHERE OrderDate < 'specific_period_start_date') temp1 ON customer.CustomerID = temp1.CustomerID"}], "prompt_id": "b242f28f-68bc-461c-9f33-2d42ce0d65bf"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the efficiency of shipping based on the shipper's performance?"}, {"role": "assistant", "content": "SELECT s.CompanyName, COUNT(*) * 100.0 / (SELECT COUNT(*) FROM Orders) AS ShippingEfficiency\nFROM Shippers s\nJOIN Orders o ON s.ShipperID = o.ShipVia\nWHERE julianday(ShippedDate) <= julianday(RequiredDate)\nGROUP BY s.CompanyName;"}], "prompt_id": "f2403443-d943-44ca-8e25-76153093a61c"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:How many territories does each employee cover?"}, {"role": "assistant", "content": "SELECT Employees.EmployeeID, COUNT(*) AS TerritoryCount FROM Employees INNER JOIN EmployeeTerritories ON Employees.EmployeeID = EmployeeTerritories.EmployeeID GROUP BY Employees.EmployeeID;"}], "prompt_id": "9b55159a-e69a-43f3-8d82-142776eb1b99"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:How many territories are covered by each employee?"}, {"role": "assistant", "content": "SELECT EmployeeID, COUNT(TerritoryID) AS CoveredTerritories FROM EmployeeTerritories GROUP BY EmployeeID"}], "prompt_id": "dd99b55e-dd5b-4337-b28d-8f7322c47aba"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the average freight cost per order?"}, {"role": "assistant", "content": "SELECT SUM(Freight) / COUNT(OrderID) AS AvgFreightCost FROM Orders"}], "prompt_id": "85ad646d-b9da-42cb-9dcd-51960b1ed287"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the product availability rate for each product in the orders?"}, {"role": "assistant", "content": "SELECT od.ProductID, COUNT(CASE WHEN p.UnitsInStock > od.Quantity THEN 1 END) / COUNT(od.OrderID) AS AvailabilityRate FROM [Order Details] od INNER JOIN Products p ON od.ProductID = p.ProductID GROUP BY od.ProductID"}], "prompt_id": "aee96898-bfee-428a-90a4-35eb1b3caf3b"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the average reorder frequency for products in different categories?"}, {"role": "assistant", "content": "SELECT p.CategoryID, p.CategoryName, AVG(CASE WHEN julianday(o.OrderDate) - julianday(o.RequiredDate) >= p.ReorderLevel THEN 1 ELSE 0 END) AS ReorderFrequency FROM Orders o INNER JOIN [Order Details] od ON o.OrderID = od.OrderID INNER JOIN Products p ON od.ProductID = p.ProductID GROUP BY p.CategoryID, p.CategoryName"}], "prompt_id": "85d4e744-3a63-4b7e-ad18-3f139f16cfdf"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the customer lifetime value for each customer?"}, {"role": "assistant", "content": "SELECT Customers.CustomerID, AVG([Order Details].UnitPrice * [Order Details].Quantity) * COUNT(Orders.OrderID) * (julianday(MAX(Orders.OrderDate)) - julianday(MIN(Orders.OrderDate))) AS CLV FROM Customers LEFT JOIN Orders ON Customers.CustomerID = Orders.CustomerID LEFT JOIN [Order Details] ON Orders.OrderID = [Order Details].OrderID GROUP BY Customers.CustomerID;"}], "prompt_id": "59894da4-a7a7-4fd7-ba92-b0107cc3b4fc"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the average freight cost for each shipping company?"}, {"role": "assistant", "content": "SELECT Orders.ShipVia, AVG(Orders.Freight) AS AvgFreightCost FROM Orders GROUP BY Orders.ShipVia"}], "prompt_id": "55d77a7b-86f1-4e7e-92ee-69ccae138bbd"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the average order value (AOV) for all orders?"}, {"role": "assistant", "content": "SELECT SUM(UnitPrice * Quantity) / COUNT(OrderID) AS AOV FROM [Order Details]"}], "prompt_id": "b7feba71-eb62-4f01-ba8f-add6b4021814"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the revenue growth rate?"}, {"role": "assistant", "content": "WITH Revenue AS (SELECT strftime('%Y-%m', OrderDate) AS Period, SUM(UnitPrice * Quantity) AS TotalRevenue FROM [Order Details] GROUP BY strftime('%Y-%m', OrderDate)) SELECT (r1.TotalRevenue - r2.TotalRevenue) / r2.TotalRevenue AS RevenueGrowthRate FROM Revenue r1, Revenue r2 WHERE r1.Period = 'current_period' AND r2.Period = 'previous_period'"}], "prompt_id": "c2e09d61-a58e-4629-af03-473275d5982b"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:How many new customers were acquired per day in a specific period?"}, {"role": "assistant", "content": "SELECT COUNT(CustomerID) / COUNT(DISTINCT OrderDate) AS CustomerAcquisitionRate FROM Customers"}], "prompt_id": "1d2a2922-8c54-4500-a153-99c0a60df725"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:Which employee has the highest sales performance in terms of average sales per order?"}, {"role": "assistant", "content": "SELECT E.LastName, E.FirstName, SUM(OD.UnitPrice * OD.Quantity) / COUNT(O.OrderID) AS AvgSalesPerOrder FROM Employees E INNER JOIN Orders O ON E.EmployeeID = O.EmployeeID INNER JOIN [Order Details] OD ON O.OrderID = OD.OrderID GROUP BY E.EmployeeID;"}], "prompt_id": "ae4d0109-fbec-4092-b96f-c292bb4df771"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:18. What is the rate of customer complaints compared to total orders received?"}, {"role": "assistant", "content": "SELECT COUNT(CASE WHEN o.ComplaintType IS NOT NULL THEN 1 END) / COUNT(o.OrderID) AS CustomerComplaintRate FROM Orders o"}], "prompt_id": "8d0da419-36ba-4abc-b4e0-ef367716ea62"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the rate of customer complaints for each order?"}, {"role": "assistant", "content": "SELECT OrderID, (1.0 * COUNT(CASE WHEN Complaint IS NOT NULL THEN 1 END) / COUNT(*)) AS ComplaintRate FROM Orders GROUP BY OrderID;"}], "prompt_id": "b92d15df-c88d-42c2-9c5c-292cfc9ccf7c"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the inventory turnover for each product category?"}, {"role": "assistant", "content": "SELECT Categories.CategoryName, SUM([Order Details].UnitPrice * [Order Details].Quantity) / AVG(Products.UnitsInStock + Products.UnitsOnOrder) AS InventoryTurnover FROM Categories JOIN Products ON Categories.CategoryID = Products.CategoryID JOIN [Order Details] ON Products.ProductID = [Order Details].ProductID GROUP BY Categories.CategoryName;"}], "prompt_id": "6bdad5d0-6a85-4f72-b351-67e2c6b2c91b"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the inventory turnover for each product category?"}, {"role": "assistant", "content": "SELECT Categories.CategoryName, SUM([Order Details].Quantity) / (Products.UnitsInStock + Products.UnitsOnOrder) AS InventoryTurnover FROM Categories INNER JOIN Products ON Categories.CategoryID = Products.CategoryID INNER JOIN [Order Details] ON Products.ProductID = [Order Details].ProductID GROUP BY Categories.CategoryID;"}], "prompt_id": "23b5869a-bc57-495c-bd17-2cbddb92482a"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the complaint rate for all orders in the last quarter?"}, {"role": "assistant", "content": "SELECT (COUNT(CASE WHEN ComplaintReceived = 'Yes' THEN 1 ELSE NULL END) / COUNT(*)) AS ComplaintRate FROM Orders"}], "prompt_id": "3d626c7c-6b7c-4a3b-8d5c-641bd8dc88c0"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the order cancellation rate for all orders?"}, {"role": "assistant", "content": "SELECT (COUNT(CASE WHEN Canceled = 1 THEN 1 END) * 100) / COUNT(*) AS OrderCancellationRate FROM Orders"}], "prompt_id": "bc2a3bfd-24ea-4c76-9449-f9ac090e2b01"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:How frequently do products hit their reorder level within a specific time frame?"}, {"role": "assistant", "content": "SELECT ProductID, COUNT(OD.OrderID) AS ReorderFrequency FROM [Order Details] OD GROUP BY OD.ProductID;"}], "prompt_id": "6237c42a-a17c-4888-bb7b-a09500e28f0e"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the sales share of each category in the total sales?"}, {"role": "assistant", "content": "SELECT Categories.CategoryName, SUM([Order Details].UnitPrice * [Order Details].Quantity) * 100.0 / (SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity) FROM [Order Details]) AS SalesShare FROM Categories INNER JOIN Products ON Categories.CategoryID = Products.CategoryID INNER JOIN [Order Details] ON Products.ProductID = [Order Details].ProductID GROUP BY Categories.CategoryName;"}], "prompt_id": "1059cb26-3bc5-4da3-bb6a-cdedc61dbc0b"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the sales share for each product category?"}, {"role": "assistant", "content": "SELECT c.CategoryID, SUM(UnitPrice * Quantity * (1 - Discount)) / (SELECT SUM(UnitPrice * Quantity * (1 - Discount)) FROM [Order Details]) AS SalesShare FROM [Order Details] od LEFT JOIN Products p ON od.ProductID = p.ProductID LEFT JOIN Categories c ON p.CategoryID = c.CategoryID GROUP BY c.CategoryID"}], "prompt_id": "6fa151fd-02d7-4cf7-ab98-e3ef1f87a36f"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the customer acquisition rate for the current period?"}, {"role": "assistant", "content": "SELECT COUNT(DISTINCT CustomerID) / COUNT(DISTINCT OrderDate) AS CustomerAcquisitionRate FROM Orders;"}], "prompt_id": "d7ade62d-78c3-4f77-aa6e-ec663fe4e3b6"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the customer retention rate for the last quarter?"}, {"role": "assistant", "content": "SELECT (COUNT(DISTINCT c2.CustomerID) / COUNT(DISTINCT c1.CustomerID)) AS RetentionRate FROM Customers c1 LEFT JOIN Orders o ON c1.CustomerID = o.CustomerID LEFT JOIN (SELECT CustomerID, COUNT(OrderID) AS numOrders FROM Orders GROUP BY CustomerID HAVING COUNT(OrderID) > 1) t ON c1.CustomerID = t.CustomerID LEFT JOIN Customers c2 ON t.CustomerID = c2.CustomerID WHERE o.OrderDate >= '2021-01-01' AND o.OrderDate <= '2021-03-31';"}], "prompt_id": "b29b4d70-d76b-4491-afd2-5e13a62664dc"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the sales share of each category in the total sales?"}, {"role": "assistant", "content": "SELECT CategoryID, SUM([Order Details].UnitPrice * [Order Details].Quantity) / (SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity) FROM [Order Details]) as CategoryShare FROM [Order Details] LEFT JOIN Products ON [Order Details].ProductID = Products.ProductID GROUP BY CategoryID"}], "prompt_id": "504a7ef7-c45e-4fcd-af0e-3d2d865195d5"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the shipping efficiency in each region?"}, {"role": "assistant", "content": "SELECT Customers.Region, (COUNT(CASE WHEN Orders.ShippedDate <= Orders.RequiredDate THEN 1 END) / COUNT(Orders.OrderID)) AS ShippingEfficiency FROM Customers INNER JOIN Orders ON Customers.CustomerID = Orders.CustomerID GROUP BY Customers.Region;"}], "prompt_id": "bf136911-4590-42ec-8296-df3e0f9ae82a"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:How many new customers were acquired per day in a specific period?"}, {"role": "assistant", "content": "SELECT COUNT(CustomerID)/COUNT(DISTINCT OrderDate) AS CustomerAcquisitionRate FROM Customers"}], "prompt_id": "bbc91944-a93d-40f2-8651-d7d440af7f15"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the efficiency of shipping in terms of orders shipped on or before the required date?"}, {"role": "assistant", "content": "SELECT COUNT(CASE WHEN ShippedDate <= RequiredDate THEN 1 ELSE NULL END) / COUNT(OrderID) AS ShippingEfficiency FROM Orders;"}], "prompt_id": "bb3e1479-c7b4-46e1-bb54-84e8d6e307e1"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:How often are products available when ordered, and what is the availability rate for each product?"}, {"role": "assistant", "content": "SELECT Products.ProductID, Products.ProductName, COUNT(CASE WHEN (Products.UnitsInStock - [Order Details].Quantity) < 0 THEN 1 END) / COUNT(DISTINCT Orders.OrderID) AS AvailabilityRate FROM Products INNER JOIN [Order Details] ON Products.ProductID = [Order Details].ProductID GROUP BY Products.ProductID, Products.ProductName;"}], "prompt_id": "683e5264-7325-4d2d-8421-290ee8481603"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the order cancellation rate?"}, {"role": "assistant", "content": "SELECT (COUNT(CASE WHEN Cancelled = 'Yes' THEN 1 END) / COUNT(OrderID)) AS CancellationRate FROM Orders"}], "prompt_id": "ecb46e0c-c588-4494-9949-f14b7cc19ff5"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the inventory turnover for each product?"}, {"role": "assistant", "content": "SELECT p.ProductName, (SUM(od.UnitPrice) / AVG(p.UnitsInStock + p.UnitsOnOrder)) AS InventoryTurnover FROM Products p INNER JOIN [Order Details] od ON p.ProductID = od.ProductID GROUP BY p.ProductName;"}], "prompt_id": "eeac77c1-b994-4f3b-89b5-378b6f3a2a0b"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:Which employee has the best sales performance based on the total sales generated?"}, {"role": "assistant", "content": "SELECT Employees.EmployeeID, SUM([Order Details].UnitPrice * [Order Details].Quantity) / COUNT(Orders.OrderID) AS SalesPerformance FROM Employees INNER JOIN Orders ON Employees.EmployeeID = Orders.EmployeeID INNER JOIN [Order Details] ON Orders.OrderID = [Order Details].OrderID GROUP BY Employees.EmployeeID;"}], "prompt_id": "603349ae-4fcf-4853-96ae-5472939056ce"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the order cancellation rate?"}, {"role": "assistant", "content": "SELECT (COUNT(OrderID) FILTER (WHERE Canceled = True) / COUNT(DISTINCT OrderID)) AS CancellationRate FROM Orders"}], "prompt_id": "75698602-76e8-4b66-ac37-dd3074e547ee"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the attrition rate of employees in the company?"}, {"role": "assistant", "content": "SELECT COUNT(CASE WHEN (julianday(HireDate) - julianday(BirthDate)) < 365 THEN 1 END) / AVG(julianday(EffectiveEndDate) - julianday(EffectiveStartDate)) AS AttritionRate FROM Employees WHERE EffectiveEndDate BETWEEN 'start_date' AND 'end_date';"}], "prompt_id": "b7fae0dc-fa9c-4997-ac12-0d369baa1349"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:How frequently do products hit their reorder level?"}, {"role": "assistant", "content": "SELECT Products.ProductName, COUNT([Order Details].OrderID) AS ReorderFrequency FROM Products INNER JOIN [Order Details] ON Products.ProductID = [Order Details].ProductID WHERE Products.UnitsInStock <= Products.ReorderLevel GROUP BY Products.ProductName;"}], "prompt_id": "f27fb8fe-178e-4c3a-8977-c0cee44c86ae"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the inventory turnover for each product?"}, {"role": "assistant", "content": "SELECT p.ProductID, (SUM(CASE WHEN od.UnitPrice > 0 THEN od.UnitPrice * od.Quantity ELSE 0 END) / COUNT(od.OrderID)) AS InventoryTurnover FROM Products p INNER JOIN [Order Details] od ON p.ProductID = od.ProductID GROUP BY p.ProductID"}], "prompt_id": "52ca98bc-cd33-4431-b184-789e2baf00d2"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the customer complaint rate for the past quarter?"}, {"role": "assistant", "content": "SELECT (COUNT(CASE WHEN EXISTS (SELECT 1 FROM Orders WHERE Orders.Complaints IS NOT NULL) THEN Orders.OrderID END) * 1.0) / COUNT(Orders.OrderID) AS ComplaintRate FROM Orders;"}], "prompt_id": "a68a9460-36d5-412d-b16c-f2b4e4948862"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:How frequently do products hit their reorder level within a specified time frame?"}, {"role": "assistant", "content": "SELECT ProductID, COUNT(*) AS ReorderFrequency FROM Products INNER JOIN [Order Details] ON Products.ProductID = [Order Details].ProductID GROUP BY ProductID"}], "prompt_id": "d840330c-e4b0-4f39-872c-6dc8e316092d"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:How many new customers were acquired in a specific period?"}, {"role": "assistant", "content": "SELECT COUNT(CustomerID) / COUNT(DISTINCT OrderDate) AS CustomerAcquisitionRate FROM Customers"}], "prompt_id": "1e5cfe73-1178-493b-8667-c5127b49103b"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the inventory turnover rate for each category?"}, {"role": "assistant", "content": "SELECT Categories.CategoryID, SUM([Order Details].UnitPrice * [Order Details].Quantity) / AVG(Products.UnitsInStock) AS InventoryTurnover FROM Categories LEFT JOIN Products ON Categories.CategoryID = Products.CategoryID LEFT JOIN [Order Details] ON Products.ProductID = [Order Details].ProductID GROUP BY Categories.CategoryID"}], "prompt_id": "7b9a735b-838d-4cd3-a1e7-0edbb8cf00e1"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the inventory turnover for each product?"}, {"role": "assistant", "content": "SELECT p.ProductID, SUM(od.UnitPrice * od.Quantity) / AVG(p.UnitsInStock) AS InventoryTurnover FROM Products p INNER JOIN [Order Details] od ON p.ProductID = od.ProductID GROUP BY p.ProductID;"}], "prompt_id": "62cc5caf-daaa-41e3-b393-aecc16d2744b"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the average order value for each employee?"}, {"role": "assistant", "content": "SELECT e.EmployeeID, AVG(od.UnitPrice * od.Quantity) AS AvgOrderValue FROM Employees e INNER JOIN Orders o ON e.EmployeeID = o.EmployeeID INNER JOIN [Order Details] od ON o.OrderID = od.OrderID GROUP BY e.EmployeeID;"}], "prompt_id": "bbca7f51-dc76-4485-8092-df786d2dbfb7"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the revenue growth rate for each product category over the last two years?"}, {"role": "assistant", "content": "SELECT strftime('%Y', Orders.OrderDate) AS Year, Categories.CategoryName, (SUM([Order Details].UnitPrice * [Order Details].Quantity) - LAG(SUM([Order Details].UnitPrice * [Order Details].Quantity)) OVER (PARTITION BY Categories.CategoryName ORDER BY Orders.OrderDate)) / LAG(SUM([Order Details].UnitPrice * [Order Details].Quantity)) OVER (PARTITION BY Categories.CategoryName ORDER BY Orders.OrderDate) AS RevenueGrowthRate FROM Orders LEFT JOIN [Order Details] ON Orders.OrderID = [Order Details].OrderID LEFT JOIN Products ON [Order Details].ProductID = Products.ProductID LEFT JOIN Categories ON Products.CategoryID = Categories.CategoryID ORDER BY Categories.CategoryName, Year"}], "prompt_id": "94b57acb-aa97-4042-8f7e-476f2590d417"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the fill rate for each supplier in terms of the ordered and received units?"}, {"role": "assistant", "content": "SELECT Suppliers.CompanyName, SUM([Order Details].Quantity) / SUM(Products.UnitsOnOrder) AS FillRate FROM Suppliers LEFT JOIN Products ON Suppliers.SupplierID = Products.SupplierID LEFT JOIN [Order Details] ON Products.ProductID = [Order Details].ProductID GROUP BY Suppliers.CompanyName"}], "prompt_id": "448abf10-954e-43e6-b5c6-9a02e1733930"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the average time taken to fulfill an order?"}, {"role": "assistant", "content": "SELECT AVG(DATEDIFF(ShippedDate, OrderDate)) AS AvgFulfillmentTime\nFROM Orders;"}], "prompt_id": "73accd30-0c63-483e-973d-3ad66bd78015"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:Which products are the most profitable based on the total profit generated?"}, {"role": "assistant", "content": "SELECT p.ProductName, (SUM((od.UnitPrice - p.Cost) * od.Quantity)) AS TotalProfit FROM Products p JOIN [Order Details] od ON p.ProductID = od.ProductID GROUP BY p.ProductName ORDER BY TotalProfit DESC"}], "prompt_id": "fa1042ea-6675-4f7f-ab7c-847c2cb8f4cb"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:How many repeat purchases were made for each product?"}, {"role": "assistant", "content": "SELECT p.ProductID, COUNT(DISTINCT o.OrderID) AS RepeatPurchases FROM Products p INNER JOIN [Order Details] ON p.ProductID = [Order Details].ProductID INNER JOIN Orders o ON [Order Details].OrderID = o.OrderID"}], "prompt_id": "0992e3f3-0b86-4717-aa24-5a31aa976aa5"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:Who are the top 5 performing employees in terms of sales?"}, {"role": "assistant", "content": "SELECT e.FirstName || ' ' || e.LastName AS employee_name, SUM(od.UnitPrice * od.Quantity) / COUNT(o.OrderID) AS sales_performance FROM Employees e LEFT JOIN Orders o ON e.EmployeeID = o.EmployeeID LEFT JOIN [Order Details] od ON o.OrderID = od.OrderID GROUP BY e.EmployeeID ORDER BY sales_performance DESC LIMIT 5;"}], "prompt_id": "8d065c6c-8a96-4121-9605-5851f17ecc58"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the average order fulfillment time for each shipping method?"}, {"role": "assistant", "content": "SELECT ShipVia, AVG(julianday(Orders.ShippedDate) - julianday(Orders.OrderDate)) AS AverageOrderFulfillmentTime FROM Orders GROUP BY ShipVia;"}], "prompt_id": "dd2a294f-1c92-43f9-98a4-0889fda54c4c"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the attrition rate of employees in a specific period?"}, {"role": "assistant", "content": "SELECT (COUNT(CASE WHEN e.ReportsTo IS NULL THEN e.EmployeeID END) / (SELECT COUNT(DISTINCT e.EmployeeID) FROM Employees e GROUP BY strftime('%Y', e.HireDate))) AS AttritionRate FROM Employees e"}], "prompt_id": "02ed1284-1c5f-4a4f-b4ec-4e09c6ec679d"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the average order fulfillment time for all orders?"}, {"role": "assistant", "content": "SELECT AVG(DATEDIFF(ShippedDate, OrderDate)) AS AvgFulfillmentTime FROM Orders WHERE ShippedDate IS NOT NULL;"}], "prompt_id": "55718bb9-d4cc-4449-81ea-472ff2d0aee4"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:How many territories are covered by each employee and what is the average coverage across all employees?"}, {"role": "assistant", "content": "SELECT Employees.EmployeeID, COUNT(EmployeeTerritories.TerritoryID) AS TerritoryCount, AVG(COUNT(EmployeeTerritories.TerritoryID)) AS AverageCoverage FROM Employees LEFT JOIN EmployeeTerritories ON Employees.EmployeeID = EmployeeTerritories.EmployeeID GROUP BY Employees.EmployeeID;"}], "prompt_id": "99d985c7-d9db-4cd3-86cb-3a9fcce84f5f"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:3. What is the customer retention rate for the past 6 months?"}, {"role": "assistant", "content": "SELECT COUNT(DISTINCT Orders.CustomerID) * 100.0 / (SELECT COUNT(DISTINCT Customers.CustomerID) FROM Customers WHERE strftime('%Y-%m', Orders.OrderDate) = strftime('%Y-%m', date('now', '-6 month'))) AS RetentionRate FROM Orders"}], "prompt_id": "7dfbbb17-fc3e-4412-b2f3-8d5eec54c2b4"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:How many new customers were acquired per day in a specific period?"}, {"role": "assistant", "content": "SELECT COUNT(CustomerID) / COUNT(DISTINCT OrderDate) AS CustomerAcquisitionRate FROM Customers"}], "prompt_id": "cb94ce36-5919-4ffc-bfd2-7dad1b00aa96"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:Which employee has the highest sales performance based on the total sales generated and the number of orders handled?"}, {"role": "assistant", "content": "SELECT e.EmployeeID, e.LastName, e.FirstName, SUM(od.UnitPrice * od.Quantity) AS TotalSales, COUNT(o.OrderID) AS TotalOrders, SUM(od.UnitPrice * od.Quantity) / COUNT(o.OrderID) AS SalesPerformance FROM Employees e JOIN Orders o ON e.EmployeeID = o.EmployeeID JOIN [Order Details] od ON o.OrderID = od.OrderID GROUP BY e.EmployeeID, e.LastName, e.FirstName"}], "prompt_id": "87b15c00-bd78-4b30-a1ef-ed62ab75a507"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the average order value for all orders?"}, {"role": "assistant", "content": "SELECT SUM(UnitPrice * Quantity) / COUNT(DISTINCT OrderID) AS AverageOrderValue FROM [Order Details];"}], "prompt_id": "1fea4c2d-dc64-4fb4-a097-520305fb4319"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the sales share of each category compared to the total sales of all categories?"}, {"role": "assistant", "content": "SELECT c.CategoryName, SUM(od.UnitPrice * od.Quantity) / (SELECT SUM(UnitPrice * Quantity) FROM [Order Details]) AS SalesShare FROM Categories c INNER JOIN Products p ON c.CategoryID = p.CategoryID INNER JOIN [Order Details] od ON p.ProductID = od.ProductID GROUP BY c.CategoryID"}], "prompt_id": "b09f2b4b-f0d2-4625-8217-427267608cbb"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the attrition rate of employees in the past year?"}, {"role": "assistant", "content": "SELECT COUNT(EmployeeID) AS AttritionCount, 1.0 * COUNT(EmployeeID) / (SELECT AVG(EmployeeCount) FROM (SELECT COUNT(EmployeeID) AS EmployeeCount FROM Employees WHERE HireDate < date('now', '-1 year') GROUP BY strftime('%Y-%m', HireDate))) AS AttritionRate FROM Employees WHERE HireDate > date('now', '-1 year') GROUP BY strftime('%Y-%m', HireDate);"}], "prompt_id": "93ca6fbe-6772-486d-b58c-a1c03375fc0e"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:13. What is the fill rate for each supplier and how does it vary across products?"}, {"role": "assistant", "content": "SELECT Suppliers.CompanyName, SUM(CASE WHEN ([Order Details].QuantityReceived / [Order Details].Quantity) IS NULL THEN 0 ELSE [Order Details].QuantityReceived / [Order Details].Quantity END) AS FillRate FROM Suppliers INNER JOIN Products ON Suppliers.SupplierID = Products.SupplierID INNER JOIN [Order Details] ON Products.ProductID = [Order Details].ProductID GROUP BY Suppliers.CompanyName;"}], "prompt_id": "e6f5add8-f134-4db7-974f-f699f6ded76f"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the fill rate for each supplier in terms of units received and units ordered?"}, {"role": "assistant", "content": "SELECT Products.SupplierID, SUM(CASE WHEN Products.UnitsInStock >= Products.ReorderLevel THEN Products.UnitsInStock ELSE 0 END) * 1.0 / SUM(Products.UnitsOnOrder) AS FillRate FROM Products GROUP BY Products.SupplierID"}], "prompt_id": "5774d978-52d0-4c6e-9fa1-6e1a481e23c8"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the cancellation rate for orders placed in each month over the past year?"}, {"role": "assistant", "content": "SELECT strftime('%Y-%m', Orders.OrderDate) AS MonthYear, COUNT(CASE WHEN Orders.Cancelled = 'Yes' THEN 1 END) / CAST(COUNT(Orders.OrderID) AS REAL) AS CancellationRate FROM Orders WHERE OrderDate > date('now', '-1 year') GROUP BY MonthYear"}], "prompt_id": "bf79d176-0645-4a7b-85a6-d819ec2bcfed"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:How many territories does each employee cover?"}, {"role": "assistant", "content": "SELECT E.EmployeeID, COUNT(TerritoryID) AS TerritoryCount FROM Employees E LEFT JOIN EmployeeTerritories ET ON E.EmployeeID = ET.EmployeeID GROUP BY E.EmployeeID"}], "prompt_id": "c03bfadf-9dcb-476d-89a1-6c67e02d13fa"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the product availability rate for each product?"}, {"role": "assistant", "content": "SELECT ProductID, SUM(CASE WHEN UnitsInStock > 0 THEN 1 ELSE 0 END) / COUNT(*) AS product_availability_rate FROM Products LEFT JOIN [Order Details] ON Products.ProductID = [Order Details].ProductID GROUP BY ProductID"}], "prompt_id": "883bec99-eb6d-4d4d-a2e5-6e463d5cb944"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:How are customers distributed geographically in terms of count for cities and regions?"}, {"role": "assistant", "content": "SELECT City, COUNT(CustomerID) AS CustomerCount FROM Customers GROUP BY City;"}], "prompt_id": "4f836903-d50f-4d01-8296-e2cd98e1e822"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the sales share for each category compared to the total sales?"}, {"role": "assistant", "content": "SELECT c.CategoryName, (SUM(od.UnitPrice * od.Quantity) / (SELECT SUM(UnitPrice * Quantity) FROM [Order Details])) AS SalesShare FROM Categories c INNER JOIN Products p ON c.CategoryID = p.CategoryID INNER JOIN [Order Details] od ON p.ProductID = od.ProductID GROUP BY c.CategoryID;"}], "prompt_id": "12dd9bbf-91ae-4d89-b030-8b5022c2811a"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the revenue growth rate from the previous period to the current period for each category of products?"}, {"role": "assistant", "content": "SELECT c.CategoryID, c.CategoryName, ((SUM(od.UnitPrice * od.Quantity) - (SELECT SUM(od.UnitPrice * od.Quantity) FROM [Order Details] od INNER JOIN Products p ON od.ProductID = p.ProductID INNER JOIN Categories c ON p.CategoryID = c.CategoryID WHERE OrderDate < date('now', '-365 days'))) / (SELECT SUM(od.UnitPrice * od.Quantity) FROM [Order Details] od INNER JOIN Products p ON od.ProductID = p.ProductID INNER JOIN Categories c ON p.CategoryID = c.CategoryID WHERE OrderDate < date('now', '-365 days'))) ) AS RevenueGrowthRate FROM [Order Details] od INNER JOIN Products p ON od.ProductID = p.ProductID INNER JOIN Categories c ON p.CategoryID = c.CategoryID WHERE OrderDate >= date('now', '-365 days') GROUP BY c.CategoryID, c.CategoryName"}], "prompt_id": "bcfde643-68b6-497a-a299-66b99de1c1c6"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the average freight cost for each shipper?"}, {"role": "assistant", "content": "SELECT Orders.ShipVia, AVG(Orders.Freight) AS AvgFreightCost FROM Orders GROUP BY Orders.ShipVia"}], "prompt_id": "c69c4c06-22b9-456f-83df-caeea7f1c0a3"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:6. What is the sales share of each category in the current quarter?"}, {"role": "assistant", "content": "SELECT c.CategoryName, SUM(od.UnitPrice * od.Quantity) * 100.0 / (SELECT SUM(UnitPrice * Quantity) FROM [Order Details]) AS CategorySalesShare FROM Categories c INNER JOIN Products p ON c.CategoryId = p.CategoryId INNER JOIN [Order Details] od ON p.ProductId = od.ProductId WHERE o.OrderDate >= DATE('now', '-1 quarter') GROUP BY c.CategoryName;"}], "prompt_id": "15a2b591-9cc2-4073-9baa-6e0b59ba2071"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the order cancellation rate for each region?"}, {"role": "assistant", "content": "SELECT Customers.Region, (COUNT(CASE WHEN Orders.ShippedDate IS NULL THEN 1 ELSE 0 END) * 1.0 / COUNT(Orders.OrderID)) AS CancellationRate FROM Customers INNER JOIN Orders ON Customers.CustomerID = Orders.CustomerID GROUP BY Customers.Region;"}], "prompt_id": "0e87e3d8-4ecb-4916-bc48-2cdd69fac632"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the shipping efficiency for each shipper?"}, {"role": "assistant", "content": "SELECT Shippers.CompanyName, (COUNT(CASE WHEN julianday(Orders.ShippedDate) <= julianday(Orders.RequiredDate) THEN Orders.OrderID ELSE NULL END) / COUNT(Orders.OrderID) * 100) AS ShippingEfficiency FROM Shippers INNER JOIN Orders ON Shippers.ShipperID = Orders.ShipVia GROUP BY Shippers.CompanyName"}], "prompt_id": "2f322dc6-b2fa-40db-a5e0-434415b40aee"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:11. How many territories does each employee cover on average?"}, {"role": "assistant", "content": "SELECT emp.EmployeeID, COUNT(et.TerritoryID) AS TerritoryCount FROM Employees emp LEFT JOIN EmployeeTerritories et ON emp.EmployeeID = et.EmployeeID GROUP BY emp.EmployeeID"}], "prompt_id": "7ba23989-9e5a-46e5-ab85-a2dc4c65eff7"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the employee attrition rate for the past year?"}, {"role": "assistant", "content": "SELECT COUNT(LEFT(Employees.HireDate, 7)) * 1.0 / (SELECT COUNT(EmployeeID) FROM Employees) AS AttritionRate FROM Employees WHERE LEFT(Employees.HireDate, 7) BETWEEN strftime('%Y-%m', date('now', '-1 year')) AND strftime('%Y-%m', date('now'))"}], "prompt_id": "5867ca0a-68c5-4c3c-916a-31d28d08e590"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the average freight cost for all orders?"}, {"role": "assistant", "content": "SELECT AVG(Freight) AS AvgFreightCost FROM Orders;"}], "prompt_id": "347d7ed6-692b-4d47-ba25-8481ac3bcad9"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the attrition rate of employees who left the company in the past year?"}, {"role": "assistant", "content": "SELECT strftime('%Y-%m', DATE(Orders.OrderDate, '-1 year')) AS YearMonth, COUNT( DISTINCT Employees.EmployeeID ) / ( SELECT AVG( COUNT( DISTINCT Employees.EmployeeID ) ) FROM Employees ) AS AttritionRate FROM Employees GROUP BY YearMonth"}], "prompt_id": "f9663fe1-7c17-4514-b758-fbbf9aa33982"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:12. What is the fill rate for each supplier in terms of the total units received compared to the total units ordered?"}, {"role": "assistant", "content": "SELECT S.SupplierID, SUM(OD.UnitsReceived) / SUM(OD.Quantity) AS SupplierFillRate FROM [Order Details] OD JOIN Products P ON OD.ProductID = P.ProductID JOIN Suppliers S ON P.SupplierID = S.SupplierID GROUP BY S.SupplierID"}], "prompt_id": "6240e228-7ae0-4878-8beb-13c1e0efe0a1"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the employee sales performance in terms of average sales per order handled for each employee?"}, {"role": "assistant", "content": "SELECT e.EmployeeID, e.FirstName, e.LastName, SUM(od.UnitPrice * od.Quantity) / COUNT(o.OrderID) AS AverageSalesPerOrder FROM Employees e JOIN Orders o ON e.EmployeeID = o.EmployeeID JOIN [Order Details] od ON o.OrderID = od.OrderID GROUP BY e.EmployeeID, e.FirstName, e.LastName"}], "prompt_id": "65c87911-0977-4204-872d-6a1c2cf2a170"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the revenue growth rate compared to the previous quarter?"}, {"role": "assistant", "content": "WITH Revenue AS (SELECT SUM(UnitPrice * Quantity) AS TotalRevenue FROM [Order Details] WHERE strftime('%Y-%m', OrderDate) = strftime('%Y-%m', DATE('now'))), PreviousRevenue AS (SELECT SUM(UnitPrice * Quantity) AS PreviousRevenue FROM [Order Details] WHERE strftime('%Y-%m', OrderDate) = strftime('%Y-%m', DATE('now', '-1 month'))) SELECT (TotalRevenue - PreviousRevenue) / PreviousRevenue * 100 AS RevenueGrowthRate FROM Revenue, PreviousRevenue;"}], "prompt_id": "58dec194-cec7-400e-bc79-8f5e86f96e07"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:How efficient is the shipping process?"}, {"role": "assistant", "content": "SELECT SUM(CASE WHEN julianday(RequiredDate) >= julianday(ShippedDate) THEN 1 ELSE 0 END) / COUNT(OrderID) AS ShippingEfficiency FROM Orders"}], "prompt_id": "145b5d49-faa5-4e16-9473-556217b500fc"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the attrition rate of employees over the past year?"}, {"role": "assistant", "content": "SELECT strftime('%Y', HireDate) AS Year, COUNT(EmployeeID) / (SELECT COUNT(EmployeeID) FROM Employees) AS AttritionRate FROM Employees WHERE HireDate < date('now', '-1 year') GROUP BY Year"}], "prompt_id": "524175bc-be2c-48fa-9df4-9cf8218c8629"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the average sales generated per order by each employee?"}, {"role": "assistant", "content": "SELECT e.EmployeeID, SUM(od.UnitPrice * od.Quantity) / COUNT(DISTINCT o.OrderID) AS AverageSalesPerOrder FROM Employees e LEFT JOIN Orders o ON e.EmployeeID = o.EmployeeID LEFT JOIN [Order Details] od ON o.OrderID = od.OrderID GROUP BY e.EmployeeID"}], "prompt_id": "8f0d1878-70a2-4f42-a4bd-4a6e90b08ed7"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the average freight cost for all orders?"}, {"role": "assistant", "content": "SELECT SUM(Freight) / COUNT(OrderID) AS AvgFreightCost FROM Orders;"}], "prompt_id": "e46a7f3d-ae4a-4109-9e63-28bb013efcf5"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the customer complaint rate for orders?"}, {"role": "assistant", "content": "SELECT COUNT(CASE WHEN o.Complaint = 'Yes' THEN o.OrderID ELSE NULL END) / COUNT(o.OrderID) AS ComplaintRate FROM Orders o"}], "prompt_id": "96d9c269-4fc4-44ff-9fa5-1e2922428790"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the inventory turnover rate for each category of products?"}, {"role": "assistant", "content": "SELECT Products.CategoryID, (SUM([Order Details].UnitPrice * [Order Details].Quantity) / AVG(Products.UnitsInStock)) AS InventoryTurnover FROM Products INNER JOIN [Order Details] ON Products.ProductID = [Order Details].ProductID GROUP BY Products.CategoryID"}], "prompt_id": "7baca4b5-f177-4b2f-b58a-824c34e58d2e"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the revenue growth rate compared to the previous year for each region?"}, {"role": "assistant", "content": "SELECT Regions.RegionDescription, (SUM([Order Details].UnitPrice * [Order Details].Quantity) - LAG(SUM([Order Details].UnitPrice * [Order Details].Quantity)) OVER (ORDER BY Orders.OrderDate)) / LAG(SUM([Order Details].UnitPrice * [Order Details].Quantity)) OVER (ORDER BY Orders.OrderDate) AS GrowthRate FROM Orders INNER JOIN [Order Details] ON Orders.OrderID = [Order Details].OrderID INNER JOIN Territories ON [Order Details].TerritoryID = Territories.TerritoryID INNER JOIN Regions ON Territories.RegionID = Regions.RegionID GROUP BY Regions.RegionID;"}], "prompt_id": "df370018-0d72-424e-a591-086fae141ea7"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:How many new customers were acquired per day in the last month?"}, {"role": "assistant", "content": "SELECT COUNT(CustomerID) / COUNT(DISTINCT OrderDate) AS AcquisitionRatePerDay FROM Orders WHERE OrderDate >= DATE('now', '-1 month');"}], "prompt_id": "14df79bf-283f-4912-8603-c9d9cdc50f7e"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the average freight cost per order?"}, {"role": "assistant", "content": "SELECT SUM(Freight) / COUNT(OrderID) AS AvgFreightCost FROM Orders"}], "prompt_id": "a6ece6ac-5be7-40e0-95e1-6010032f1bc7"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:How profitable is each product based on the profit margin?"}, {"role": "assistant", "content": "SELECT Products.ProductID, Products.ProductName, (Products.UnitPrice - [Order Details].UnitPrice) * [Order Details].Quantity AS Profit FROM Products INNER JOIN [Order Details] ON Products.ProductID = [Order Details].ProductID;"}], "prompt_id": "c20d09fd-b58a-42f8-8a2c-3f4735fa08f2"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the customer retention rate within the past quarter?"}, {"role": "assistant", "content": "SELECT (COUNT(DISTINCT CustomerID) - COUNT(DISTINCT Orders.CustomerID)) / COUNT(DISTINCT CustomerID) AS CustomerRetentionRate FROM Customers LEFT JOIN Orders ON Customers.CustomerID = Orders.CustomerID WHERE Orders.OrderDate BETWEEN DATE('now', '-3 months') AND DATE('now')"}], "prompt_id": "549f120e-c355-41dd-91ab-857d093e7bac"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the average freight cost for all orders in the last 6 months?"}, {"role": "assistant", "content": "SELECT AVG(Freight) AS AvgFreightCost FROM Orders WHERE OrderDate BETWEEN date('now', '-6 months') AND date('now')"}], "prompt_id": "1b441a28-d608-48de-bd17-db6cf4667d1a"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the average order value for each customer?"}, {"role": "assistant", "content": "SELECT Customers.CustomerID, AVG([Order Details].UnitPrice * [Order Details].Quantity) AS AverageOrderValue FROM Customers LEFT JOIN Orders ON Customers.CustomerID = Orders.CustomerID LEFT JOIN [Order Details] ON Orders.OrderID = [Order Details].OrderID GROUP BY Customers.CustomerID"}], "prompt_id": "53453212-578e-45a2-9e99-546ad0973941"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the revenue growth rate compared to the previous period?"}, {"role": "assistant", "content": "SELECT ( (SELECT SUM(OD.UnitPrice * OD.Quantity) FROM [Order Details] OD INNER JOIN Orders O ON OD.OrderID = O.OrderID) - (SELECT SUM(OD.UnitPrice * OD.Quantity) FROM [Order Details] OD INNER JOIN Orders O ON OD.OrderID = O.OrderID WHERE O.OrderDate = 'previous period')) / (SELECT SUM(OD.UnitPrice * OD.Quantity) FROM [Order Details] OD INNER JOIN Orders O ON OD.OrderID = O.OrderID WHERE O.OrderDate = 'previous period')) AS RevenueGrowthRate"}], "prompt_id": "e4e45aac-623a-4f42-b67f-faa2f5d821f6"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the customer complaint rate for each product category?"}, {"role": "assistant", "content": "SELECT c.CategoryName, COUNT(CASE WHEN ComplaintReceived = 1 THEN 1 END) / COUNT(DISTINCT od.OrderID) AS ComplaintRate FROM Categories c INNER JOIN Products p ON c.CategoryID = p.CategoryID INNER JOIN [Order Details] od ON p.ProductID = od.ProductID GROUP BY c.CategoryName;"}], "prompt_id": "70e6ced9-06a1-496b-9d68-286342a77f88"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the sales share of each product category compared to total sales?"}, {"role": "assistant", "content": "SELECT p.CategoryID, SUM(od.UnitPrice * od.Quantity) / (SELECT SUM(UnitPrice * Quantity) FROM [Order Details]) AS SalesShare FROM Products p LEFT JOIN [Order Details] od ON p.ProductID = od.ProductID GROUP BY p.CategoryID;"}], "prompt_id": "1dfcfe8e-59bb-4e1b-a3dc-818ee24f54e8"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the complaint rate for each shipper?"}, {"role": "assistant", "content": "SELECT s.CompanyName, \n       COUNT(CASE WHEN o.ComplaintFlag = 1 THEN 1 END) * 1.0 / COUNT(o.OrderID) AS ComplaintRate\nFROM Shippers s\nINNER JOIN Orders o ON s.ShipperID = o.ShipVia\nGROUP BY s.CompanyName"}], "prompt_id": "66d05af7-deb6-4716-ac0c-bea95c78291e"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the average order value for each customer?"}, {"role": "assistant", "content": "SELECT Customers.CustomerID, AVG([Order Details].UnitPrice * [Order Details].Quantity) AS AverageOrderValue FROM Customers INNER JOIN Orders ON Customers.CustomerID = Orders.CustomerID INNER JOIN [Order Details] ON Orders.OrderID = [Order Details].OrderID GROUP BY Customers.CustomerID;"}], "prompt_id": "f51330d0-5f3e-4aeb-92a6-9adf05b36ecb"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:How frequently do products hit their reorder level within the last 6 months?"}, {"role": "assistant", "content": "SELECT Products.ProductID, COUNT(Orders.OrderID) AS ReorderFrequency FROM Products LEFT JOIN [Order Details] ON Products.ProductID = [Order Details].ProductID LEFT JOIN Orders ON [Order Details].OrderID = Orders.OrderID WHERE Orders.OrderDate > DATE('now', '-6 months') AND Products.UnitsInStock <= Products.ReorderLevel GROUP BY Products.ProductID"}], "prompt_id": "cfa0526e-3000-446d-91f5-51b19f78cc9a"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the complaint rate from customers for each transportation company used?"}, {"role": "assistant", "content": "SELECT o.ShipVia, COUNT(CASE WHEN c.Complaint IS NOT NULL THEN 1 END) / COUNT(o.OrderID) AS ComplaintRate FROM Orders o LEFT JOIN CustomerComplaints c ON o.OrderID = c.OrderID GROUP BY o.ShipVia"}], "prompt_id": "9975b38f-4559-4f8d-8a82-6cce17b2b56f"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the fill rate for each supplier in terms of units received versus units ordered?"}, {"role": "assistant", "content": "SELECT p.SupplierID, (SUM(od.Quantity) * 1.0 / (SELECT SUM(od2.Quantity) FROM [Order Details] od2)) AS FillRate FROM Products p INNER JOIN [Order Details] od ON p.ProductID = od.ProductID GROUP BY p.SupplierID;"}], "prompt_id": "47e48fc5-92ea-48cc-aa54-d18b34dac283"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the order cancellation rate for the previous month?"}, {"role": "assistant", "content": "SELECT ShipVia, COUNT(CASE WHEN ShippedDate IS NULL THEN 1 ELSE 0 END) / COUNT(OrderID) AS cancellation_rate FROM Orders WHERE OrderDate >= DATE('now', '-30 days') GROUP BY ShipVia"}], "prompt_id": "e9b0c66f-5738-40cf-a76c-2d7390294349"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the profitability of each product?"}, {"role": "assistant", "content": "SELECT (([Order Details].UnitPrice - [Order Details].UnitCost) * [Order Details].Quantity) AS Profitability, Products.ProductID, Products.ProductName FROM [Order Details] INNER JOIN Products ON [Order Details].ProductID = Products.ProductID"}], "prompt_id": "30b0af1a-c43a-40c9-927b-390304c65457"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the complaint rate from customers in each city?"}, {"role": "assistant", "content": "SELECT c.City, COUNT(CASE WHEN o.Complaint = 'Yes' THEN 1 END) / COUNT(o.OrderID) AS ComplaintRate FROM Customers c JOIN Orders o ON c.CustomerID = o.CustomerID GROUP BY c.City"}], "prompt_id": "1e4f4f4b-8fe5-4af4-8c3b-108bc0e26ebf"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the sales performance for each employee in the last quarter?"}, {"role": "assistant", "content": "SELECT e.EmployeeID, SUM(od.UnitPrice * od.Quantity) / COUNT(DISTINCT o.OrderID) AS SalesPerformance FROM Employees e LEFT JOIN Orders o ON e.EmployeeID = o.EmployeeID LEFT JOIN [Order Details] od ON o.OrderID = od.OrderID WHERE OrderDate > (SELECT DATE('now', '-3 months')) GROUP BY e.EmployeeID"}], "prompt_id": "64767d5e-1601-4540-a26f-8bbe107f0e58"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the revenue growth rate for each month compared to the previous month?"}, {"role": "assistant", "content": "SELECT strftime('%Y-%m', Orders.OrderDate) AS Month, ((SUM([Order Details].UnitPrice * [Order Details].Quantity) - LAG(SUM([Order Details].UnitPrice * [Order Details].Quantity)) OVER (ORDER BY Orders.OrderDate)) / LAG(SUM([Order Details].UnitPrice * [Order Details].Quantity)) OVER (ORDER BY Orders.OrderDate)) AS RevenueGrowthRate FROM Orders JOIN [Order Details] ON Orders.OrderID = [Order Details].OrderID GROUP BY Month"}], "prompt_id": "bac638bf-fd67-441f-9a2e-14d16ec13511"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:Which products are the most profitable based on unit price, cost, and quantity sold?"}, {"role": "assistant", "content": "SELECT p.ProductName, (p.UnitPrice - p.Cost) * od.Quantity AS Profit FROM Products p INNER JOIN [Order Details] od ON p.ProductID = od.ProductID ORDER BY Profit DESC"}], "prompt_id": "edc57fb2-b6f4-4c68-a860-271f90778a91"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:How many territories are covered by each employee and what is the average coverage per employee?"}, {"role": "assistant", "content": "SELECT Employees.EmployeeID, COUNT(EmployeeTerritories.TerritoryID) AS TerritoryCount, COUNT(EmployeeTerritories.TerritoryID) / COUNT(DISTINCT Employees.EmployeeID) AS AvgCoverage FROM Employees LEFT JOIN EmployeeTerritories ON Employees.EmployeeID = EmployeeTerritories.EmployeeID GROUP BY Employees.EmployeeID"}], "prompt_id": "661d1367-7092-4f77-8eab-e5264b6e9c6f"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the shipping efficiency in terms of orders shipped on or before the required date?"}, {"role": "assistant", "content": "SELECT COUNT(CASE WHEN julianday(ShippedDate) - julianday(RequiredDate) <= 0 THEN 1 END) / COUNT(*) AS ShippingEfficiency FROM Orders"}], "prompt_id": "67e4efd9-b388-4253-a828-7c58216c8f17"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:5. What is the inventory turnover for each product in the database?"}, {"role": "assistant", "content": "SELECT p.ProductID, COGS / ( (SUM(p.UnitsInStock) + SUM(p.UnitsOnOrder)) / 2) AS InventoryTurnover FROM Products p INNER JOIN (SELECT ProductID, SUM(UnitPrice * Quantity) AS COGS FROM [Order Details] GROUP BY ProductID) od ON p.ProductID = od.ProductID"}], "prompt_id": "b33c1d17-e717-4afc-9fa9-077a7ab3635f"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the distribution of customer complaints by city?"}, {"role": "assistant", "content": "SELECT Customers.City, COUNT(Orders.OrderID) AS Complaints FROM Customers JOIN Orders ON Customers.CustomerID = Orders.CustomerID WHERE Orders.ComplaintsReceived = 1 GROUP BY Customers.City"}], "prompt_id": "15f528fa-3ca0-46a2-a28c-8edf3cdece2a"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the availability rate for each product?"}, {"role": "assistant", "content": "SELECT Products.ProductName, (COUNT(CASE WHEN Products.UnitsInStock > [Order Details].Quantity THEN [Order Details].OrderID ELSE NULL END) / COUNT([Order Details].OrderID) * 100) AS AvailabilityRate FROM Products INNER JOIN [Order Details] ON Products.ProductID = [Order Details].ProductID GROUP BY Products.ProductName"}], "prompt_id": "02fc61cf-ec27-490e-942f-fcceed40f28b"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the retention rate of customers who made repeat purchases from each region?"}, {"role": "assistant", "content": "SELECT o.Region, COUNT(DISTINCT o.CustomerID) / COUNT(DISTINCT o.InitialCustomerID) AS RetentionRate FROM (SELECT o.CustomerID, o.Region, MIN(o.OrderDate) AS InitialOrderDate, o.InitialCustomerID FROM Orders o GROUP BY o.CustomerID) o WHERE o.InitialOrderDate < DATE('now', '-1 year') GROUP BY o.Region"}], "prompt_id": "2480c588-6bdb-4708-ad65-94e102bc4c54"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the customer lifetime value for each customer?"}, {"role": "assistant", "content": "SELECT c.CustomerID, (SUM(od.UnitPrice * od.Quantity) / COUNT(DISTINCT o.OrderID)) * (COUNT(DISTINCT o.OrderID) / (MAX(julianday(o.OrderDate)) - MIN(julianday(o.OrderDate)))) AS CustomerLifetimeValue FROM Customers c JOIN Orders o ON c.CustomerID = o.CustomerID JOIN [Order Details] od ON o.OrderID = od.OrderID"}], "prompt_id": "6812986c-e4ba-4c98-b6f0-105c7bfce618"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the inventory turnover for each product based on the cost of goods sold (COGS) divided by the average inventory value?"}, {"role": "assistant", "content": "SELECT p.ProductName, (SUM(od.UnitPrice * od.Quantity) / AVG(p.UnitsInStock + p.UnitsOnOrder)) AS InventoryTurnover FROM Products p JOIN [Order Details] od ON p.ProductID = od.ProductID GROUP BY p.ProductName"}], "prompt_id": "eb960323-1f90-492d-ac09-66d152e6be2a"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the average cost of freight per order?"}, {"role": "assistant", "content": "SELECT AVG(Freight) AS AvgFreightCost FROM Orders"}], "prompt_id": "aec386ea-ef66-43cd-b3c4-d3b2e9f383f4"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the sales share of each product category in relation to the total sales of all categories?"}, {"role": "assistant", "content": "SELECT c.CategoryName, SUM(od.UnitPrice * od.Quantity) / (SELECT SUM(od2.UnitPrice * od2.Quantity) FROM [Order Details] od2) AS SalesShare FROM Categories c JOIN Products p ON c.CategoryID = p.CategoryID JOIN [Order Details] od ON p.ProductID = od.ProductID GROUP BY c.CategoryName"}], "prompt_id": "42a448f1-c9fe-49da-9cb2-7d170898a069"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the average order fulfillment time for all orders?"}, {"role": "assistant", "content": "SELECT AVG(julianday(ShippedDate) - julianday(OrderDate)) AS AvgFulfillmentTime FROM Orders"}], "prompt_id": "3e5ba98a-d589-4c0d-a577-8e912bf04891"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the customer complaint rate for each order?"}, {"role": "assistant", "content": "SELECT o.OrderID, COUNT(*) / (SELECT COUNT(*) FROM Orders) AS ComplaintRate FROM Orders o INNER JOIN [Complaints] c ON o.OrderID = c.OrderID GROUP BY o.OrderID"}], "prompt_id": "8c013a27-292e-484a-9e0d-572773368bed"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the employee attrition rate for a specific period of time?"}, {"role": "assistant", "content": "SELECT (COUNT(EmployeeID, 'left_company') / AVG(EmployeeCount)) AS AttritionRate FROM Employees"}], "prompt_id": "77aac33f-fc71-44e8-a6ec-bd763747e9f0"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the order cancellation rate based on the total number of orders placed?"}, {"role": "assistant", "content": "SELECT COUNT(CASE WHEN CanceledStatus = 'canceled' THEN 1 ELSE NULL END) / COUNT(OrderID) AS OrderCancellationRate FROM Orders"}], "prompt_id": "d72f4731-2416-4a82-9793-691cad8f4f5d"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:How many territories are covered by each employee?"}, {"role": "assistant", "content": "SELECT EmployeeID, COUNT(TerritoryID) AS Territory_Count FROM EmployeeTerritories GROUP BY EmployeeID"}], "prompt_id": "66c6c4ac-8d4d-498b-b9e6-393964650547"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the customer complaint rate with respect to the total number of orders?"}, {"role": "assistant", "content": "SELECT COUNT(CustomerComplaints) / COUNT(*) AS ComplaintRate FROM Orders WHERE CustomerComplaints IS NOT NULL;"}], "prompt_id": "cf5c1585-042d-428d-aec5-e4959eb8ca2c"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the inventory turnover for each product category?"}, {"role": "assistant", "content": "SELECT Products.ProductName, (SUM([Order Details].UnitPrice * [Order Details].Quantity) / Products.UnitsInStock) AS InventoryTurnover FROM Products INNER JOIN [Order Details] ON Products.ProductID = [Order Details].ProductID GROUP BY Products.ProductName"}], "prompt_id": "6c91b9cc-f7e2-494b-99aa-0359c2288d7f"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:17. What is the order cancellation rate based on the number of canceled orders relative to the total number of orders placed?"}, {"role": "assistant", "content": "SELECT COUNT(CASE WHEN Status = 'Canceled' THEN 1 ELSE NULL END) / COUNT(OrderID) AS CancellationRate FROM Orders"}], "prompt_id": "a5af8d1f-2986-49f8-98fa-b9e8eeca3df9"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the availability rate for products in terms of being in stock when ordered?"}, {"role": "assistant", "content": "SELECT ProductID, (COUNT(CASE WHEN UnitsInStock >= Quantity THEN OrderID END) * 1.0 / COUNT(OrderID)) * 100 AS AvailabilityRate FROM [Order Details] GROUP BY ProductID;"}], "prompt_id": "e987e736-3f6b-442e-9ec0-e9efa91ebe5c"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:How available are products when they are ordered?"}, {"role": "assistant", "content": "SELECT Products.ProductName, CAST(COUNT(CASE WHEN Products.UnitsInStock >= [Order Details].Quantity THEN 1 END) AS FLOAT) / CAST(COUNT([Order Details].OrderID) AS FLOAT) AS AvailabilityRate FROM Products JOIN [Order Details] ON Products.ProductID = [Order Details].ProductID GROUP BY Products.ProductName"}], "prompt_id": "222c929f-39a2-4c51-b5ba-ab8782226ec7"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the reorder frequency for each product within a specific time frame?"}, {"role": "assistant", "content": "SELECT ProductID, COUNT(*) AS ReorderFrequency FROM [Order Details] WHERE Quantity <= ReorderLevel AND OrderDate BETWEEN 'start_date' AND 'end_date' GROUP BY ProductID"}], "prompt_id": "11976a74-85ff-4b32-b935-0b3a2ace24de"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:Which products are the most profitable in terms of profit margins?"}, {"role": "assistant", "content": "SELECT Products.ProductName, (Products.UnitPrice - [Order Details].UnitPrice) * [Order Details].Quantity AS Profitability FROM Products INNER JOIN [Order Details] ON Products.ProductID = [Order Details].ProductID GROUP BY Products.ProductName ORDER BY Profitability DESC;"}], "prompt_id": "f916422a-15b3-4403-9689-5d683f09be16"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the average order value for all orders?"}, {"role": "assistant", "content": "SELECT SUM(UnitPrice * Quantity) / COUNT(*) AS AverageOrderValue FROM [Order Details]"}], "prompt_id": "da0a849d-7126-442e-b427-2f9e69a7c3e2"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:How many territories are covered by each employee?"}, {"role": "assistant", "content": "SELECT Employees.EmployeeID, COUNT(EmployeeTerritories.TerritoryID) AS TerritoryCount FROM Employees LEFT JOIN EmployeeTerritories ON Employees.EmployeeID = EmployeeTerritories.EmployeeID GROUP BY Employees.EmployeeID"}], "prompt_id": "3c559a1e-f355-4aa6-9941-c5ee630fa1e4"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the attrition rate of employees for each department?"}, {"role": "assistant", "content": "SELECT e.Region, AVG(CASE WHEN julianday(e.HireDate) - julianday(o.OrderDate) < 0 THEN 1 ELSE 0 END) * 1.0 / COUNT(DISTINCT julianday(e.HireDate) - julianday(o.OrderDate)) AS AttritionRate FROM Employees e LEFT JOIN Orders o ON e.EmployeeID = o.EmployeeID GROUP BY e.Region"}], "prompt_id": "44842ef7-25af-4bc4-8cec-e1dbe8ef65a3"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:How many territories does each employee cover?"}, {"role": "assistant", "content": "SELECT Employees.LastName, Employees.FirstName, COUNT(EmployeeTerritories.TerritoryID) AS TerritoryCount FROM Employees LEFT JOIN EmployeeTerritories ON Employees.EmployeeID = EmployeeTerritories.EmployeeID GROUP BY Employees.EmployeeID;"}], "prompt_id": "14f590e5-ba06-45ad-9708-90c64ef92549"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:18. What is the customer complaint rate?"}, {"role": "assistant", "content": "SELECT COUNT(ComplaintType) * 1.0 / (SELECT COUNT(OrderID) FROM Orders) AS ComplaintRate FROM Orders WHERE ComplaintType IS NOT NULL"}], "prompt_id": "f2136783-6212-4bfa-b0db-a753d3e35a56"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the order cancellation rate for each product category?"}, {"role": "assistant", "content": "SELECT c.CategoryID, COUNT(CASE WHEN o.Cancelled = 'Yes' THEN 1 END * 1.0 / COUNT(o.OrderID)) AS CancellationRate FROM Orders o JOIN [Order Details] od ON o.OrderID = od.OrderID JOIN Products p ON od.ProductID = p.ProductID GROUP BY c.CategoryID;"}], "prompt_id": "34e3c4bd-0029-4c64-b3a2-79a1157a83b5"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the reorder frequency for each product within the last 6 months?"}, {"role": "assistant", "content": "SELECT ProductID, COUNT(*) AS ReorderFrequency FROM (SELECT ProductID FROM [Order Details] WHERE ShippedDate >= DATE('now', '-6 months') AND Quantity < ReorderLevel) GROUP BY ProductID;"}], "prompt_id": "1c9969e8-b344-42b3-a9b9-6fa56625a55a"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the customer retention rate for the past year?"}, {"role": "assistant", "content": "SELECT (COUNT(DISTINCT o.CustomerID) - COUNT(DISTINCT o2.CustomerID)) / COUNT(DISTINCT o.CustomerID) AS RetentionRate FROM Orders o JOIN Orders o2 ON o.CustomerID = o2.CustomerID WHERE o.OrderDate > DATE('now', '-1 year') AND o2.OrderDate <= DATE('now', '-1 year')"}], "prompt_id": "eaf0d442-a40b-4aa3-9be2-44f095975b03"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:Which products are the most profitable in terms of profit margin?"}, {"role": "assistant", "content": "SELECT Products.ProductName, (Products.UnitPrice - [Order Details].UnitPrice) * [Order Details].Quantity AS Profitability FROM Products INNER JOIN [Order Details] ON Products.ProductID = [Order Details].ProductID"}], "prompt_id": "f94302ac-d37e-45cf-8dea-a65e76ea0c4a"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the average freight cost for all orders?"}, {"role": "assistant", "content": "SELECT SUM(Freight) / COUNT(OrderID) AS AvgFreightCost FROM Orders;"}], "prompt_id": "7e747d52-317a-4d01-b737-d4a872c8209f"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the average freight cost for each individual order?"}, {"role": "assistant", "content": "SELECT OrderID, AVG(Freight) AS AverageFreightCost FROM Orders GROUP BY OrderID;"}], "prompt_id": "3a95464b-c156-4c10-89e1-70f710bf81c4"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the average customer lifetime value (CLV) for each location and customer type?"}, {"role": "assistant", "content": "SELECT Customers.Country, CustomerDemographics.CustomerTypeID, AVG([Order Details].UnitPrice * [Order Details].Quantity * (JULIANDAY(Orders.OrderDate) - JULIANDAY(MIN(Orders.OrderDate))) / COUNT(DISTINCT Orders.OrderID)) AS CLV\nFROM Customers\nLEFT JOIN Orders ON Customers.CustomerID = Orders.CustomerID\nLEFT JOIN [Order Details] ON Orders.OrderID = [Order Details].OrderID\nLEFT JOIN CustomerDemographics ON Customers.CustomerID = CustomerDemographics.CustomerTypeID\nGROUP BY Customers.Country, CustomerDemographics.CustomerTypeID"}], "prompt_id": "467247eb-139c-4645-af47-c93eab077c4e"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:How does the employee sales performance vary by city?"}, {"role": "assistant", "content": "SELECT Employees.City, SUM(UnitPrice * Quantity) / COUNT(Orders.OrderID) AS SalesPerOrder FROM Employees INNER JOIN Orders ON Employees.EmployeeID = Orders.EmployeeID INNER JOIN [Order Details] ON Orders.OrderID = [Order Details].OrderID GROUP BY Employees.City"}], "prompt_id": "f3c5eb11-5ed3-453d-a507-2ec4e2e53af7"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:How many territories does each employee cover on average?"}, {"role": "assistant", "content": "SELECT e.EmployeeID, e.FirstName, e.LastName, COUNT(et.TerritoryID) AS TerritoryCount FROM Employees e LEFT JOIN EmployeeTerritories et ON e.EmployeeID = et.EmployeeID GROUP BY e.EmployeeID;"}], "prompt_id": "840ea199-d3c6-476d-b50d-788d11360b04"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:9. How efficient is the shipping for each region?"}, {"role": "assistant", "content": "SELECT Orders.ShipRegion, SUM(CASE WHEN julianday(Orders.RequiredDate) >= julianday(Orders.ShippedDate) THEN 1 ELSE 0 END) / COUNT(Orders.OrderID) AS ShippingEfficiency FROM Orders GROUP BY Orders.ShipRegion"}], "prompt_id": "9cb3b001-150d-449a-9a21-c9a27397dd94"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:How frequently do products hit their reorder level within a specific time frame?"}, {"role": "assistant", "content": "SELECT ProductName, (COUNT(OrderID) * 100.0 / (SELECT COUNT(DISTINCT OrderDate) FROM Orders)) AS ReorderFrequency FROM [Order Details] GROUP BY ProductName HAVING COUNT(OrderID) > (SELECT AVG(ReorderLevel) FROM Products)"}], "prompt_id": "478101bc-6276-46cf-832e-42c24ab1c375"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the fill rate for each supplier?"}, {"role": "assistant", "content": "SELECT Suppliers.CompanyName, SUM([Order Details].Quantity) / SUM(Products.UnitsOnOrder) AS FillRate FROM Suppliers INNER JOIN Products ON Suppliers.SupplierID = Products.SupplierID INNER JOIN [Order Details] ON Products.ProductID = [Order Details].ProductID GROUP BY Suppliers.CompanyName;"}], "prompt_id": "a6aa625e-c2de-4a28-af98-ccfe9d8d9aa2"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the acquisition rate for each region?"}, {"role": "assistant", "content": "SELECT Customers.Region, COUNT(DISTINCT Customers.CustomerID) / COUNT(DISTINCT Orders.OrderDate) AS AcquisitionRate FROM Customers LEFT JOIN Orders ON Customers.CustomerID = Orders.CustomerID GROUP BY Customers.Region;"}], "prompt_id": "b341fb15-75a8-408e-b31c-7453d54a901d"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:How is the geographic distribution of customers in terms of cities and regions?"}, {"role": "assistant", "content": "SELECT City, Region, COUNT(CustomerID) AS CustomerCount FROM Customers GROUP BY City, Region"}], "prompt_id": "85583238-55e6-415a-be1e-5d64154530b3"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the inventory turnover rate for each product category?"}, {"role": "assistant", "content": "SELECT p.CategoryID, AVG(p.UnitPrice * od.Quantity) AS InventoryTurnover FROM Products p INNER JOIN [Order Details] od ON p.ProductID = od.ProductID GROUP BY p.CategoryID"}], "prompt_id": "7bec5d4a-b252-4f22-86b4-22f630536d73"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the average order value for each category of products?"}, {"role": "assistant", "content": "SELECT CategoryID, CategoryName, AVG(UnitPrice * Quantity) AS AverageOrderValue FROM Products p JOIN [Order Details] od ON p.ProductID = od.ProductID GROUP BY CategoryID, CategoryName;"}], "prompt_id": "6ead380e-73d9-415f-9c5b-1383d306ec45"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the employee attrition rate for the past year?"}, {"role": "assistant", "content": "SELECT JULIANDAY('2022-01-01') - JULIANDAY(MAX(HireDate)) / COUNT(DISTINCT JULIANDAY(HireDate)) AS AttritionRate FROM Employees"}], "prompt_id": "420d6311-a9a7-4b4b-a5a0-ac1dc8122b71"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What was the cancellation rate for orders placed in the last quarter?"}, {"role": "assistant", "content": "SELECT SUM(CASE WHEN o.ShippedDate IS NULL THEN 1 ELSE 0 END) / COUNT(o.OrderID) AS CancellationRate FROM Orders o WHERE o.OrderDate >= date('now', '-3 months');"}], "prompt_id": "f0945f0d-b6c4-4933-be55-bba2e4837637"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the total sales generated by each employee, and how does it compare to the number of orders handled?"}, {"role": "assistant", "content": "SELECT Employees.EmployeeID, Employees.LastName, Employees.FirstName, SUM([Order Details].UnitPrice * [Order Details].Quantity) AS TotalSales, COUNT(DISTINCT Orders.OrderID) AS OrderCount, SUM([Order Details].UnitPrice * [Order Details].Quantity) / COUNT(DISTINCT Orders.OrderID) AS SalesPerOrder FROM Employees INNER JOIN Orders ON Employees.EmployeeID = Orders.EmployeeID INNER JOIN [Order Details] ON Orders.OrderID = [Order Details].OrderID GROUP BY Employees.EmployeeID, Employees.LastName, Employees.FirstName"}], "prompt_id": "86402902-e7f3-49f6-bdf7-02f151b38a4b"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the customer lifetime value (CLV) for each customer?"}, {"role": "assistant", "content": "SELECT c.CustomerID, (SUM(d.UnitPrice * d.Quantity) / COUNT(DISTINCT o.OrderID)) * (COUNT(DISTINCT o.OrderID) / (JULIANDAY(MAX(o.OrderDate)) - JULIANDAY(MIN(o.OrderDate)))) AS CLV FROM Customers c JOIN Orders o ON c.CustomerID = o.CustomerID JOIN [Order Details] d ON o.OrderID = d.OrderID"}], "prompt_id": "206bfef4-8b53-4541-93c3-766ea18ce514"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the customer retention rate for the past year?"}, {"role": "assistant", "content": "SELECT COUNT(DISTINCT c.CustomerID) / COUNT(DISTINCT o.CustomerID) AS CustomerRetentionRate FROM Customers c INNER JOIN Orders o ON c.CustomerID = o.CustomerID WHERE o.OrderDate >= DATEADD('year', -1, GETDATE());"}], "prompt_id": "7bcf49c7-8ce3-4c8a-ae7b-af2952700748"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the inventory turnover rate for each product category?"}, {"role": "assistant", "content": "SELECT P.CategoryID, (SUM(OD.UnitPrice * OD.Quantity) / AVG(P.UnitsInStock + P.UnitsOnOrder)) AS InventoryTurnoverRate FROM Products P JOIN [Order Details] OD ON P.ProductID = OD.ProductID GROUP BY P.CategoryID;"}], "prompt_id": "fbe1c40a-96be-4260-aa85-274adc79e14c"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:How many products were sold by each employee? (Calculate the total units sold by each employee)"}, {"role": "assistant", "content": "SELECT e.EmployeeID, SUM(od.Quantity) AS TotalUnitsSold FROM Employees e INNER JOIN Orders o ON e.EmployeeID = o.EmployeeID INNER JOIN [Order Details] od ON o.OrderID = od.OrderID GROUP BY e.EmployeeID"}], "prompt_id": "daf9979a-dfa1-4a15-b264-3845cab02e32"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the average order value (AOV)?"}, {"role": "assistant", "content": "SELECT SUM(UnitPrice * Quantity) / COUNT(OrderID) AS AverageOrderValue FROM [Order Details]"}], "prompt_id": "8fadb104-150a-4b84-b1e0-3eef07c27ead"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:How frequently do products hit their reorder level within a specific time frame?"}, {"role": "assistant", "content": "SELECT ProductID, COUNT(CASE WHEN UnitsInStock < ReorderLevel THEN 1 END) AS ReorderFrequency FROM Products GROUP BY ProductID"}], "prompt_id": "a971f5bd-109d-482d-bd40-73eafa88cae0"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the revenue growth rate compared to the previous quarter?"}, {"role": "assistant", "content": "WITH revenue AS (SELECT STRFTIME('%Y-%m', OrderDate) AS month, SUM(UnitPrice * Quantity) AS monthly_revenue FROM [Order Details] od INNER JOIN Orders o ON od.OrderID = o.OrderID GROUP BY month) SELECT (revenue.monthly_revenue - LAG(revenue.monthly_revenue) OVER(ORDER BY revenue.month)) / LAG(revenue.monthly_revenue) OVER(ORDER BY revenue.month) AS growth_rate FROM revenue;"}], "prompt_id": "6c5720b3-b2fd-4eae-86ee-4465d7c82e92"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the inventory turnover for each product category?"}, {"role": "assistant", "content": "SELECT p.CategoryID, SUM(od.UnitPrice * od.Quantity) / (p.UnitsInStock + p.UnitsOnOrder) AS InventoryTurnover FROM Products p INNER JOIN [Order Details] od ON p.ProductID = od.ProductID GROUP BY p.CategoryID"}], "prompt_id": "8e15ca97-3a71-418c-b36c-d0d31a9d645d"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:1. What is the average order value for all orders?"}, {"role": "assistant", "content": "SELECT SUM(UnitPrice * Quantity) / COUNT(DISTINCT OrderID) AS AverageOrderValue FROM [Order Details]"}], "prompt_id": "64aa0e32-9b86-4b30-a7f3-ebc2f646bfb5"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the order cancellation rate?"}, {"role": "assistant", "content": "SELECT COUNT(CASE WHEN ShippedDate IS NULL THEN 1 ELSE 0 END) / COUNT(*) AS CancellationRate FROM Orders"}], "prompt_id": "1b3b7e40-043c-42b5-b1f8-6ed118326744"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the inventory turnover rate for the current year?"}, {"role": "assistant", "content": "SELECT (SUM(od.UnitPrice * od.Quantity) / (SELECT AVG(UnitsInStock) FROM Products)) AS InventoryTurnoverRate FROM [Order Details] od INNER JOIN Products p ON od.ProductID = p.ProductID WHERE strftime('%Y', o.OrderDate) = strftime('%Y', 'now');"}], "prompt_id": "68764dba-9d1f-46f2-aef2-ed3e6eec1b1d"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the customer lifetime value (CLV) for each customer?"}, {"role": "assistant", "content": "SELECT c.CustomerID, AVG(od.UnitPrice * od.Quantity) * (COUNT(DISTINCT o.OrderID) / 365.0) * (julianday(MAX(o.OrderDate)) - julianday(MIN(o.OrderDate))) AS CLV FROM Customers c INNER JOIN Orders o ON c.CustomerID = o.CustomerID INNER JOIN [Order Details] od ON o.OrderID = od.OrderID GROUP BY c.CustomerID"}], "prompt_id": "a57dcd00-4185-45d8-b92b-cc658d7d1cd4"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the average order value for each category of products?"}, {"role": "assistant", "content": "SELECT Categories.CategoryName, AVG([Order Details].UnitPrice * [Order Details].Quantity) AS AvgOrderValue FROM Categories INNER JOIN Products ON Categories.CategoryID = Products.CategoryID INNER JOIN [Order Details] ON Products.ProductID = [Order Details].ProductID GROUP BY Categories.CategoryName;"}], "prompt_id": "ccf4eea3-bee8-4cf5-9595-8533c8cf44f0"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:Which products are the most profitable based on our current sales data?"}, {"role": "assistant", "content": "SELECT p.ProductID, (od.UnitPrice - cost) * od.Quantity AS Profitability FROM Products p JOIN [Order Details] od ON p.ProductID = od.ProductID"}], "prompt_id": "b04366c4-8198-43d9-b61a-ea810148e04e"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the average freight cost for all orders?"}, {"role": "assistant", "content": "SELECT SUM(Freight) / COUNT(OrderID) AS AverageFreightCost FROM Orders;"}], "prompt_id": "17da8a8e-e066-4b96-848a-dd51446b10f5"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the sales share for each category of products?"}, {"role": "assistant", "content": "SELECT C.CategoryName, SUM(OD.UnitPrice * OD.Quantity) / (SELECT SUM(OD.UnitPrice * OD.Quantity) FROM [Order Details] OD JOIN Products P ON OD.ProductID = P.ProductID WHERE P.CategoryID = C.CategoryID) AS SalesShare FROM [Order Details] OD JOIN Products P ON OD.ProductID = P.ProductID JOIN Categories C ON P.CategoryID = C.CategoryID GROUP BY C.CategoryName"}], "prompt_id": "ecf7f89a-fd7b-4196-864f-7a8472ae2a90"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:Which product is the most profitable and for which supplier?"}, {"role": "assistant", "content": "SELECT Products.ProductName, Suppliers.CompanyName, (([Order Details].UnitPrice - [Cost]) * [Order Details].Quantity) AS Profit FROM Products LEFT JOIN [Order Details] ON Products.ProductID = [Order Details].ProductID LEFT JOIN Suppliers ON Products.SupplierID = Suppliers.SupplierID;"}], "prompt_id": "4fc35c20-f3fd-44ef-b491-efeca78802cb"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the average order value (AOV) for all orders?"}, {"role": "assistant", "content": "SELECT SUM(UnitPrice * Quantity) / COUNT(*) AS AOV FROM [Order Details]"}], "prompt_id": "abc9bb3b-41ea-4aea-8251-e7211e31a5fb"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the average order value for all orders?"}, {"role": "assistant", "content": "SELECT SUM(UnitPrice * Quantity) / COUNT(DISTINCT OrderID) AS AverageOrderValue FROM [Order Details]"}], "prompt_id": "d4e07e81-7185-44c7-ae2a-98f00a076380"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:How many new customers were acquired each month in the last year?"}, {"role": "assistant", "content": "SELECT strftime('%Y-%m', Orders.OrderDate) AS Month, COUNT(DISTINCT Customers.CustomerID) AS NewCustomers FROM Customers LEFT JOIN Orders ON Customers.CustomerID = Orders.CustomerID WHERE Orders.OrderDate >= date('now', '-1 year') GROUP BY Month"}], "prompt_id": "e21af5cf-85c9-4a79-9c5c-907db49921b3"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:6. What is the sales share for each product category compared to the total sales?"}, {"role": "assistant", "content": "SELECT c.CategoryName, (SUM([Order Details].UnitPrice * [Order Details].Quantity) / (SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity) FROM [Order Details])) AS SalesShare FROM Categories c INNER JOIN Products p ON c.CategoryID = p.CategoryID INNER JOIN [Order Details] ON p.ProductID = [Order Details].ProductID GROUP BY c.CategoryID"}], "prompt_id": "14b3f4f1-29bf-49ba-8405-a5547611779f"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the total profit generated by each product?"}, {"role": "assistant", "content": "SELECT p.ProductName, SUM((od.UnitPrice - p.Cost) * od.Quantity) AS TotalProfit FROM Products p INNER JOIN [Order Details] od ON p.ProductID = od.ProductID GROUP BY p.ProductName"}], "prompt_id": "da98dd7d-e4c0-494e-9969-031ad0014a76"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:18. What is the complaint rate for each shipper?"}, {"role": "assistant", "content": "SELECT Orders.ShipVia, SUM(CASE WHEN EXISTS (SELECT * FROM OrderComplaints WHERE Orders.OrderID = OrderComplaints.OrderID ) THEN 1 ELSE 0 END) / COUNT(Orders.OrderID) AS ComplaintRate FROM Orders GROUP BY Orders.ShipVia"}], "prompt_id": "a953c6aa-bffe-4280-8763-1f8779dfcc70"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:How does the supplier fill rate vary for different product categories?"}, {"role": "assistant", "content": "SELECT p.SupplierID, SUM(od.Quantity) / (SELECT SUM(Quantity) FROM [Order Details]) AS SupplierFillRate FROM Products p LEFT JOIN [Order Details] od ON p.ProductID = od.ProductID GROUP BY p.SupplierID"}], "prompt_id": "c42ddb32-bf05-4262-9072-7bc427c6d7cc"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:How often are products available when ordered for each category?"}, {"role": "assistant", "content": "SELECT Products.CategoryID, COUNT(CASE WHEN Products.UnitsInStock >= [Order Details].Quantity THEN 1 END) * 1.0 / COUNT([Order Details].ProductID) AS AvailabilityRate FROM Products INNER JOIN [Order Details] ON Products.ProductID = [Order Details].ProductID GROUP BY Products.CategoryID"}], "prompt_id": "60348801-b969-45a9-b386-fd71a26481e5"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the revenue growth rate for each product category?"}, {"role": "assistant", "content": "SELECT Categories.CategoryName, (SUM([Order Details].UnitPrice * [Order Details].Quantity) - LAG(SUM([Order Details].UnitPrice * [Order Details].Quantity), 1) OVER (PARTITION BY Categories.CategoryName ORDER BY Orders.OrderDate)) / LAG(SUM([Order Details].UnitPrice * [Order Details].Quantity), 1) OVER (PARTITION BY Categories.CategoryName ORDER BY Orders.OrderDate) AS RevenueGrowthRate FROM Categories INNER JOIN Products ON Categories.CategoryID = Products.CategoryID INNER JOIN [Order Details] ON Products.ProductID = [Order Details].ProductID INNER JOIN Orders ON [Order Details].OrderID = Orders.OrderID;"}], "prompt_id": "e0117f1f-ea57-4fd4-be3a-39610bf2af84"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the complaint rate for each customer?"}, {"role": "assistant", "content": "SELECT Customers.CustomerID, COUNT((SELECT COUNT(Orders.OrderID) FROM Orders WHERE Orders.CustomerID = Customers.CustomerID AND (SELECT COUNT(Complaints) FROM Orders WHERE Orders.CustomerID = Customers.CustomerID))) * 100.0 / (SELECT COUNT(Orders.OrderID) FROM Orders) AS ComplaintRate FROM Customers"}], "prompt_id": "1c101d14-1f0f-4865-b72e-6da6693f5dee"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the sales share of a specific category in relation to total sales?"}, {"role": "assistant", "content": "SELECT c.CategoryName, (SUM(UnitPrice * Quantity) / (SELECT SUM(UnitPrice * Quantity) FROM [Order Details])) AS SalesShare FROM Categories c JOIN Products p ON c.CategoryID = p.CategoryID JOIN [Order Details] od ON p.ProductID = od.ProductID GROUP BY c.CategoryName"}], "prompt_id": "40528813-5050-4921-b271-62cd611804db"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the customer retention rate for each city?"}, {"role": "assistant", "content": "SELECT Customers.City, (COUNT(DISTINCT Orders.CustomerID) - COUNT(DISTINCT NewOrders.CustomerID)) / COUNT(DISTINCT Orders.CustomerID) AS CustomerRetentionRate FROM Customers LEFT JOIN (SELECT CustomerID FROM Orders WHERE OrderDate BETWEEN 'start_date' AND 'end_date') AS NewOrders ON Customers.CustomerID = NewOrders.CustomerID GROUP BY Customers.City"}], "prompt_id": "3c463c5e-70cd-41b6-b6ea-d20e7de414c6"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:How are customers distributed geographically in terms of cities and regions?"}, {"role": "assistant", "content": "SELECT Customers.City, COUNT(Customers.CustomerID) AS CustomerCount FROM Customers GROUP BY Customers.City"}], "prompt_id": "2d12e4bb-3d19-44ed-9ffa-d205290d65bf"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the distribution of customer retention rate by country?"}, {"role": "assistant", "content": "SELECT Customers.Country, COUNT(DISTINCT CASE WHEN Orders.ShippedDate IS NOT NULL THEN Customers.CustomerID END) / COUNT(DISTINCT Customers.CustomerID) AS CustomerRetentionRate FROM Customers LEFT JOIN Orders ON Customers.CustomerID = Orders.CustomerID GROUP BY Customers.Country;"}], "prompt_id": "e643dab7-c564-460b-a497-b3be7c6cc671"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:Which employee has the highest sales performance?"}, {"role": "assistant", "content": "SELECT e.EmployeeID, (SUM(UnitPrice * Quantity) / COUNT(DISTINCT od.OrderID)) AS SalesPerformance FROM Employees e JOIN Orders o ON e.EmployeeID = o.EmployeeID JOIN [Order Details] od ON o.OrderID = od.OrderID GROUP BY e.EmployeeID ORDER BY SalesPerformance DESC LIMIT 1"}], "prompt_id": "34b6ee2e-3bdd-4751-91b2-c94dd3e7e55a"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the availability rate of each product when ordered?"}, {"role": "assistant", "content": "SELECT Products.ProductName, COUNT(Orders.OrderID) / (COUNT([Order Details].Quantity) * COUNT(Orders.OrderID)) AS ProductAvailabilityRate FROM Products INNER JOIN [Order Details] ON Products.ProductID = [Order Details].ProductID INNER JOIN Orders ON [Order Details].OrderID = Orders.OrderID GROUP BY Products.ProductName;"}], "prompt_id": "152c1d44-0405-4ee3-901f-29ac87c1c13e"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the reorder frequency for each product within a specific time frame?"}, {"role": "assistant", "content": "SELECT ProductID, COUNT(DISTINCT OrderID) / DATEDIFF(day, MIN(OrderDate), MAX(OrderDate)) AS ReorderFrequency FROM [Order Details] GROUP BY ProductID;"}], "prompt_id": "67767b49-2a25-433c-9871-9a3471906194"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the retention rate of customers who made repeat purchases within a specific period?"}, {"role": "assistant", "content": "SELECT COUNT(DISTINCT CustomerID) / COUNT(DISTINCT C.CustomerID) AS CustomerRetentionRate FROM Customers C JOIN Orders O ON C.CustomerID = O.CustomerID WHERE O.OrderDate <= date('now', '-30 days')"}], "prompt_id": "6f2a29a0-ea3e-441e-950c-9b841a2eb995"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the fill rate for each supplier in terms of the total units received compared to the total units ordered?"}, {"role": "assistant", "content": "SELECT p.SupplierID, s.CompanyName, SUM(od.Quantity) / (SELECT SUM(Quantity) FROM [Order Details] WHERE ProductID IN (SELECT ProductID FROM Products WHERE SupplierID = p.SupplierID)) AS FillRate FROM Products p INNER JOIN [Order Details] od ON p.ProductID = od.ProductID INNER JOIN Suppliers s ON p.SupplierID = s.SupplierID GROUP BY p.SupplierID, s.CompanyName"}], "prompt_id": "85437c4c-f522-4099-911d-b0c778f5d86d"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the average order value (AOV) for all orders?"}, {"role": "assistant", "content": "SELECT SUM(UnitPrice * Quantity) / COUNT(*) AS AOV FROM [Order Details]"}], "prompt_id": "3b9f5965-a48d-4a53-9f75-bd8d0656925c"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the customer retention rate within a specific period?"}, {"role": "assistant", "content": "SELECT (COUNT(DISTINCT CustomerID) - COUNT(DISTINCT c.CustomerID))/(COUNT(DISTINCT CustomerID)) AS CustomerRetentionRate FROM Customers c INNER JOIN Orders o ON c.CustomerID = o.CustomerID WHERE o.OrderDate >= 'start_date' AND o.OrderDate <= 'end_date'"}], "prompt_id": "fed32f02-f8f9-4450-b1e6-922928941586"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the average freight cost for each shipper?"}, {"role": "assistant", "content": "SELECT s.CompanyName, AVG(o.Freight) AS AvgFreightCost FROM Shippers s INNER JOIN Orders o ON s.ShipperID = o.ShipVia GROUP BY s.CompanyName"}], "prompt_id": "4069b1f3-d4aa-4573-aafc-c3815cc47343"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the attrition rate of employees who left the company in a specific period?"}, {"role": "assistant", "content": "SELECT (COUNT(DISTINCT E.EmployeeID) - COUNT(DISTINCT E2.EmployeeID)) / ((COUNT(DISTINCT E.EmployeeID) + COUNT(DISTINCT E2.EmployeeID)) / 2) AS AttritionRate FROM Employees E, Employees E2 WHERE E.HireDate > DATE_SUB(NOW(), INTERVAL 1 YEAR) AND E.EmployeeID = E2.ReportsTo"}], "prompt_id": "12a0e4bc-5969-4777-8080-a94b13a59837"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:Which products are the most profitable and which are the least profitable?"}, {"role": "assistant", "content": "SELECT p.ProductName, (p.UnitPrice - p.Cost) * od.Quantity AS Profit, CASE WHEN (p.UnitPrice - p.Cost) * od.Quantity = (SELECT MIN((p.UnitPrice - p.Cost) * od.Quantity) FROM Products p JOIN [Order Details] od ON p.ProductID = od.ProductID) THEN 'Least Profitable' WHEN (p.UnitPrice - p.Cost) * od.Quantity = (SELECT MAX((p.UnitPrice - p.Cost) * od.Quantity) FROM Products p JOIN [Order Details] od ON p.ProductID = od.ProductID) THEN 'Most Profitable' ELSE 'Average Profitable' END AS Profitability FROM Products p LEFT JOIN [Order Details] od ON p.ProductID = od.ProductID"}], "prompt_id": "5ce842fa-76b0-457e-a169-9de72e50b8ce"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:How many employees left the company last year and what is the attrition rate?"}, {"role": "assistant", "content": "SELECT COUNT(CASE WHEN HireDate >= DATE('now', '-1 year') THEN 1 END) / COUNT(DISTINCT EmployeeID) AS AttritionRate FROM Employees"}], "prompt_id": "8cac250e-35f0-405f-a402-a857aaf573af"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the sales share of each product category relative to the total sales of all categories?"}, {"role": "assistant", "content": "SELECT Categories.CategoryName, SUM([Order Details].UnitPrice * [Order Details].Quantity) / (SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity) FROM [Order Details]) AS SalesShare FROM Categories JOIN Products ON Categories.CategoryID = Products.CategoryID JOIN [Order Details] ON Products.ProductID = [Order Details].ProductID GROUP BY Categories.CategoryName"}], "prompt_id": "9db847f3-7861-4882-9ffc-ba6d1cc42ad9"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:How efficient is the shipping process in terms of on-time delivery?"}, {"role": "assistant", "content": "SELECT COUNT(CASE WHEN o.ShippedDate <= o.RequiredDate THEN 1 ELSE NULL END) / COUNT(*) AS ShippingEfficiency FROM Orders o;"}], "prompt_id": "cd53deb2-1790-4216-9cb6-e72cb6048749"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:How are the customers distributed geographically, in terms of the number of customers in each city or region?"}, {"role": "assistant", "content": "SELECT City, Region, COUNT(DISTINCT CustomerID) AS CustomerCount FROM Customers GROUP BY City, Region"}], "prompt_id": "3d3537f3-b5b2-4a71-922e-8ae4d86a2968"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the average order value of all orders?"}, {"role": "assistant", "content": "SELECT SUM(UnitPrice * Quantity) / COUNT(DISTINCT OrderID) AS AverageOrderValue FROM [Order Details]"}], "prompt_id": "169d0fef-5e69-4538-a8cd-99678f66b065"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the customer retention rate over a specific period of time?"}, {"role": "assistant", "content": "SELECT (COUNT(DISTINCT CustomerID) - COUNT(DISTINCT o1.CustomerID)) / COUNT(DISTINCT CustomerID) AS CustomerRetentionRate FROM Customers c1 LEFT JOIN Orders o1 ON c1.CustomerID = o1.CustomerID WHERE o1.OrderDate BETWEEN 'start_date' AND 'end_date'"}], "prompt_id": "b42ab070-4e90-4b33-9f94-f07d9e605cf0"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the average customer lifetime value?"}, {"role": "assistant", "content": "SELECT (AVG(UnitPrice * Quantity) * (COUNT(DISTINCT OrderID) / COUNT(DISTINCT CustomerID)) * 365) AS CustomerLifetimeValue FROM [Order Details] od LEFT JOIN Orders o ON od.OrderID = o.OrderID"}], "prompt_id": "fd78eb10-9295-4453-b0ed-1f56033a8fd9"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the shipping efficiency for each supplier?"}, {"role": "assistant", "content": "SELECT Suppliers.SupplierID, (COUNT(CASE WHEN Orders.ShippedDate <= Orders.RequiredDate THEN 1 END) / COUNT(Orders.OrderID)) * 100 AS ShippingEfficiency FROM Suppliers LEFT JOIN Products ON Suppliers.SupplierID = Products.SupplierID LEFT JOIN [Order Details] ON Products.ProductID = [Order Details].ProductID LEFT JOIN Orders ON [Order Details].OrderID = Orders.OrderID GROUP BY Suppliers.SupplierID;"}], "prompt_id": "86fd75fd-74d0-46b8-b030-61380014044b"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:Who are the top 5 performing employees in terms of sales?"}, {"role": "assistant", "content": "SELECT E.EmployeeID, (SUM(UnitPrice*Quantity) / COUNT(DISTINCT O.OrderID)) AS SalesPerformance FROM Employees E LEFT JOIN Orders O ON E.EmployeeID = O.EmployeeID LEFT JOIN [Order Details] OD ON O.OrderID = OD.OrderID GROUP BY E.EmployeeID ORDER BY SalesPerformance DESC LIMIT 5"}], "prompt_id": "055c5fae-9369-4c3f-b9f1-bc6f5bc95897"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the total sales generated by each employee and what are their average sales performance?"}, {"role": "assistant", "content": "SELECT Employees.EmployeeID, SUM([Order Details].UnitPrice * [Order Details].Quantity) AS TotalSales, COUNT(Orders.OrderID) AS OrderCount, SUM([Order Details].UnitPrice * [Order Details].Quantity) / COUNT(Orders.OrderID) AS AvgSalesPerformance FROM Employees INNER JOIN Orders ON Employees.EmployeeID = Orders.EmployeeID INNER JOIN [Order Details] ON Orders.OrderID = [Order Details].OrderID GROUP BY Employees.EmployeeID"}], "prompt_id": "fbae990b-1bb7-4801-a96a-0b9c47a77d46"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the reorder frequency for each product in the past six months?"}, {"role": "assistant", "content": "SELECT ProductID, COUNT(OrderID) / COUNT(DISTINCT strftime('%m', OrderDate)) AS reorder_frequency FROM [Order Details] WHERE OrderDate BETWEEN date('now', '-6 months') AND date('now') GROUP BY ProductID"}], "prompt_id": "e864154a-8b77-4f4c-a142-987c459f1ab7"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the retention rate of customers who made repeat purchases within the last quarter?"}, {"role": "assistant", "content": "SELECT COUNT(DISTINCT o.CustomerID) / (SELECT COUNT(*) FROM Customers WHERE OrderDate < DATEADD(quarter, -1, GETDATE())) AS CustomerRetentionRate FROM Orders o WHERE o.OrderDate BETWEEN DATEADD(quarter, -1, GETDATE()) AND GETDATE();"}], "prompt_id": "3938d4bf-d8db-4805-a974-dee46fbb5878"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the attrition rate of employees for the company?"}, {"role": "assistant", "content": "SELECT strftime('%Y-%m', HireDate) AS HireMonth, COUNT(EmployeeID) / (julianday(MAX(HireDate)) - julianday(MIN(HireDate))) AS AttritionRate FROM Employees GROUP BY HireMonth"}], "prompt_id": "cb2b4142-a30e-477d-9af2-3879bafb9bee"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the shipping efficiency rate for each shipping company?"}, {"role": "assistant", "content": "SELECT ShipVia, COUNT(CASE WHEN julianday(Orders.ShippedDate) <= julianday(Orders.RequiredDate) THEN 1 END) * 1.0 / COUNT(Orders.OrderID) AS ShippingEfficiency FROM Orders GROUP BY ShipVia;"}], "prompt_id": "98a385ee-9ddf-4df8-b450-e1d241bdb7a7"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the average order fulfillment time for all orders?"}, {"role": "assistant", "content": "SELECT AVG(julianday(ShippedDate) - julianday(OrderDate)) AS AvgFulfillmentTime FROM Orders WHERE ShippedDate IS NOT NULL;"}], "prompt_id": "5775ad46-4f41-46c9-9673-48c081a9b8b5"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:How many new customers were acquired each month over the last year?"}, {"role": "assistant", "content": "SELECT strftime('%Y-%m', Orders.OrderDate) AS Month, COUNT(DISTINCT Customers.CustomerID) AS NewCustomersAcquired FROM Orders INNER JOIN Customers ON Orders.CustomerID = Customers.CustomerID WHERE Orders.OrderDate >= date('now', '-1 year') GROUP BY Month;"}], "prompt_id": "11d7cf50-b321-4542-aafd-a1206c9fe47d"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:How are the customers distributed geographically?"}, {"role": "assistant", "content": "SELECT Customers.City, COUNT(Customers.CustomerID) AS Customer_Count FROM Customers GROUP BY Customers.City"}], "prompt_id": "0e0b2a8c-c985-4acf-8da8-f845f64ff523"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the order cancellation rate for each shipping company?"}, {"role": "assistant", "content": "SELECT Orders.ShipVia, SUM(CASE WHEN Orders.ShipperID IS NOT NULL THEN 1 ELSE 0 END) / COUNT(Orders.OrderID) AS CancelledOrderRate\nFROM Orders"}], "prompt_id": "f19ef872-a5f0-4d93-a59e-1f0e93d1ff1b"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the fill rate of each supplier for the products ordered?"}, {"role": "assistant", "content": "SELECT Suppliers.SupplierID, (SUM([Order Details].Quantity) * 100.0 / (SELECT SUM(Quantity) FROM [Order Details] WHERE [Order Details].ProductID IN (SELECT ProductID FROM Products WHERE Products.SupplierID = Suppliers.SupplierID))) AS FillRate FROM Suppliers LEFT JOIN Products ON Suppliers.SupplierID = Products.SupplierID LEFT JOIN [Order Details] ON Products.ProductID = [Order Details].ProductID GROUP BY Suppliers.SupplierID;"}], "prompt_id": "dee070bd-63a8-43c4-a88e-3dfc465b7b0f"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the reorder frequency for each product within the last 6 months?"}, {"role": "assistant", "content": "SELECT p.ProductID, COUNT(DISTINCT o.OrderID) / 6 AS ReorderFrequency FROM Products p JOIN [Order Details] od ON p.ProductID = od.ProductID JOIN Orders o ON od.OrderID = o.OrderID WHERE o.OrderDate >= date('now', '-6 months') GROUP BY p.ProductID"}], "prompt_id": "8d8c1bd5-7820-4f61-88c0-ac509ff40abe"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the attrition rate for employees in each department?"}, {"role": "assistant", "content": "SELECT strftime('%Y-%m', HireDate) AS Month, CAST(SUM(CASE WHEN HireDate BETWEEN start_of_period AND end_of_period THEN 1 ELSE 0 END) AS REAL) / COUNT(EmployeeID) AS AttritionRate FROM Employees GROUP BY Month"}], "prompt_id": "e2a39abd-e4f6-431f-9552-168d40bcefad"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:How many new customers were acquired per day in the last quarter?"}, {"role": "assistant", "content": "SELECT COUNT(CustomerID) / COUNT(DISTINCT OrderDate) AS AcquiredCustomersPerDay FROM Orders WHERE OrderDate >= DATE('now', '-90 days')"}], "prompt_id": "8c03be39-7212-408b-817e-13e937ae53ee"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the sales share of each product category?"}, {"role": "assistant", "content": "SELECT Categories.CategoryID, SUM([Order Details].UnitPrice * [Order Details].Quantity) / (SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity) FROM [Order Details]) AS SalesShare FROM [Order Details] INNER JOIN Products ON [Order Details].ProductID = Products.ProductID INNER JOIN Categories ON Products.CategoryID = Categories.CategoryID GROUP BY Categories.CategoryID;"}], "prompt_id": "e50ab5f3-39e0-47f4-ba11-b96aa94b6f25"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the employee attrition rate within a specific period?"}, {"role": "assistant", "content": "SELECT (COUNT(DISTINCT EmpID) / ((julianday(MAX(OrderDate)) - julianday(MIN(OrderDate))) / 365)) AS AttritionRate FROM Employees WHERE HireDate >= DATE('now', '-1 year')"}], "prompt_id": "f21be21e-4645-424e-a4d4-470f8a4f88d8"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the average order value (AOV) for all orders?"}, {"role": "assistant", "content": "SELECT SUM(UnitPrice * Quantity) / COUNT(*) AS AOV FROM [Order Details]"}], "prompt_id": "ce5d5edb-1522-4466-95f7-23f539cbdfec"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the average order value for each customer?"}, {"role": "assistant", "content": "SELECT Customers.CustomerID, AVG([Order Details].UnitPrice * [Order Details].Quantity) AS AvgOrderValue FROM [Order Details] INNER JOIN Orders ON [Order Details].OrderID = Orders.OrderID INNER JOIN Customers ON Orders.CustomerID = Customers.CustomerID GROUP BY Customers.CustomerID;"}], "prompt_id": "f93b906b-1707-453f-97c6-1a3381359f1f"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the average order fulfillment time for each employee?"}, {"role": "assistant", "content": "SELECT Employees.EmployeeID, AVG(julianday(Orders.ShippedDate) - julianday(Orders.OrderDate)) AS AvgFulfillmentTime FROM Employees JOIN Orders ON Employees.EmployeeID = Orders.EmployeeID GROUP BY Employees.EmployeeID"}], "prompt_id": "c7246225-df3e-4523-891f-b881b82fd2b0"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the order cancellation rate for each customer?"}, {"role": "assistant", "content": "SELECT Customers.CustomerID, COUNT(CASE WHEN Orders.Freight = 0 THEN 1 END) / COUNT(Orders.OrderID) AS CancellationRate FROM Customers JOIN Orders ON Customers.CustomerID = Orders.CustomerID GROUP BY Customers.CustomerID"}], "prompt_id": "cb42154b-77f9-4583-bef4-0276dc9d9939"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the cancellation rate for each customer segment?"}, {"role": "assistant", "content": "SELECT CustomerTypeID, COUNT(CASE WHEN Orders.Cancelled = 'Yes' THEN 1 ELSE NULL END) / COUNT(Orders.OrderID) AS CancellationRate FROM Orders LEFT JOIN Customers ON Orders.CustomerID = Customers.CustomerID GROUP BY CustomerTypeID"}], "prompt_id": "7bc16627-ebea-47c7-a077-8fe6df89d1c7"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the shipping efficiency rate for the 'Speedy Express' shipping company?"}, {"role": "assistant", "content": "SELECT (COUNT(CASE WHEN Orders.ShippedDate <= Orders.RequiredDate THEN 1 END) / COUNT(Orders.OrderID)) * 100 AS ShippingEfficiency FROM Orders WHERE Orders.ShipVia = (SELECT ShipperID FROM Shippers WHERE CompanyName = 'Speedy Express');"}], "prompt_id": "ec1d1b51-cc0d-42af-8487-ed2a3f9879ee"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:How often do products hit their reorder level?"}, {"role": "assistant", "content": "SELECT ProductID, COUNT(*) AS ReorderFrequency FROM (SELECT ProductID, OrderDate FROM Products JOIN [Order Details] ON Products.ProductID = [Order Details].ProductID) WHERE OrderDate > DATE('now', '-1 year') GROUP BY ProductID;"}], "prompt_id": "980560e5-3cd5-435d-80ab-6aef2f39b64d"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the inventory turnover rate for each product category?"}, {"role": "assistant", "content": "SELECT Categories.CategoryName, SUM([Order Details].UnitPrice * [Order Details].Quantity) / AVG(Products.UnitsInStock + Products.UnitsOnOrder) AS InventoryTurnover FROM Categories INNER JOIN Products ON Categories.CategoryID = Products.CategoryID INNER JOIN [Order Details] ON Products.ProductID = [Order Details].ProductID GROUP BY Categories.CategoryName;"}], "prompt_id": "b161556f-cd26-4732-9f86-cf5c4624c22a"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the sales performance of each employee?"}, {"role": "assistant", "content": "SELECT e.EmployeeID, SUM(od.UnitPrice * od.Quantity) / COUNT(o.OrderID) AS SalesPerformance FROM Employees e LEFT JOIN Orders o ON e.EmployeeID = o.EmployeeID LEFT JOIN [Order Details] od ON o.OrderID = od.OrderID GROUP BY e.EmployeeID"}], "prompt_id": "f9c01031-ae0b-4ce2-b513-ff99e24220de"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the average sales performance of each employee in terms of total sales generated?"}, {"role": "assistant", "content": "SELECT Employees.EmployeeID, SUM([Order Details].UnitPrice * [Order Details].Quantity) / Count(DISTINCT Orders.OrderID) AS SalesPerformance FROM Employees LEFT JOIN Orders ON Employees.EmployeeID = Orders.EmployeeID LEFT JOIN [Order Details] ON Orders.OrderID = [Order Details].OrderID GROUP BY Employees.EmployeeID;"}], "prompt_id": "8458e280-b77d-444c-9c15-5b413d0048a4"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the fill rate for each supplier in terms of fulfilling orders placed with them?"}, {"role": "assistant", "content": "SELECT S.CompanyName, SUM(OD.UnitsOrdered) / SUM(OD.UnitsReceived) AS FillRate FROM Suppliers S INNER JOIN Products P ON S.SupplierID = P.SupplierID INNER JOIN [Order Details] OD ON P.ProductID = OD.ProductID;"}], "prompt_id": "a88b09a5-638b-44e9-b7c3-a61330b90cf1"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What are the top 3 most profitable products based on the difference between unit price and cost multiplied by quantity sold?"}, {"role": "assistant", "content": "SELECT od.ProductID, p.ProductName, (p.UnitPrice - p.Cost) * SUM(od.Quantity) AS ProductProfit\nFROM [Order Details] od\nINNER JOIN Products p ON od.ProductID = p.ProductID\nGROUP BY od.ProductID, p.ProductName\nORDER BY ProductProfit DESC\nLIMIT 3"}], "prompt_id": "d21abbe0-5767-476d-be47-9671d1a21b76"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the average order fulfillment time for all orders?"}, {"role": "assistant", "content": "SELECT AVG(julianday(ShippedDate) - julianday(OrderDate)) AS AvgFulfillmentTime FROM Orders"}], "prompt_id": "76295746-c8bd-488f-a33f-9956d1f3dc36"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:Which products are the most profitable?"}, {"role": "assistant", "content": "SELECT Products.ProductID, (UnitPrice - Cost) * Quantity AS Profitability FROM Products INNER JOIN [Order Details] ON Products.ProductID = [Order Details].ProductID;"}], "prompt_id": "f51bcda8-9b8c-41c7-bc18-71d176934d9d"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the product availability rate for the top 5 best-selling products?"}, {"role": "assistant", "content": "SELECT p.ProductID, COUNT(CASE WHEN p.UnitsInStock > 0 THEN 1 ELSE NULL END) / COUNT(*) AS ProductAvailabilityRate FROM Products p INNER JOIN [Order Details] od ON p.ProductID = od.ProductID GROUP BY p.ProductID ORDER BY ProductAvailabilityRate DESC LIMIT 5"}], "prompt_id": "bb1669ac-fb11-495a-8734-412eb1c3a1ff"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:Can we quantify the complaint rate of customers for the last year?"}, {"role": "assistant", "content": "SELECT COUNT(CASE WHEN ComplaintsReceived = 'Yes' THEN 1 ELSE NULL END) / COUNT(*) AS ComplaintRate FROM Orders WHERE OrderDate BETWEEN 'start_date' AND 'end_date'"}], "prompt_id": "769e2b5a-7531-4862-8d8b-ffb0b5e4d86c"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the average fulfillment time for orders with high shipping efficiency?"}, {"role": "assistant", "content": "SELECT AVG(julianday(Orders.ShippedDate) - julianday(Orders.OrderDate)) AS FulfillmentTime FROM Orders WHERE (julianday(Orders.ShippedDate) - julianday(Orders.OrderDate)) IS NOT NULL"}], "prompt_id": "d178ca73-35f3-4b6d-bdb6-17af2422c6fb"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the order cancellation rate?"}, {"role": "assistant", "content": "SELECT (COUNT(CASE WHEN Cancelled = 'Yes' THEN 1 END) / COUNT(OrderID)) AS CancellationRate FROM Orders WHERE Cancelled IS NOT NULL;"}], "prompt_id": "3023698e-88a0-46a2-8cf3-bf357c4de379"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the shipping efficiency in each city and region?"}, {"role": "assistant", "content": "SELECT ShipCity, ShipRegion, SUM(CASE WHEN julianday(Orders.ShippedDate) <= julianday(Orders.RequiredDate) THEN 1 ELSE 0 END) * 1.0 / COUNT(Orders.OrderID) AS ShippingEfficiencyRate FROM Orders GROUP BY ShipCity, ShipRegion;"}], "prompt_id": "89a6b215-cfce-4448-a1f0-fb6c649deb9e"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the average order fulfillment time for each shipping company?"}, {"role": "assistant", "content": "SELECT ShipperID, AVG(julianday(ShippedDate) - julianday(OrderDate)) AS AvgFulfillmentTime FROM Orders GROUP BY ShipperID;"}], "prompt_id": "f57921c8-e859-45ef-94ee-668fd9bf423a"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the customer retention rate for the last quarter?"}, {"role": "assistant", "content": "SELECT COUNT(DISTINCT CustomerID) AS RepeatCustomers, COUNT(DISTINCT StartCustomers) AS TotalStartCustomers FROM (SELECT CustomerID, MIN(OrderDate) AS FirstOrderDate FROM Orders GROUP BY CustomerID) JOIN (SELECT CustomerID, COUNT(DISTINCT OrderID) AS StartCustomers FROM Orders WHERE OrderDate < DATE('now', '-3 months') GROUP BY CustomerID) ON CustomerID WHERE FirstOrderDate < DATE('now', '-3 months')"}], "prompt_id": "a51ccdf6-5bf2-4cd4-a75f-d49f46737324"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the average order value (AOV) for each customer?"}, {"role": "assistant", "content": "SELECT Customers.CustomerID, SUM([Order Details].UnitPrice * [Order Details].Quantity) / COUNT(Orders.OrderID) AS AOV FROM Customers LEFT JOIN Orders ON Customers.CustomerID = Orders.CustomerID LEFT JOIN [Order Details] ON Orders.OrderID = [Order Details].OrderID GROUP BY Customers.CustomerID;"}], "prompt_id": "fdc786d4-713c-41a4-98fb-0a027c82829d"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the average cost of freight for all orders?"}, {"role": "assistant", "content": "SELECT AVG(Freight) AS AverageFreightCost FROM Orders"}], "prompt_id": "f6bc2af2-f425-4d21-9ba3-647735f69c42"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the total sales generated by each employee and their sales performance?"}, {"role": "assistant", "content": "SELECT e.EmployeeID, SUM(od.UnitPrice * od.Quantity) / COUNT(o.OrderID) AS SalesPerformance FROM Employees e JOIN Orders o ON e.EmployeeID = o.EmployeeID JOIN [Order Details] od ON o.OrderID = od.OrderID GROUP BY e.EmployeeID"}], "prompt_id": "84186f78-6134-4c75-b03b-b65997633f2e"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the order cancellation rate for all orders placed?"}, {"role": "assistant", "content": "SELECT COUNT(CASE WHEN O.ShippedDate IS NULL THEN 1 END) / COUNT(O.OrderID) AS CancellationRate FROM Orders O;"}], "prompt_id": "71a69c8e-4ef1-464d-8699-3668f57a65ba"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the availability rate of each product in stock when ordered compared to the total number of orders for that product?"}, {"role": "assistant", "content": "SELECT P.ProductName, SUM(CASE WHEN UnitsInStock >= Quantity THEN 1 ELSE 0 END) / COUNT(*) AS AvailabilityRate FROM Products P JOIN [Order Details] OD ON P.ProductID = OD.ProductID GROUP BY P.ProductName"}], "prompt_id": "b889f21f-1213-4464-a92b-9b3419e49d55"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:How profitable is each product in terms of unit sales?"}, {"role": "assistant", "content": "SELECT p.ProductID, (SUM(od.UnitPrice - cost * od.Quantity)) AS Profitability FROM Products p JOIN [Order Details] od ON p.ProductID = od.ProductID;"}], "prompt_id": "1e947ba3-6e19-4c58-89db-f72f65ba20b5"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the sales share of each product category compared to the total sales of all categories?"}, {"role": "assistant", "content": "SELECT c.CategoryName, SUM(od.UnitPrice * od.Quantity) / (SELECT SUM(UnitPrice * Quantity) FROM [Order Details]) AS SalesShare FROM Categories c JOIN Products p ON c.CategoryID = p.CategoryID JOIN [Order Details] od ON p.ProductID = od.ProductID GROUP BY c.CategoryName"}], "prompt_id": "2d1de303-8072-4599-8056-55e3dd55ec1f"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the reorder frequency for each product?"}, {"role": "assistant", "content": "SELECT Products.ProductName, COUNT(*) AS ReorderFrequency FROM Products LEFT JOIN [Order Details] ON Products.ProductID = [Order Details].ProductID WHERE [Order Details].[Quantity] <= Products.ReorderLevel GROUP BY Products.ProductName;"}], "prompt_id": "f2007529-ccbd-4311-9a62-1cdcfba101a5"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the average freight cost for each shipping company?"}, {"role": "assistant", "content": "SELECT ShipVia, AVG(Orders.Freight) AS AvgFreightCost FROM Orders GROUP BY ShipVia;"}], "prompt_id": "6ebdd81a-9302-440f-b843-84956559aa5a"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the average order fulfillment time in days?"}, {"role": "assistant", "content": "SELECT AVG(julianday(ShippedDate) - julianday(OrderDate)) AS FulfillmentTime FROM Orders"}], "prompt_id": "b3004482-15e9-4859-bc71-5fb0bc8783ae"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the average freight cost per region?"}, {"role": "assistant", "content": "SELECT o.ShipRegion, AVG(Freight) AS AverageFreightCost FROM Orders o GROUP BY o.ShipRegion"}], "prompt_id": "94582098-7246-42aa-86bc-fd21debb1a2c"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:How efficient is each shipper in meeting order shipping deadlines?"}, {"role": "assistant", "content": "SELECT ShipVia, SUM(CASE WHEN julianday(ShippedDate) - julianday(RequiredDate) <= 0 THEN 1 ELSE 0 END) / COUNT(OrderID) AS ShippingEfficiency FROM Orders GROUP BY ShipVia;"}], "prompt_id": "49293547-f68b-468b-bc2e-1257d479cd43"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the attrition rate of employees who left the company within a specific period?"}, {"role": "assistant", "content": "SELECT CASE WHEN julianday(Employees.LeaveDate) - julianday(Employees.HireDate) <= periodEndDate - periodStartDate THEN 1 END / AVG(employeesCount) AS EmployeeAttritionRate FROM Employees GROUP BY periodStartDate, periodEndDate"}], "prompt_id": "a0ef0fc9-ecce-4ea5-9aac-857ef0836345"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:Which products are the most profitable based on the difference between unit price and cost?"}, {"role": "assistant", "content": "SELECT Products.ProductName, (Products.UnitPrice - [Order Details].UnitPrice) * [Order Details].Quantity AS Profit FROM Products INNER JOIN [Order Details] ON Products.ProductID = [Order Details].ProductID"}], "prompt_id": "5066d206-2500-4d51-b775-17a65ba7ba53"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the shipping efficiency for each region?"}, {"role": "assistant", "content": "SELECT Orders.ShipRegion, COUNT(CASE WHEN Orders.ShippedDate <= Orders.RequiredDate THEN 1 ELSE NULL END) / COUNT(Orders.OrderID) AS ShippingEfficiency FROM Orders GROUP BY Orders.ShipRegion;"}], "prompt_id": "c32f59bc-2b5b-4318-b3ee-ea81c4952ee3"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the order fulfillment time for each employee?"}, {"role": "assistant", "content": "SELECT Employees.EmployeeID, AVG(JULIANDAY(Orders.ShippedDate) - JULIANDAY(Orders.OrderDate)) AS AvgFulfillmentTime FROM Orders INNER JOIN Employees ON Orders.EmployeeID = Employees.EmployeeID GROUP BY Employees.EmployeeID"}], "prompt_id": "1d15a0de-c485-4bb3-8ed9-5679d35539cb"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the average freight cost for all orders?"}, {"role": "assistant", "content": "SELECT AVG(Freight) AS AvgFreightCost FROM Orders"}], "prompt_id": "f63b8d48-da21-43e8-b2b3-f38b4d9ca5b9"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the fill rate for each supplier in terms of units received versus units ordered?"}, {"role": "assistant", "content": "SELECT SupplierID, SUM([Order Details].Quantity) / SUM(Products.UnitsInStock) AS fill_rate FROM Products INNER JOIN [Order Details] ON Products.ProductID = [Order Details].ProductID GROUP BY SupplierID;"}], "prompt_id": "4bf4e0c4-1965-40e0-8652-90e91b6940cb"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the inventory turnover for each product category?"}, {"role": "assistant", "content": "SELECT c.CategoryName, (SUM([Order Details].UnitPrice * [Order Details].Quantity) / AVG(p.UnitsInStock + p.UnitsOnOrder)) AS InventoryTurnover FROM Categories c JOIN Products p ON c.CategoryID = p.CategoryID JOIN [Order Details] ON p.ProductID = [Order Details].ProductID GROUP BY c.CategoryName"}], "prompt_id": "62b24ba4-f56f-481c-86ce-59f850d8a1ea"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the average customer lifetime value for each customer segment?"}, {"role": "assistant", "content": "SELECT Customers.CustomerID, (AVG([Order Details].UnitPrice * [Order Details].Quantity) * AVG(DATEDIFF(ShippedDate,OrderDate)) * 365) AS CLV FROM Customers INNER JOIN Orders ON Customers.CustomerID = Orders.CustomerID INNER JOIN [Order Details] ON Orders.OrderID = [Order Details].OrderID GROUP BY Customers.CustomerID;"}], "prompt_id": "a98a16a8-c641-49fc-bccd-d62e98578985"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the inventory turnover for each product based on the cost of goods sold (COGS) and average inventory value?"}, {"role": "assistant", "content": "SELECT Products.ProductID, (SUM([Order Details].UnitPrice * [Order Details].Quantity) / AVG(Products.UnitsInStock + Products.UnitsOnOrder)) AS InventoryTurnover FROM [Order Details] INNER JOIN Products ON [Order Details].ProductID = Products.ProductID"}], "prompt_id": "aa797ebd-34b8-4ad9-8bf4-2854449f8700"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the average customer lifetime value (CLV) for customers in each region?"}, {"role": "assistant", "content": "SELECT c.Region, AVG(od.UnitPrice * od.Quantity) * COUNT(DISTINCT o.CustomerID) * (julianday(MAX(o.OrderDate)) - julianday(MIN(o.OrderDate))) / 365 AS CLV FROM Customers c INNER JOIN Orders o ON c.CustomerID = o.CustomerID INNER JOIN [Order Details] od ON o.OrderID = od.OrderID GROUP BY c.Region;"}], "prompt_id": "b8459474-4087-43c1-aefb-ac2026071e31"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the geographic distribution of customers across different cities and regions?"}, {"role": "assistant", "content": "SELECT City, COUNT(CustomerID) AS CustomerCount FROM Customers GROUP BY City"}], "prompt_id": "faa30eea-f50e-4097-ab34-858c668f38dc"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the average freight cost for each shipper, and how does it compare to the overall average cost?"}, {"role": "assistant", "content": "SELECT ShipperID, AVG(Freight) AS AvgFreightCost FROM Orders GROUP BY ShipperID"}], "prompt_id": "87a29661-3752-4d8d-afa8-58d98532f78a"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the sales share of each category?"}, {"role": "assistant", "content": "SELECT c.CategoryName, SUM(od.UnitPrice * od.Quantity) / SUM((SELECT SUM(UnitPrice * Quantity) FROM [Order Details])) AS SalesShare FROM Categories c LEFT JOIN Products p ON c.CategoryID = p.CategoryID LEFT JOIN [Order Details] od ON p.ProductID = od.ProductID GROUP BY c.CategoryName;"}], "prompt_id": "99f09471-20cb-4bb4-9751-bd2c564b4f80"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:How is the customer geographic distribution across cities and regions?"}, {"role": "assistant", "content": "SELECT Customers.Region, Customers.City, COUNT(DISTINCT Customers.CustomerID) AS CustomerCount FROM Customers GROUP BY Customers.Region, Customers.City;"}], "prompt_id": "84516b40-b0af-42a0-a758-0f903a7423d3"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:Which products are the most profitable?"}, {"role": "assistant", "content": "SELECT Products.ProductID, (([Order Details].UnitPrice - Products.Cost) * [Order Details].Quantity) AS TotalProfit FROM Products JOIN [Order Details] ON Products.ProductID = [Order Details].ProductID"}], "prompt_id": "42618744-66ae-4435-8e84-11efc249b323"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the fill rate of units received from each supplier compared to units ordered?"}, {"role": "assistant", "content": "SELECT CompanyName, SUM(UnitsReceived) / SUM(UnitsOrdered) AS FillRate\nFROM Suppliers\nJOIN Products ON Suppliers.SupplierID = Products.SupplierID\nJOIN [Order Details] ON Products.ProductID = [Order Details].ProductID\nGROUP BY CompanyName;"}], "prompt_id": "dc44735a-a568-4e70-aa58-5641a382b177"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:Which employee has the highest sales performance based on the average order value (AOV)?"}, {"role": "assistant", "content": "SELECT e.FirstName, e.LastName, SUM(od.UnitPrice * od.Quantity) / COUNT(o.OrderID) AS SalesPerformance FROM Employees e INNER JOIN Orders o ON e.EmployeeID = o.EmployeeID INNER JOIN [Order Details] od ON o.OrderID = od.OrderID GROUP BY e.FirstName, e.LastName ORDER BY SalesPerformance DESC LIMIT 1"}], "prompt_id": "48db6f0f-f2ed-465a-bdb0-2377b84841c2"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the average order fulfillment time for each employee?"}, {"role": "assistant", "content": "SELECT e.FirstName, e.LastName, AVG(julianday(o.ShippedDate) - julianday(o.OrderDate)) AS AvgFulfillmentTime FROM Employees e INNER JOIN Orders o ON e.EmployeeID = o.EmployeeID GROUP BY e.EmployeeID;"}], "prompt_id": "aa06a66f-c33b-42a6-8e84-1381e367146e"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the attrition rate of employees from each region?"}, {"role": "assistant", "content": "SELECT e.Region, \n       COUNT(CASE WHEN e.ReportsTo IS NULL THEN 1 END) * 1.0 / AVG((julianday(e.HireDate) - julianday(e.BirthDate)) / 365) AS AttritionRate\nFROM Employees e\nGROUP BY e.Region"}], "prompt_id": "243f802c-aca5-45a1-9189-8bcb7a60f278"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the order cancellation rate?"}, {"role": "assistant", "content": "SELECT SUM(CASE WHEN IsCancelled = 'Yes' THEN 1 ELSE 0 END) / COUNT(OrderID) AS OrderCancellationRate FROM Orders"}], "prompt_id": "4209f61c-1414-46a0-88de-37e06f9da7f1"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:Who are the top performing employees based on their sales performance?"}, {"role": "assistant", "content": "SELECT E.EmployeeID, (SUM(OD.UnitPrice * OD.Quantity) / COUNT(DISTINCT O.OrderID)) AS SalesPerformance FROM Employees E INNER JOIN Orders O ON E.EmployeeID = O.EmployeeID INNER JOIN [Order Details] OD ON O.OrderID = OD.OrderID GROUP BY E.EmployeeID;"}], "prompt_id": "980c19c7-80dc-4bf6-bb41-c5a6cdcfa859"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the customer lifetime value (CLV) for each customer?"}, {"role": "assistant", "content": "SELECT Customers.CustomerID, (SELECT (SUM([Order Details].UnitPrice * [Order Details].Quantity) / COUNT(DISTINCT OrderID)) * (COUNT(DISTINCT OrderID) / COUNT(DISTINCT Customers.CustomerID) * (STRFTIME('%Y', MAX(OrderDate)) - STRFTIME('%Y', MIN(OrderDate)))) AS CLV FROM Customers INNER JOIN Orders ON Customers.CustomerID = Orders.CustomerID INNER JOIN [Order Details] ON Orders.OrderID = [Order Details].OrderID"}], "prompt_id": "4e9f02c6-9eca-4081-92dc-672e9ec4f44d"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the total sales generated by each employee and the average sales per order they handled?"}, {"role": "assistant", "content": "SELECT E.EmployeeID, SUM(OD.UnitPrice * OD.Quantity) AS TotalSales, SUM(OD.UnitPrice * OD.Quantity) / COUNT(O.OrderID) AS AverageSalesPerOrder FROM Employees E INNER JOIN Orders O ON E.EmployeeID = O.EmployeeID INNER JOIN [Order Details] OD ON O.OrderID = OD.OrderID GROUP BY E.EmployeeID;"}], "prompt_id": "c0c44174-181d-4a26-9c37-ef83758caa02"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:Which employee has the highest sales performance by region?"}, {"role": "assistant", "content": "SELECT Employees.Region, SUM([Order Details].UnitPrice * [Order Details].Quantity) / COUNT(DISTINCT Orders.OrderID) AS SalesPerformance FROM Employees INNER JOIN Orders ON Employees.EmployeeID = Orders.EmployeeID INNER JOIN [Order Details] ON Orders.OrderID = [Order Details].OrderID GROUP BY Employees.Region, Employees.EmployeeID"}], "prompt_id": "4162e393-6604-4d58-9d42-1174de2d9277"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the inventory turnover for each category of products?"}, {"role": "assistant", "content": "SELECT Categories.CategoryName, SUM([Order Details].UnitPrice * [Order Details].Quantity) / AVG(Products.UnitsInStock) AS InventoryTurnover FROM Categories INNER JOIN Products ON Categories.CategoryID = Products.CategoryID INNER JOIN [Order Details] ON Products.ProductID = [Order Details].ProductID GROUP BY Categories.CategoryName;"}], "prompt_id": "43c30826-5f2f-49be-86bc-94dc8517c76d"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the geographic distribution of customers by city and region?"}, {"role": "assistant", "content": "SELECT City, Region, COUNT(CustomerID) AS CustomerCount FROM Customers GROUP BY City, Region"}], "prompt_id": "33b2c481-345d-4fbf-b777-b3a8980779e5"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:How many territories does each employee cover?"}, {"role": "assistant", "content": "SELECT Employees.EmployeeID, COUNT(*) AS TerritoryCount FROM Employees LEFT JOIN EmployeeTerritories ON Employees.EmployeeID = EmployeeTerritories.EmployeeID GROUP BY Employees.EmployeeID"}], "prompt_id": "d2a6be9f-30a6-4438-8b31-5ce5650e36d6"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:Which products are the most profitable based on the calculated profit?"}, {"role": "assistant", "content": "SELECT P.ProductName, ((OD.UnitPrice - P.UnitCost) * OD.Quantity) AS Profit FROM Products P JOIN [Order Details] OD ON P.ProductID = OD.ProductID;"}], "prompt_id": "c7b338a0-4e20-4f2e-b816-849e7d5df51e"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the complaint rate for each customer?"}, {"role": "assistant", "content": "SELECT Customers.CustomerID, COUNT(CASE WHEN CustomerComplaints.ComplaintType IS NOT NULL THEN 1 ELSE 0 END) / COUNT(Orders.OrderID) AS ComplaintRate FROM Customers LEFT JOIN Orders ON Customers.CustomerID = Orders.CustomerID LEFT JOIN CustomerComplaints ON Customers.CustomerID = CustomerComplaints.CustomerID GROUP BY Customers.CustomerID;"}], "prompt_id": "d42d3a6d-865d-4f2d-9c65-a57957bfcdc3"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the percentage of orders shipped on or before the required date?"}, {"role": "assistant", "content": "SELECT COUNT(CASE WHEN ShippedDate <= RequiredDate THEN 1 END) / COUNT(*) AS ShippingEfficiency FROM Orders"}], "prompt_id": "1b23313a-2761-4939-8fd7-17280ad3eee2"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the average order fulfillment time for each customer?"}, {"role": "assistant", "content": "SELECT Customers.CustomerID, AVG(JULIANDAY(Orders.ShippedDate) - JULIANDAY(Orders.OrderDate)) AS FulfillmentTime FROM Orders INNER JOIN Customers ON Orders.CustomerID = Customers.CustomerID GROUP BY Customers.CustomerID;"}], "prompt_id": "8d22cf67-3bb2-4305-a407-6f6ae8f8633c"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the customer acquisition rate for the past month?"}, {"role": "assistant", "content": "SELECT COUNT(CustomerID) / DATEDIFF(MAX(OrderDate), MIN(OrderDate)) AS CustomerAcquisitionRate FROM Orders WHERE OrderDate BETWEEN DATEADD(MONTH, -1, GETDATE()) AND GETDATE()"}], "prompt_id": "1a89f641-9281-4693-919d-dd14633e0902"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the inventory turnover for each product category?"}, {"role": "assistant", "content": "SELECT Products.CategoryID, SUM([Order Details].UnitPrice * [Order Details].Quantity) / AVG(Products.UnitsInStock + Products.UnitsOnOrder) AS InventoryTurnover FROM Products INNER JOIN [Order Details] ON Products.ProductID = [Order Details].ProductID GROUP BY Products.CategoryID"}], "prompt_id": "4b5d7fa3-fc41-429b-9243-85d455d85c46"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:How efficient is the shipping process in terms of orders shipped on or before the required date?"}, {"role": "assistant", "content": "SELECT SUM(CASE WHEN ShippedDate <= RequiredDate THEN 1 ELSE 0 END) / COUNT(*) AS ShippingEfficiency FROM Orders"}], "prompt_id": "24a9d6b9-f21c-49d6-a7e6-21e188316f7f"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the average cost of freight for all orders?"}, {"role": "assistant", "content": "SELECT AVG(Freight) AS AverageFreightCost FROM Orders"}], "prompt_id": "99679b15-6c3d-48d4-bb8b-1523e72386ff"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the rate of order cancellations in comparison to total orders placed?"}, {"role": "assistant", "content": "SELECT SUM(CASE WHEN IsCancelled = 1 THEN 1 ELSE 0 END) / COUNT(OrderID) AS CancellationRate FROM Orders"}], "prompt_id": "3cdcfb52-5432-429c-8754-28ba78422c97"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the sales share for each category?"}, {"role": "assistant", "content": "SELECT c.CategoryName, SUM(od.UnitPrice * od.Quantity) / (SELECT SUM(od.UnitPrice * od.Quantity) FROM [Order Details] od) AS sales_share FROM Categories c INNER JOIN Products p ON c.CategoryID = p.CategoryID INNER JOIN [Order Details] od ON p.ProductID = od.ProductID GROUP BY c.CategoryID;"}], "prompt_id": "c231849a-283f-4c07-8ae0-307d46b14bc5"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the order cancellation rate within the past quarter?"}, {"role": "assistant", "content": "SELECT COUNT(OrderID) / COUNT(DISTINCT OrderDate) AS CancellationRate FROM Orders WHERE IsCancelled = 1"}], "prompt_id": "8a709c9d-d9e1-44dd-8147-b5634dfb5a05"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:Which products have the highest profitability in terms of profit generated?"}, {"role": "assistant", "content": "SELECT Products.ProductName, (Products.UnitPrice - Products.Cost) * SUM([Order Details].Quantity) AS ProfitGenerated FROM Products INNER JOIN [Order Details] ON Products.ProductID = [Order Details].ProductID GROUP BY Products.ProductName"}], "prompt_id": "8a8d82d3-9174-44f5-900f-5a3448928d04"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the revenue growth rate compared to the previous period?"}, {"role": "assistant", "content": "SELECT (SUM(UnitPrice * Quantity) - (SELECT SUM(UnitPrice * Quantity) FROM [Order Details] WHERE OrderDate < DATE('now', '-1 year'))) / (SELECT SUM(UnitPrice * Quantity) FROM [Order Details] WHERE OrderDate < DATE('now', '-1 year')) AS RevenueGrowthRate FROM [Order Details] WHERE OrderDate >= DATE('now', '-1 year')"}], "prompt_id": "244f3e93-902f-4342-bbcf-c072f9b314ba"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the geographic distribution of customers based on cities and regions?"}, {"role": "assistant", "content": "SELECT City, COUNT(CustomerID) AS CustomerCount\nFROM Customers\nGROUP BY City\nUNION\nSELECT Region, COUNT(CustomerID) AS CustomerCount\nFROM Customers\nGROUP BY Region"}], "prompt_id": "f0cea834-27f4-4c7e-9d3c-c899afaf7026"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the customer complaint rate for each product category?"}, {"role": "assistant", "content": "SELECT Categories.CategoryName, COUNT(Orders.OrderID) * 1.0 / COUNT(DISTINCT Orders.CustomerID) AS ComplaintRate FROM Categories INNER JOIN Products ON Categories.CategoryID = Products.CategoryID INNER JOIN [Order Details] ON Products.ProductID = [Order Details].ProductID INNER JOIN Orders ON [Order Details].OrderID = Orders.OrderID GROUP BY Categories.CategoryName;"}], "prompt_id": "92e6c77f-99e9-45f7-a5ca-44ea53eaa80e"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:Who are the top-performing employees in terms of sales performance?"}, {"role": "assistant", "content": "SELECT EmployeeID, SUM(UnitPrice * Quantity) / COUNT(OrderID) AS SalesPerformance FROM Employees INNER JOIN Orders ON Employees.EmployeeID = Orders.EmployeeID INNER JOIN [Order Details] ON Orders.OrderID = [Order Details].OrderID GROUP BY EmployeeID ORDER BY SalesPerformance DESC"}], "prompt_id": "aef0c9e2-4e34-4c66-85c2-389e701c4f9a"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the average freight cost for each shipping company?"}, {"role": "assistant", "content": "SELECT ShipVia, AVG(Freight) AS AvgFreightCost FROM Orders GROUP BY ShipVia;"}], "prompt_id": "faa583c4-a2dd-40e5-8692-29efb73874c0"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the employee attrition rate in the company?"}, {"role": "assistant", "content": "SELECT COUNT(EmployeeID) / (SELECT (julianday(MAX(HireDate)) - julianday(MIN(HireDate))) / 365 FROM Employees) AS AttritionRate FROM Employees"}], "prompt_id": "8980609c-a3ab-48b3-8902-c7d43ab0e2d4"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:How does the inventory turnover differ by category?"}, {"role": "assistant", "content": "SELECT c.CategoryName, SUM(od.UnitPrice * od.Quantity) / (SUM(p.UnitPrice * p.UnitsInStock) / 2) AS InventoryTurnover FROM Categories c INNER JOIN Products p ON c.CategoryID = p.CategoryID INNER JOIN [Order Details] od ON p.ProductID = od.ProductID GROUP BY c.CategoryName"}], "prompt_id": "bb4aa40d-55f3-4251-aaf9-2c4b751c31e7"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the fill rate for each supplier in the past quarter?"}, {"role": "assistant", "content": "SELECT Suppliers.CompanyName, SUM([Order Details].UnitsReceived) / SUM([Order Details].UnitsOrdered) AS FillRate FROM Suppliers LEFT JOIN Products ON Suppliers.SupplierID = Products.SupplierID LEFT JOIN [Order Details] ON Products.ProductID = [Order Details].ProductID WHERE Orders.OrderDate BETWEEN DATE('now', '-3 month') AND DATE('now') GROUP BY Suppliers.CompanyName"}], "prompt_id": "726b1bcc-ecb6-425f-9fe9-6b7a7ea50500"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:How many territories are covered by each employee?"}, {"role": "assistant", "content": "SELECT EmployeeID, COUNT(TerritoryID) AS EmployeeCoverage FROM EmployeeTerritories GROUP BY EmployeeID"}], "prompt_id": "b2211c1d-f29e-498c-bd6c-1c9b8b5ff7a7"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the average order fulfillment time?"}, {"role": "assistant", "content": "SELECT AVG(julianday(o.ShippedDate) - julianday(o.OrderDate)) AS AvgFulfillmentTime FROM Orders o"}], "prompt_id": "69eb3c9e-6343-4f07-960a-b7da30324a32"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the fill rate for each supplier based on ordered and received units?"}, {"role": "assistant", "content": "SELECT Suppliers.SupplierID, SUM(CASE WHEN [Order Details].QuantityReceived IS NOT NULL THEN [Order Details].QuantityReceived ELSE 0 END) * 100.0 / SUM([Order Details].Quantity) AS FillRate FROM Suppliers INNER JOIN Products ON Suppliers.SupplierID = Products.SupplierID INNER JOIN [Order Details] ON Products.ProductID = [Order Details].ProductID GROUP BY Suppliers.SupplierID;"}], "prompt_id": "b3d08e8a-c3b8-481f-a459-ebba3a83b353"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:How many unique product categories are there in the database?"}, {"role": "assistant", "content": "SELECT COUNT(DISTINCT CategoryID) AS num_unique_categories FROM Categories"}], "prompt_id": "c90aaf1e-f0cc-4c33-a1c8-205b6ac06a14"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the revenue growth rate quarter over quarter?"}, {"role": "assistant", "content": "SELECT strftime('%Y-%m', OrderDate) AS MonthYear, (SUM([Order Details].UnitPrice * [Order Details].Quantity) - (SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity) FROM [Order Details] WHERE strftime('%Y-%m', OrderDate) = strftime('%Y-%m', DATE('now', '-3 months')))) * 1.0 / (SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity) FROM [Order Details] WHERE strftime('%Y-%m', OrderDate) = strftime('%Y-%m', DATE('now', '-3 months'))) FROM [Order Details] JOIN Orders ON [Order Details].OrderID = Orders.OrderID GROUP BY MonthYear"}], "prompt_id": "690bd428-2dcb-497a-a580-272f606f21c8"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:How many territories are covered by each employee?"}, {"role": "assistant", "content": "SELECT EmployeeID, COUNT(TerritoryID) AS TerritoryCount FROM EmployeeTerritories GROUP BY EmployeeID"}], "prompt_id": "c2087a89-6763-4151-b8cd-738408b7f6f4"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the revenue growth rate compared to the previous period?"}, {"role": "assistant", "content": "SELECT (SUM(amount) - (SELECT SUM(amount) FROM (SELECT strftime('%Y%m', OrderDate) AS month, SUM(UnitPrice * Quantity) AS amount FROM Orders o INNER JOIN [Order Details] od ON o.OrderID = od.OrderID GROUP BY month))) / (SELECT SUM(amount) FROM (SELECT strftime('%Y%m', OrderDate) AS month, SUM(UnitPrice * Quantity) AS amount FROM Orders o INNER JOIN [Order Details] od ON o.OrderID = od.OrderID GROUP BY month)) AS RevenueGrowth FROM Orders GROUP BY strftime('%Y%m', OrderDate) HAVING OrderDate = 'current_period'"}], "prompt_id": "c0cfef56-4bae-453f-9036-d64fdac58e1b"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the inventory turnover for each product category?"}, {"role": "assistant", "content": "SELECT c.CategoryName, SUM(od.UnitPrice * od.Quantity) / AVG(p.UnitsInStock) AS InventoryTurnover FROM Categories c JOIN Products p ON c.CategoryID = p.CategoryID JOIN [Order Details] od ON p.ProductID = od.ProductID GROUP BY c.CategoryName"}], "prompt_id": "5a6b4577-9460-4977-b7e6-865207561cc0"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:How are customers distributed across different geographic regions?"}, {"role": "assistant", "content": "SELECT City, Region, COUNT(CustomerID) AS CustomerCount FROM Customers GROUP BY City, Region;"}], "prompt_id": "4c06a22b-3ffb-4e1c-a60f-1ae71323d121"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:Which product has the highest profitability in terms of total profit generated?"}, {"role": "assistant", "content": "SELECT Products.ProductName, (Products.UnitPrice - Products.Cost) * [Order Details].Quantity AS Profit\nFROM Products\nLEFT JOIN [Order Details] ON Products.ProductID = [Order Details].ProductID"}], "prompt_id": "dd06861a-f94c-4691-a406-5a4eaa8d668e"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the average order value for all orders?"}, {"role": "assistant", "content": "SELECT SUM(UnitPrice * Quantity) / COUNT(*) AS AverageOrderValue FROM [Order Details]"}], "prompt_id": "94a40338-fc02-4558-8072-e70ed2f6a38f"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the sales share of each category in relation to the total sales?"}, {"role": "assistant", "content": "SELECT CategoryID, SUM([Order Details].UnitPrice * [Order Details].Quantity) / (SELECT SUM(UnitPrice * Quantity) FROM [Order Details]) AS SalesShare FROM Categories INNER JOIN Products ON Categories.CategoryID = Products.CategoryID INNER JOIN [Order Details] ON Products.ProductID = [Order Details].ProductID GROUP BY CategoryID"}], "prompt_id": "780bc99c-4373-415f-b997-78385a985e07"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the average freight cost for all orders?"}, {"role": "assistant", "content": "SELECT AVG(Freight) AS AverageFreightCost FROM Orders"}], "prompt_id": "82c23228-0cf6-416c-a7b7-759a2e860395"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:14. What is the average customer lifetime value (CLV) for each customer segment?"}, {"role": "assistant", "content": "SELECT CustomerID, (SUM(UnitPrice * Quantity) / COUNT(OrderID)) * (COUNT(OrderID) / julianday(MAX(OrderDate)) - julianday(MIN(OrderDate))) AS CLV FROM Orders JOIN [Order Details] ON Orders.OrderID = [Order Details].OrderID GROUP BY CustomerID"}], "prompt_id": "12446533-3ab6-43ff-a618-3a08498a2af6"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the average order fulfillment time for all orders?"}, {"role": "assistant", "content": "SELECT AVG(julianday(Orders.ShippedDate) - julianday(Orders.OrderDate)) AS OrderFulfillmentTime FROM Orders"}], "prompt_id": "ae80b89c-c4c2-4ada-ac2f-869871d037e2"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the customer retention rate for the company?"}, {"role": "assistant", "content": "SELECT COUNT(DISTINCT Orders.CustomerID) / COUNT(DISTINCT Customers.CustomerID) AS CustomerRetentionRate FROM Orders INNER JOIN Customers ON Orders.CustomerID = Customers.CustomerID;"}], "prompt_id": "4e63dc77-34ec-4917-9010-1baae96c1690"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the average order value for each customer?"}, {"role": "assistant", "content": "SELECT Customers.CustomerID, AVG([Order Details].UnitPrice * [Order Details].Quantity) AS AverageOrderValue FROM Customers JOIN Orders ON Customers.CustomerID = Orders.CustomerID JOIN [Order Details] ON Orders.OrderID = [Order Details].OrderID GROUP BY Customers.CustomerID"}], "prompt_id": "a4dfb31d-8e1c-458e-89b8-ec093f8788a8"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the revenue growth rate between the current period and the previous period?"}, {"role": "assistant", "content": "SELECT (SUM(RevenueCurrentPeriod) - SUM(RevenuePreviousPeriod)) / SUM(RevenuePreviousPeriod) AS RevenueGrowthRate FROM (SELECT (JULIANDAY(ShippedDate)- JULIANDAY(OrderDate))*UnitPrice*Quantity AS RevenueCurrentPeriod, (JULIANDAY(ShippedDate)- JULIANDAY(OrderDate))*UnitPrice*Quantity AS RevenuePreviousPeriod FROM [Order Details] LEFT JOIN Orders ON [Order Details] ON Orders.OrderID);"}], "prompt_id": "87a40808-222b-4ca8-a970-3ffd58ce1d61"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the order cancellation rate?"}, {"role": "assistant", "content": "SELECT COUNT(CASE WHEN ShippedDate IS NULL THEN OrderID END) / COUNT(OrderID) AS CancellationRate FROM Orders"}], "prompt_id": "f3da6cd5-57b4-49f1-b923-cd41d6892191"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the product availability rate for each product?"}, {"role": "assistant", "content": "SELECT p.ProductName, (COUNT(CASE WHEN p.UnitsInStock >= (SELECT SUM(od.Quantity) FROM [Order Details] od WHERE od.ProductID = p.ProductID) THEN p.ProductID END) / COUNT(p.ProductID)) AS AvailabilityRate FROM Products p"}], "prompt_id": "ae1b1eee-8aa2-42b6-9f8c-72701829e41c"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:How many territories does each employee cover?"}, {"role": "assistant", "content": "SELECT e.EmployeeID, COUNT(et.TerritoryID) AS TerritoryCount FROM Employees e INNER JOIN EmployeeTerritories et ON e.EmployeeID = et.EmployeeID GROUP BY e.EmployeeID;"}], "prompt_id": "2319b5c9-3221-4f60-ae5f-fe168ff88db1"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the inventory turnover rate for each product category?"}, {"role": "assistant", "content": "SELECT Categories.CategoryName, SUM([Order Details].UnitPrice * [Order Details].Quantity) / AVG(Products.UnitsInStock + Products.UnitsOnOrder / 2) AS InventoryTurnover FROM Categories INNER JOIN Products ON Categories.CategoryID = Products.CategoryID INNER JOIN [Order Details] ON Products.ProductID = [Order Details].ProductID GROUP BY Categories.CategoryName;"}], "prompt_id": "b8fbaaad-01d1-4809-8b97-dc8442ffa2db"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the sales share for each product category in relation to the total sales of all categories?"}, {"role": "assistant", "content": "SELECT Categories.CategoryName, SUM([Order Details].UnitPrice * [Order Details].Quantity) / (SELECT SUM(UnitPrice * Quantity) FROM [Order Details]) AS SalesShare FROM [Order Details] INNER JOIN Products ON [Order Details].ProductID = Products.ProductID INNER JOIN Categories ON Products.CategoryID = Categories.CategoryID GROUP BY Categories.CategoryName;"}], "prompt_id": "c22f2323-9717-4149-b8e1-f89bed2b959f"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the attrition rate of employees within a specific period?"}, {"role": "assistant", "content": "SELECT COUNT(CASE WHEN LEFT(NOTES, 7) = 'Left on' THEN 1 ELSE NULL END) / (COUNT(DISTINCT DATEPART(year, HireDate)) - 1) AS AttritionRate FROM Employees;"}], "prompt_id": "4629c6c6-3274-4965-a4a3-20b30734d72f"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the product availability rate for each product?"}, {"role": "assistant", "content": "SELECT p.ProductID, COUNT(CASE WHEN p.UnitsInStock >= od.Quantity THEN 1 ELSE 0 END) / COUNT(OrderID) AS AvailabilityRate FROM Products p LEFT JOIN [Order Details] od ON p.ProductID = od.ProductID GROUP BY p.ProductID"}], "prompt_id": "bb7b40c3-0e65-474e-a4e8-44f6e039f39a"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:How many territories are covered by each employee?"}, {"role": "assistant", "content": "SELECT Employees.EmployeeID, COUNT(EmployeeTerritories.TerritoryID) AS TerritoryCount FROM Employees JOIN EmployeeTerritories ON Employees.EmployeeID = EmployeeTerritories.EmployeeID GROUP BY Employees.EmployeeID"}], "prompt_id": "2641b5f0-a6ee-48c9-bf9c-19f9a761a5e2"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:How many new customers were acquired per day in a specific period?"}, {"role": "assistant", "content": "SELECT COUNT(CustomerID) / COUNT(DISTINCT OrderDate) AS CustomerAcquisitionRate FROM Customers"}], "prompt_id": "b9a94eb9-b3e1-42af-8538-94eb79ef50e8"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the complaint rate from customers as a percentage of total orders?"}, {"role": "assistant", "content": "SELECT (COUNT(CASE WHEN CustomerComplaint IS NOT NULL THEN 1 END) * 100.0) / COUNT(*) AS ComplaintRate FROM Orders"}], "prompt_id": "1991670f-b735-44df-a796-277e3eed7f02"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the employee attrition rate for the past 6 months?"}, {"role": "assistant", "content": "SELECT COUNT(EmployeeID) / AVG(JULIANDAY(HireDate) - JULIANDAY(BirthDate)) AS AttritionRate FROM Employees WHERE HireDate >= DATE('now', '-6 months')"}], "prompt_id": "a468ad80-5f12-45a3-8df6-efb3de6ee1fa"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the sales share of each product in its category?"}, {"role": "assistant", "content": "SELECT p.ProductID, p.ProductName, SUM(od.UnitPrice) / (SELECT SUM(UnitPrice) FROM [Order Details] WHERE ProductID = p.ProductID) AS Product_Sales_Share FROM Products p LEFT JOIN [Order Details] od ON p.ProductID = od.ProductID GROUP BY p.ProductID, p.ProductName"}], "prompt_id": "3de551b6-6626-4fcc-a9c0-628a1b3044b9"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:How many territories are covered by each employee?"}, {"role": "assistant", "content": "SELECT Employees.EmployeeID, Employees.FirstName, Employees.LastName, COUNT(DISTINCT EmployeeTerritories.TerritoryID) AS TerritoryCount FROM Employees LEFT JOIN EmployeeTerritories ON Employees.EmployeeID = EmployeeTerritories.EmployeeID GROUP BY Employees.EmployeeID, Employees.FirstName, Employees.LastName"}], "prompt_id": "4a7cb37c-5679-4968-921b-13e952d2305a"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the shipping efficiency for each shipper?"}, {"role": "assistant", "content": "SELECT Shippers.ShipperID, (SUM(CASE WHEN Orders.ShippedDate <= Orders.RequiredDate THEN 1 ELSE 0 END) / COUNT(Orders.OrderID)) * 100 AS ShippingEfficiency FROM Orders INNER JOIN Shippers ON Orders.ShipperID = Shippers.ShipperID GROUP BY Shippers.ShipperID"}], "prompt_id": "acab39f8-f748-4e3b-98f5-bcd5c8803893"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the customer retention rate over the past 6 months?"}, {"role": "assistant", "content": "SELECT (COUNT(DISTINCT Orders.CustomerID) - COUNT(DISTINCT CASE WHEN Orders.OrderDate < '2022-01-01' THEN Orders.CustomerID END)) / COUNT(DISTINCT Orders.CustomerID) AS CustomerRetentionRate FROM Orders WHERE Orders.OrderDate >= '2022-01-01';"}], "prompt_id": "aa4e0799-fbb3-44b3-98cf-1f9f4fb18b44"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the customer acquisition rate for the given time period?"}, {"role": "assistant", "content": "SELECT COUNT(CustomerID) / COUNT(DISTINCT OrderDate) AS CustomerAcquisitionRate FROM Customers;"}], "prompt_id": "fc57380d-196b-42c0-8472-18f9dc054efe"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the average order value for each customer?"}, {"role": "assistant", "content": "SELECT Customers.CustomerID, AVG([Order Details].UnitPrice * [Order Details].Quantity) AS AvgOrderValue FROM Customers JOIN Orders ON Customers.CustomerID = Orders.CustomerID JOIN [Order Details] ON Orders.OrderID = [Order Details].OrderID GROUP BY Customers.CustomerID"}], "prompt_id": "73c4c451-1619-4ffc-8ac7-4b12a67f275d"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:How many territories is each employee responsible for?"}, {"role": "assistant", "content": "SELECT EmployeeID, COUNT(TerritoryID) AS TerritoryCount FROM EmployeeTerritories GROUP BY EmployeeID"}], "prompt_id": "231892b1-7e68-4066-8dfd-8b0e2b1fd7c5"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the average freight cost by country and city?"}, {"role": "assistant", "content": "SELECT C.Country, C.City, AVG(Freight) AS AvgFreightCost FROM Customers C JOIN Orders O ON C.CustomerID = O.CustomerID GROUP BY C.Country, C.City"}], "prompt_id": "63b906bb-d8cc-481b-afc0-0f00d7e1d8b3"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:How does the customer acquisition rate vary across different regions?"}, {"role": "assistant", "content": "SELECT Region, COUNT(CustomerID) / DATEDIFF(MAX(OrderDate), MIN(OrderDate)) AS AcquisitionRate FROM Customers GROUP BY Region;"}], "prompt_id": "55e70b73-b361-4ca1-bfcc-4e052036e95a"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the availability rate for each product in stock when ordered for the past 6 months?"}, {"role": "assistant", "content": "SELECT p.ProductID, p.ProductName, (COUNT(CASE WHEN p.UnitsInStock >= od.Quantity THEN 1 END)) / COUNT(od.OrderID) AS AvailabilityRate FROM Products p JOIN [Order Details] od ON p.ProductID = od.ProductID WHERE od.OrderDate BETWEEN DATE('now', '-6 months') AND DATE('now') GROUP BY p.ProductID, p.ProductName;"}], "prompt_id": "9d754660-6835-4a97-8866-7a4faa74bb82"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the inventory turnover for each product category?"}, {"role": "assistant", "content": "WITH InventoryTurnover AS (SELECT p.ProductID, SUM((od.UnitPrice * od.Quantity) / p.UnitPrice) AS Turnover FROM [Order Details] od INNER JOIN Products p ON od.ProductID = p.ProductID GROUP BY p.ProductID) SELECT p.ProductName, i.Turnover FROM Products p INNER JOIN InventoryTurnover i ON p.ProductID = i.ProductID"}], "prompt_id": "3435e7ae-a29b-4a80-bcb8-ef2495e3fb0c"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the order cancellation rate for each customer?"}, {"role": "assistant", "content": "SELECT Customers.CustomerID, COUNT(CASE WHEN Orders.Cancelled = 'Yes' THEN Orders.OrderID END) / COUNT(Orders.OrderID) AS CancellationRate FROM Customers LEFT JOIN Orders ON Customers.CustomerID = Orders.CustomerID GROUP BY Customers.CustomerID;"}], "prompt_id": "3cd7da20-8a2b-4878-a35b-87ebfb14043e"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:How many territories are covered by each employee?"}, {"role": "assistant", "content": "SELECT E.EmployeeID, COUNT(TerritoryID) AS CoveredTerritories FROM Employees E JOIN EmployeeTerritories ET ON E.EmployeeID = ET.EmployeeID GROUP BY E.EmployeeID"}], "prompt_id": "dd3ff377-e07e-4806-9d70-50bbfe6573fe"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:How many customers are located in each city or region for customer geographic distribution?"}, {"role": "assistant", "content": "SELECT City, Region, COUNT(DISTINCT CustomerID) AS CustomerCount FROM Customers GROUP BY City, Region;"}], "prompt_id": "3ca5452f-1dda-43a6-bdc9-b537d797ac39"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:Which employee has the highest sales performance in terms of total sales generated?"}, {"role": "assistant", "content": "SELECT Employees.EmployeeID, (SUM([Order Details].UnitPrice * [Order Details].Quantity) / COUNT(DISTINCT Orders.OrderID)) AS SalesPerformance FROM Employees LEFT JOIN Orders ON Employees.EmployeeID = Orders.EmployeeID LEFT JOIN [Order Details] ON Orders.OrderID = [Order Details].OrderID GROUP BY Employees.EmployeeID"}], "prompt_id": "9261e91e-0883-42ff-8b7a-f7bdec9b96fb"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:How many territories are covered by each employee?"}, {"role": "assistant", "content": "SELECT Employees.LastName, Employees.FirstName, COUNT(EmployeeTerritories.TerritoryID) AS TerritoryCount FROM Employees LEFT JOIN EmployeeTerritories ON Employees.EmployeeID = EmployeeTerritories.EmployeeID GROUP BY Employees.LastName, Employees.FirstName;"}], "prompt_id": "2d1d966c-2ac9-41d5-875c-ec6dc9cdcb4b"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:How frequently do products hit their reorder level within the last 6 months?"}, {"role": "assistant", "content": "SELECT ProductID, COUNT(CASE WHEN julianday('now') - julianday([Order Details].OrderDate) <= 180 THEN 1 ELSE NULL END) AS ReorderFrequency FROM [Order Details] GROUP BY ProductID"}], "prompt_id": "0288ecbf-0ca8-46df-b9fc-b446bac8e610"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:How many customers have made repeat purchases in the last year?"}, {"role": "assistant", "content": "SELECT COUNT(DISTINCT Orders.CustomerID) / (SELECT COUNT(CustomerID) FROM Orders WHERE OrderDate < '2022-01-01') AS CustomerRetentionRate FROM Orders WHERE OrderDate BETWEEN '2021-01-01' AND '2021-12-31';"}], "prompt_id": "f28c508c-c7a7-45fb-9499-507588971084"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the product availability rate for each product?"}, {"role": "assistant", "content": "SELECT Products.ProductID, COUNT(CASE WHEN Products.UnitsInStock >= [Order Details].Quantity THEN 1 ELSE NULL END) / COUNT(Orders.OrderID) AS AvailabilityRate FROM Products INNER JOIN [Order Details] ON Products.ProductID = [Order Details].ProductID GROUP BY Products.ProductID;"}], "prompt_id": "f131624e-dc83-439f-a83f-4fc7463435e2"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:How many territories are covered by each employee?"}, {"role": "assistant", "content": "SELECT et.EmployeeID, COUNT(TerritoryID) AS TerritoryCount FROM EmployeeTerritories et LEFT JOIN Employees e ON et.EmployeeID = e.EmployeeID GROUP BY et.EmployeeID"}], "prompt_id": "a97a02e3-d8d7-4635-82a7-aab34c90ae7f"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:6. What is the sales share of each product category in the total sales?"}, {"role": "assistant", "content": "SELECT c.CategoryName, SUM(od.UnitPrice * od.Quantity) * 1.0 / (SELECT SUM(UnitPrice * Quantity) FROM [Order Details]) AS SalesShare FROM Categories c INNER JOIN Products p ON c.CategoryID = p.CategoryID INNER JOIN [Order Details] od ON p.ProductID = od.ProductID GROUP BY c.CategoryName"}], "prompt_id": "1e626904-17fd-4705-a154-8de735c8760b"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the average order fulfillment time for orders from each country?"}, {"role": "assistant", "content": "SELECT ShipCountry, AVG(julianday(Orders.ShippedDate) - julianday(Orders.OrderDate)) AS AvgFulfillmentTime FROM Orders GROUP BY ShipCountry;"}], "prompt_id": "e0f49edf-4211-42ef-96af-8aa7bc49a5fb"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the inventory turnover for each product category?"}, {"role": "assistant", "content": "SELECT Categories.CategoryName, SUM(UnitPrice * Quantity) / AVG(UnitsInStock) AS InventoryTurnover FROM Products INNER JOIN [Order Details] ON Products.ProductID = [Order Details].ProductID INNER JOIN Categories ON Products.CategoryID = Categories.CategoryID GROUP BY Categories.CategoryName;"}], "prompt_id": "703ab84f-708f-4957-b34e-c90098b64293"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the customer retention rate for the last six months?"}, {"role": "assistant", "content": "SELECT COUNT(DISTINCT Orders.CustomerID) / COUNT(DISTINCT Customers.CustomerID) AS CustomerRetentionRate FROM Orders CROSS JOIN Customers WHERE Orders.OrderDate <= DATE('now', '-6 months')"}], "prompt_id": "3d7c7308-16fc-4d3d-a3bd-d3caab4c5ab4"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:16. What is the average freight cost for each shipping method?"}, {"role": "assistant", "content": "SELECT Orders.ShipVia, AVG(Orders.Freight) AS AverageFreightCost FROM Orders GROUP BY Orders.ShipVia;"}], "prompt_id": "a73aef39-7180-4807-a5a6-e6f76bb5a9a7"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:Which products are the most profitable based on the calculated product profitability?"}, {"role": "assistant", "content": "SELECT p.ProductName, (od.UnitPrice - p.Cost) * od.Quantity AS Profitability FROM Products p INNER JOIN [Order Details] od ON p.ProductID = od.ProductID"}], "prompt_id": "75728608-126d-4f34-b614-154793e59085"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the revenue growth rate?"}, {"role": "assistant", "content": "SELECT strftime('%Y-%m', OrderDate) AS Period, (SUM(UnitPrice * Quantity) - (SELECT SUM(UnitPrice * Quantity) FROM [Order Details] WHERE julianday(OrderDate) < julianday(:period_start))) / (SELECT SUM(UnitPrice * Quantity) FROM [Order Details] WHERE julianday(OrderDate) < julianday(:period_start)) AS RevenueGrowthRate FROM [Order Details] WHERE julianday(OrderDate) BETWEEN julianday(:period_start) AND julianday(:period_end);"}], "prompt_id": "c4a93631-07e0-4df0-97cc-99a207750c9e"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the category sales share for each region?"}, {"role": "assistant", "content": "SELECT Categories.CategoryID, Regions.RegionDescription, SUM([Order Details].UnitPrice * [Order Details].Quantity) AS CategorySales, SUM(SUM([Order Details].UnitPrice * [Order Details].Quantity)) OVER (PARTITION BY Regions.RegionDescription) AS TotalSales, SUM([Order Details].UnitPrice * [Order Details].Quantity) / SUM(SUM([Order Details].UnitPrice * [Order Details].Quantity)) OVER (PARTITION BY Regions.RegionDescription) AS CategorySalesShare FROM Categories INNER JOIN Products ON Categories.CategoryID = Products.CategoryID INNER JOIN [Order Details] ON Products.ProductID = [Order Details].ProductID INNER JOIN Orders ON [Order Details].OrderID = Orders.OrderID INNER JOIN Customers ON Orders.CustomerID = Customers.CustomerID INNER JOIN Regions ON Customers.Region = Regions.RegionID GROUP BY Categories.CategoryID, Regions.RegionDescription"}], "prompt_id": "579013f9-a832-466c-8128-3d14d21ae93e"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:How many territories are covered by each employee?"}, {"role": "assistant", "content": "SELECT e.EmployeeID, COUNT(et.TerritoryID) AS CoveredTerritories FROM Employees e JOIN EmployeeTerritories et ON e.EmployeeID = et.EmployeeID GROUP BY e.EmployeeID"}], "prompt_id": "26a520fc-7184-4af2-834b-c2bed8d6cbc2"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the inventory turnover rate for each product?"}, {"role": "assistant", "content": "SELECT p.ProductName, (SUM(od.UnitPrice) * SUM(od.Quantity)) / (p.UnitsInStock + p.UnitsOnOrder) AS InventoryTurnover FROM Products p LEFT JOIN [Order Details] od ON p.ProductID = od.ProductID GROUP BY p.ProductName"}], "prompt_id": "f24b6651-a0f8-4cdd-a7c9-8141b2449337"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the sales share of each category compared to the total sales of all categories?"}, {"role": "assistant", "content": "SELECT Categories.CategoryName, SUM([Order Details].UnitPrice * [Order Details].Quantity) / (SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity) FROM [Order Details]) AS SalesShare FROM Categories LEFT JOIN Products ON Categories.CategoryID = Products.CategoryID LEFT JOIN [Order Details] ON Products.ProductID = [Order Details].ProductID GROUP BY Categories.CategoryName"}], "prompt_id": "23e1d514-d0a6-4f7b-97b8-885a5c310b26"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the customer lifetime value (CLV) for each customer?"}, {"role": "assistant", "content": "SELECT c.CustomerID, AVG(od.UnitPrice * od.Quantity) * COUNT(o.OrderID) * DATEDIFF('day',MIN(o.OrderDate),MAX(o.OrderDate)) AS CLV FROM Customers c LEFT JOIN Orders o ON c.CustomerID = o.CustomerID LEFT JOIN [Order Details] od ON o.OrderID = od.OrderID GROUP BY c.CustomerID;"}], "prompt_id": "e944d5f8-6b77-4854-8953-f42b7c38eacf"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:How many times did each product hit its reorder level within the last quarter?"}, {"role": "assistant", "content": "SELECT Products.ProductID, COUNT([Order Details].OrderID) AS ReorderFrequency FROM [Order Details] WHERE [Order Details].OrderDate BETWEEN date('now', '-3 months') AND date('now') AND ([Order Details].UnitInStock + [Order Details].UnitsOnOrder) <= [Order Details].ReorderLevel GROUP BY Products.ProductID"}], "prompt_id": "19fd7633-d253-4768-8bc9-61a75031d62d"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:How often does each product hit its reorder level within a specific time frame?"}, {"role": "assistant", "content": "SELECT ProductID, COUNT(*) AS ReorderFrequency FROM (SELECT ProductID, OrderID, ROW_NUMBER() OVER (PARTITION BY ProductID, OrderID ORDER BY OrderDate) AS rn FROM Orders) sub WHERE rn = 1 GROUP BY ProductID"}], "prompt_id": "fb618e98-66a5-47d5-8e05-44dc04d868a6"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the fill rate for each supplier in terms of total units received and ordered?"}, {"role": "assistant", "content": "SELECT Suppliers.CompanyName, SUM([Order Details].QuantityReceived) / SUM([Order Details].QuantityOrdered) AS SupplierFillRate FROM Suppliers LEFT JOIN Products ON Suppliers.SupplierID = Products.SupplierID LEFT JOIN [Order Details] ON Products.ProductID = [Order Details].ProductID GROUP BY Suppliers.CompanyName"}], "prompt_id": "988dc298-13d5-4cbe-a4f4-1d569731e266"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:Which products have the highest profitability in terms of total profit generated?"}, {"role": "assistant", "content": "SELECT Products.ProductID, (Products.UnitPrice - [Order Details].UnitPrice) * [Order Details].Quantity AS Profitability FROM Products INNER JOIN [Order Details] ON Products.ProductID = [Order Details].ProductID ORDER BY Profitability DESC"}], "prompt_id": "10a3beae-36c0-4e0d-b785-95039be8bccb"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the average order fulfillment time?"}, {"role": "assistant", "content": "SELECT AVG(julianday(Orders.ShippedDate) - julianday(Orders.OrderDate)) AS AvgFulfillmentTime FROM Orders"}], "prompt_id": "b18a9457-8d83-4e62-a656-baabcd6a9950"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:Which products are the most profitable based on the calculated profit values?"}, {"role": "assistant", "content": "SELECT ProductName, (UnitPrice - cost) * Quantity AS ProfitValue FROM Products JOIN [Order Details] ON Products.ProductID = [Order Details].ProductID"}], "prompt_id": "47ba3835-f2ae-4787-81a9-7a27a825f9f0"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:How often do products hit their reorder level within a specific time frame?"}, {"role": "assistant", "content": "SELECT ProductID, COUNT(ProductID) AS ReorderFrequency FROM [Order Details] WHERE UnitsInStock <= ReorderLevel GROUP BY ProductID;"}], "prompt_id": "735bcebd-bfb4-41cc-9e70-4eaf957c4beb"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:Which products are the most profitable in terms of total profit?"}, {"role": "assistant", "content": "SELECT p.ProductID, (p.UnitPrice - p.Cost) * SUM([Order Details].Quantity) AS Profitability FROM [Order Details] INNER JOIN Products p ON [Order Details].ProductID = p.ProductID GROUP BY p.ProductID ORDER BY Profitability DESC"}], "prompt_id": "185ecbbe-87c4-479e-b4eb-7c8115199f15"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the average order value (AOV) for all orders?"}, {"role": "assistant", "content": "SELECT SUM(UnitPrice * Quantity) / COUNT(DISTINCT OrderID) AS AOV FROM [Order Details]"}], "prompt_id": "656aed4e-98c7-4355-8330-ae83e76c766c"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:How does the complaint rate from customers vary between different product categories?"}, {"role": "assistant", "content": "SELECT Categories.CategoryName, (COUNT(CASE WHEN Orders.ComplaintType IS NOT NULL THEN 1 END) / COUNT(Orders.OrderID)) AS ComplaintRate\nFROM Orders\nJOIN [Order Details] ON Orders.OrderID = [Order Details].OrderID\nJOIN Products ON [Order Details].ProductID = Products.ProductID\nJOIN Categories ON Products.CategoryID = Categories.CategoryID\nGROUP BY Categories.CategoryName"}], "prompt_id": "57c10387-1585-4b16-bc47-df96d8146e4e"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the availability rate for each product in terms of being in stock when ordered?"}, {"role": "assistant", "content": "SELECT p.ProductID, SUM(CASE WHEN UnitsInStock >= od.Quantity THEN 1 ELSE 0 END) / COUNT(od.OrderID) AS AvailabilityRate FROM Products p INNER JOIN [Order Details] od ON p.ProductID = od.ProductID GROUP BY p.ProductID"}], "prompt_id": "66bb96c5-b857-42cb-8512-729d91193788"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What percentage of orders were shipped on or before the required date?"}, {"role": "assistant", "content": "SELECT SUM(CASE WHEN ShippedDate <= RequiredDate THEN 1 ELSE 0 END) / COUNT(*) AS ShippingEfficiency FROM Orders"}], "prompt_id": "b971d912-c231-447d-ac75-598bff8299e1"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the rate of customer complaints per order?"}, {"role": "assistant", "content": "SELECT COUNT(Complaints) / COUNT(*) AS ComplaintRate FROM Orders"}], "prompt_id": "36d81070-df6f-43aa-a54c-9996061cc9d9"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the average order fulfillment time for all orders?"}, {"role": "assistant", "content": "SELECT AVG(DATEDIFF(day, OrderDate, ShippedDate)) AS AvgFulfillmentTime FROM Orders"}], "prompt_id": "68898023-a499-4ba0-aa1b-c3c26faaebb1"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the average freight cost for each region in the past year?"}, {"role": "assistant", "content": "SELECT Region, AVG(Freight) AS AvgFreightCost\nFROM Orders\nGROUP BY Region;"}], "prompt_id": "ebfc6a1a-4038-41b7-9a4a-2e7140da9c8f"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the order cancellation rate for each product category?"}, {"role": "assistant", "content": "SELECT Categories.CategoryID, (COUNT(CASE WHEN Orders.ShippedDate IS NULL THEN Orders.OrderID ELSE NULL END) / COUNT(Orders.OrderID) * 100) AS CancellationRate FROM Categories INNER JOIN Products ON Categories.CategoryID = Products.CategoryID INNER JOIN [Order Details] ON Products.ProductID = [Order Details].ProductID INNER JOIN Orders ON [Order Details].OrderID = Orders.OrderID GROUP BY Categories.CategoryID"}], "prompt_id": "bd4d69dc-a241-45af-8a18-efc67a4e2125"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the average customer lifetime value for each customer and how does it compare across different customer segments?"}, {"role": "assistant", "content": "SELECT CustomerID, AVG(UnitPrice * Quantity) * COUNT(OrderID) * AVG(DATEDIFF(ShippedDate, OrderDate)) AS CLV FROM Customers c JOIN Orders o ON c.CustomerID = o.CustomerID JOIN [Order Details] od ON o.OrderID = od.OrderID GROUP BY CustomerID;"}], "prompt_id": "3f877222-31a1-4213-93c0-61441cf5868f"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:Which product has the highest profitability?"}, {"role": "assistant", "content": "SELECT Products.ProductName, (SUM([Order Details].UnitPrice - [Cost] * [Order Details].Quantity) AS Profit\nFROM Products\nINNER JOIN [Order Details] ON Products.ProductID = [Order Details].ProductID\nGROUP BY Products.ProductName"}], "prompt_id": "8546bcba-8a0f-48e9-936c-ffd7413981f0"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the shipping efficiency in terms of orders shipped on or before the required date?"}, {"role": "assistant", "content": "SELECT SUM(CASE WHEN ShippedDate <= RequiredDate THEN 1 ELSE 0 END) / COUNT(OrderID) AS ShippingEfficiency FROM Orders;"}], "prompt_id": "2ab9277d-5de1-44ac-a1f0-d396e9026dde"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:How often do products hit their reorder level within a specific time frame?"}, {"role": "assistant", "content": "SELECT ProductID, COUNT(DISTINCT(o.OrderID)) / DATEDIFF('end_date', 'start_date') AS ReorderFrequency FROM [Order Details] od JOIN Orders o ON od.OrderID = o.OrderID WHERE o.OrderDate BETWEEN 'start_date' AND 'end_date' AND od.Quantity <= ReorderLevel GROUP BY ProductID;"}], "prompt_id": "0391d56b-46fa-489e-ba4c-768d95510268"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the order cancellation rate by customer location?"}, {"role": "assistant", "content": "SELECT Customers.City, SUM(CASE WHEN ShippedDate IS NULL THEN 1 ELSE 0 END) / COUNT(Orders.OrderID) AS CancellationRate FROM Orders GROUP BY Customers.City;"}], "prompt_id": "ed728e56-83ee-43ea-8d56-f2411be271ad"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the average lifetime value of customers by region?"}, {"role": "assistant", "content": "SELECT Employees.Region, AVG(([Order Details].UnitPrice * [Order Details].Quantity) * (julianday(MAX(Orders.OrderDate)) - julianday(MIN(Orders.OrderDate))) * (COUNT(Orders.OrderID) - 1)) AS AvgLifetimeValue FROM Employees INNER JOIN Orders ON Employees.EmployeeID = Orders.EmployeeID INNER JOIN [Order Details] ON Orders.OrderID = [Order Details].OrderID GROUP BY Employees.Region"}], "prompt_id": "e056aecd-247a-492c-b666-50548c5f1aa0"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the average number of territories covered by employees in each city?"}, {"role": "assistant", "content": "SELECT e.City, COUNT(DISTINCT t.TerritoryID) AS Number_of_Territories FROM Employees e INNER JOIN EmployeeTerritories t ON e.EmployeeID = t.EmployeeID GROUP BY e.City"}], "prompt_id": "c7d3427b-3d95-4e44-b23b-89e0acbc6a20"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the complaint rate from customers?"}, {"role": "assistant", "content": "SELECT COUNT(CASE WHEN Orders.Complaint IS NOT NULL THEN 1 ELSE NULL END) / COUNT(Orders.OrderID) AS customer_complaint_rate FROM Orders"}], "prompt_id": "746297ac-2f17-4b2d-9797-a5d1f54301bf"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the customer acquisition rate for the period?"}, {"role": "assistant", "content": "SELECT COUNT(CustomerID) / COUNT(DISTINCT OrderDate) AS AcquisitionRate FROM Customers"}], "prompt_id": "0bc6a374-7485-4e35-98ca-905bd43e174e"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the inventory turnover for each product?"}, {"role": "assistant", "content": "SELECT Products.ProductID, SUM([Order Details].UnitPrice * [Order Details].Quantity) / AVG(Products.UnitsInStock) AS InventoryTurnover FROM Products, [Order Details] WHERE Products.ProductID = [Order Details].ProductID GROUP BY Products.ProductID;"}], "prompt_id": "893bff8f-52a6-4d15-86d2-a8fbe9f42113"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the attrition rate for each title and how does it vary?"}, {"role": "assistant", "content": "SELECT Employees.Title, (COUNT(DISTINCT Orders.OrderDate) / ((COUNT(DISTINCT Employees.EmployeeID) + COUNT(DISTINCT Employees.ReportsTo)) / 2)) AS AttritionRate FROM Employees INNER JOIN Orders ON Employees.EmployeeID = Orders.EmployeeID WHERE Employees.HireDate BETWEEN 'start_date' AND 'end_date' GROUP BY Employees.Title;"}], "prompt_id": "7906486b-da46-4dff-a422-e0d2dd911d77"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the average freight cost for each shipper?"}, {"role": "assistant", "content": "SELECT Shippers.ShipperID, AVG(Orders.Freight) AS AverageFreightCost FROM Shippers LEFT JOIN Orders ON Shippers.ShipperID = Orders.ShipVia GROUP BY Shippers.ShipperID"}], "prompt_id": "566086aa-6c46-4ec6-8091-e028945d0e2c"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the customer acquisition rate over the past month?"}, {"role": "assistant", "content": "SELECT COUNT(CustomerID) / COUNT(DISTINCT DATE(OrderDate)) AS CustomerAcquisitionRate FROM Orders"}], "prompt_id": "0d12c05b-b79d-4d89-84ea-e7ebaba0fc61"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:How often do products hit their reorder level within the past quarter?"}, {"role": "assistant", "content": "SELECT ProductID, COUNT(OrderID) AS ReorderFrequency FROM [Order Details] WHERE Quantity <= ReorderLevel AND OrderDate >= (DATE(NOW()) - INTERVAL 3 MONTH) GROUP BY ProductID"}], "prompt_id": "3c099698-6dc2-4aca-aa6b-45acd60cf866"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:How efficient is the shipping process in terms of orders shipped on or before the required date?"}, {"role": "assistant", "content": "SELECT COUNT(CASE WHEN julianday(Orders.ShippedDate) - julianday(Orders.RequiredDate) >= 0 THEN 1 END) / COUNT(Orders.OrderID) AS ShippingEfficiency FROM Orders GROUP BY Orders.RequiredDate"}], "prompt_id": "a45493d6-e6da-4c06-9e1e-2d752788857f"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the average unit price for each product category?"}, {"role": "assistant", "content": "SELECT CategoryID, AVG(UnitPrice) AS avg_unit_price FROM Products GROUP BY CategoryID"}], "prompt_id": "4b91f004-ff61-47d0-838b-dd232bf12d96"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:How many new customers were acquired each month?"}, {"role": "assistant", "content": "SELECT strftime('%Y-%m', Orders.OrderDate) AS MonthYear, COUNT(DISTINCT Customers.CustomerID) AS NewCustomers FROM Customers INNER JOIN Orders ON Customers.CustomerID = Orders.CustomerID GROUP BY strftime('%Y-%m', Orders.OrderDate);"}], "prompt_id": "617c89d4-bf66-48cc-8879-987f7ced5558"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the reorder frequency for each product? Are there any patterns?"}, {"role": "assistant", "content": "SELECT p.ProductID, p.ProductName, COUNT(od.OrderID) / DATEDIFF(MONTH, MIN(o.OrderDate), MAX(o.OrderDate)) AS ReorderFrequency FROM Products p INNER JOIN [Order Details] od ON p.ProductID = od.ProductID INNER JOIN Orders o ON od.OrderID = o.OrderID GROUP BY p.ProductID, p.ProductName"}], "prompt_id": "60c8b007-eb46-436f-b6dd-e79c0754a300"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the average freight cost for each order?"}, {"role": "assistant", "content": "SELECT Orders.OrderID, AVG(Orders.Freight) AS AvgFreightCost FROM Orders GROUP BY Orders.OrderID;"}], "prompt_id": "c0c9fa81-902e-4137-9e23-63a4e69fa92e"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the customer lifetime value for each customer?"}, {"role": "assistant", "content": "SELECT Customers.CustomerID, AVG([Order Details].UnitPrice * [Order Details].Quantity) * COUNT(Orders.OrderID) * julianday(MAX(Orders.OrderDate) - MIN(Orders.OrderDate)) AS CLV FROM Customers INNER JOIN Orders ON Customers.CustomerID = Orders.CustomerID INNER JOIN [Order Details] ON Orders.OrderID = [Order Details].OrderID GROUP BY Customers.CustomerID;"}], "prompt_id": "494a2fff-3e68-4e4d-ab9e-db052c5e6af9"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:How is the distribution of customers in different cities and regions?"}, {"role": "assistant", "content": "SELECT City, Region, COUNT(CustomerID) AS NumberOfCustomers FROM Customers GROUP BY City, Region"}], "prompt_id": "d8181bb4-7f9c-48fb-bfbe-d4fd7308e4cf"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the average order value for each category of products?"}, {"role": "assistant", "content": "SELECT Categories.CategoryName, AVG([Order Details].UnitPrice * [Order Details].Quantity) AS AvgOrderValue FROM Categories INNER JOIN Products ON Categories.CategoryID = Products.CategoryID INNER JOIN [Order Details] ON Products.ProductID = [Order Details].ProductID GROUP BY Categories.CategoryName"}], "prompt_id": "5ab157df-fd17-40d7-885f-2ccd7c5625b8"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:How many territories are covered by each employee on average?"}, {"role": "assistant", "content": "SELECT e.EmployeeID, COUNT(DISTINCT et.TerritoryID) AS TerritoryCount FROM Employees e LEFT JOIN EmployeeTerritories et ON e.EmployeeID = et.EmployeeID GROUP BY e.EmployeeID;"}], "prompt_id": "c7a2d9af-1dcf-4194-82ad-b4e547f712d6"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:How many territories are covered by each employee?"}, {"role": "assistant", "content": "SELECT et.EmployeeID, COUNT(TerritoryID) AS TerritoryCount FROM EmployeeTerritories et GROUP BY et.EmployeeID"}], "prompt_id": "b3c4c819-cae3-44c6-b67b-1d8324893099"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the average freight cost for each shipping method?"}, {"role": "assistant", "content": "SELECT ShipVia, AVG(Freight) AS AverageFreightCost FROM Orders GROUP BY ShipVia;"}], "prompt_id": "4d243840-4fc8-432a-adfc-b623be646cd1"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the reorder frequency for each product within a specific time frame?"}, {"role": "assistant", "content": "SELECT Products.ProductID, COUNT(CASE WHEN [Order Details].UnitsInStock < Products.ReorderLevel THEN [Order Details].ProductID END) / (julianday('now') - julianday(MAX([Order Details].OrderDate))) AS ReorderFrequency FROM Products LEFT JOIN [Order Details] ON Products.ProductID = [Order Details].ProductID GROUP BY Products.ProductID"}], "prompt_id": "aa133f3c-a60e-4a1b-a31b-a0cd9c404763"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the average order value for each customer?"}, {"role": "assistant", "content": "SELECT Customers.CustomerID, AVG([Order Details].UnitPrice * [Order Details].Quantity) AS AvgOrderValue FROM Customers LEFT JOIN Orders ON Customers.CustomerID = Orders.CustomerID LEFT JOIN [Order Details] ON Orders.OrderID = [Order Details].OrderID GROUP BY Customers.CustomerID;"}], "prompt_id": "7cd57511-bef6-4ea0-a131-49c46e53e1c0"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:How many territories does each employee cover on average?"}, {"role": "assistant", "content": "SELECT Employees.EmployeeID, COUNT(EmployeeTerritories.TerritoryID) AS TerritoryCount FROM Employees JOIN EmployeeTerritories ON Employees.EmployeeID = EmployeeTerritories.EmployeeID GROUP BY Employees.EmployeeID"}], "prompt_id": "6ca3ffad-cdd9-48cd-b572-50dc8240c821"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:How are the customers distributed geographically in terms of cities and regions?"}, {"role": "assistant", "content": "SELECT City, Region, COUNT(CustomerID) AS Customer_Count FROM Customers GROUP BY City, Region"}], "prompt_id": "37d34578-228e-4b1b-bf99-573c7b6ed674"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the retention rate of customers who made repeat purchases within the last quarter?"}, {"role": "assistant", "content": "SELECT COUNT(DISTINCT Orders.CustomerID) * 100.0 / (SELECT COUNT(DISTINCT Customers.CustomerID) FROM Customers) AS RetentionRate FROM Customers INNER JOIN Orders ON Customers.CustomerID = Orders.CustomerID WHERE Orders.OrderDate BETWEEN date('now', '-3 months') AND date('now');"}], "prompt_id": "28f6cef2-982b-4b11-b47b-33be33b6aae0"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the average unit price for each product category?"}, {"role": "assistant", "content": "SELECT Products.CategoryID, AVG(Products.UnitPrice) AS AvgUnitPrice FROM Products GROUP BY Products.CategoryID"}], "prompt_id": "2096fef3-456c-459e-97b7-aa2278bce56d"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the product availability rate for each product?"}, {"role": "assistant", "content": "SELECT p.ProductID, (SELECT COUNT(*) FROM Orders o2 LEFT JOIN [Order Details] od ON o2.OrderID = od.OrderID WHERE o2.ShippedDate IS NOT NULL AND o2.OrderID = od.OrderID AND p.ProductID = od.ProductID) / COUNT(*) AS AvailabilityRate FROM Products p LEFT JOIN [Order Details] od ON p.ProductID = od.ProductID GROUP BY p.ProductID;"}], "prompt_id": "3b33b3f9-ee6d-49ca-af7f-229cf7a7bd0f"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the average freight cost for all orders?"}, {"role": "assistant", "content": "SELECT AVG(Freight) AS AverageFreightCost FROM Orders"}], "prompt_id": "dbafcf7a-813d-4539-b528-610b19ef8200"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the revenue growth rate on a monthly basis?"}, {"role": "assistant", "content": "SELECT strftime('%Y-%m', Orders.OrderDate) AS MonthYear, ((SUM([Order Details].UnitPrice * [Order Details].Quantity) - LAG(SUM([Order Details].UnitPrice * [Order Details].Quantity)) OVER (ORDER BY Orders.OrderDate)) / LAG(SUM([Order Details].UnitPrice * [Order Details].Quantity)) OVER (ORDER BY Orders.OrderDate)) AS RevenueGrowthRate FROM Orders INNER JOIN [Order Details] ON Orders.OrderID = [Order Details].OrderID GROUP BY MonthYear"}], "prompt_id": "e747944a-e6e0-41c1-b45a-6efe3296bf3d"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:Which products are the most profitable based on the unit price, cost, and quantity sold?"}, {"role": "assistant", "content": "SELECT p.ProductName, (p.UnitPrice - cost) * od.Quantity AS Profitability FROM Products p LEFT JOIN (SELECT ProductID, AVG(UnitPrice) AS cost FROM [Order Details] GROUP BY ProductID) c ON p.ProductID = c.ProductID LEFT JOIN [Order Details] od ON p.ProductID = od.ProductID;"}], "prompt_id": "578a533c-05a4-427e-a8ef-9e71123f917b"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:Which products are the most profitable based on the (Unit price - cost) * quantity sold?"}, {"role": "assistant", "content": "SELECT p.ProductName, ((UnitPrice - Cost) * Quantity) AS ProductProfitability FROM Products p INNER JOIN [Order Details] od ON p.ProductID = od.ProductID"}], "prompt_id": "0bd4d448-132f-414f-b90a-3b2ca3a5c306"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:How is the geographic distribution of customers across different cities and regions?"}, {"role": "assistant", "content": "SELECT Customers.City, COUNT(Customers.CustomerID) AS CustomerCount FROM Customers GROUP BY Customers.City"}], "prompt_id": "56d45701-b2d4-4652-919c-835032c9f6cd"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the employee attrition rate in the last year?"}, {"role": "assistant", "content": "SELECT COUNT(EmployeeID) / AVG(julianday(HireDate) - julianday(BirthDate)) AS AttritionRate FROM Employees WHERE HireDate >= DATE('now', '-1 year');"}], "prompt_id": "0f29b385-f35e-4f36-9ad5-2cdf44c4f31e"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the average order fulfillment time for each shipper?"}, {"role": "assistant", "content": "SELECT o.ShipVia, AVG(julianday(o.ShippedDate) - julianday(o.OrderDate)) AS AvgFulfillmentTime\nFROM Orders o\nGROUP BY o.ShipVia"}], "prompt_id": "a5d7e819-b7c9-442b-b415-bb3f61ecc6cd"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:14. What is the customer lifetime value (CLV) for each customer?"}, {"role": "assistant", "content": "SELECT Customers.CustomerID, AVG([Order Details].UnitPrice * [Order Details].Quantity) * COUNT(Orders.OrderID) * (julianday(MAX(Orders.RequiredDate)) - julianday(MIN(Orders.OrderDate))) AS CLV FROM Customers INNER JOIN Orders ON Customers.CustomerID = Orders.CustomerID INNER JOIN [Order Details] ON Orders.OrderID = [Order Details].OrderID;"}], "prompt_id": "0cb48a5c-2577-4b72-931e-6a0a868fa8e3"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the average order fulfillment time for all orders?"}, {"role": "assistant", "content": "SELECT AVG(DATEDIFF(day, OrderDate, ShippedDate)) AS AvgFulfillmentTime FROM Orders"}], "prompt_id": "fdb57ac1-9697-427e-871a-777dde822f4d"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the availability rate for each product based on the in-stock status when ordered?"}, {"role": "assistant", "content": "SELECT Products.ProductID, (COUNT(CASE WHEN UnitsInStock = UnitsOnOrder THEN 1 END) * 1.0 / COUNT(Orders.OrderID)) AS AvailabilityRate FROM Products INNER JOIN [Order Details] ON Products.ProductID = [Order Details].ProductID GROUP BY Products.ProductID;"}], "prompt_id": "e2bb8ae9-35c1-4f9f-8f8a-9e1807714972"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the customer retention rate within a specific time frame?"}, {"role": "assistant", "content": "SELECT COUNT(DISTINCT O2.CustomerID) / COUNT(DISTINCT O1.CustomerID) AS customer_retention_rate FROM Orders O1, Orders O2 WHERE O1.OrderDate < O2.OrderDate AND O2.ShippedDate IS NOT NULL"}], "prompt_id": "574a495f-06a7-4e9b-9a3c-3a554ff4856c"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the geographic distribution of customers by city and region?"}, {"role": "assistant", "content": "SELECT City, Region, COUNT(CustomerID) AS NumCustomers FROM Customers GROUP BY City, Region;"}], "prompt_id": "b8553862-f6c7-4003-b228-e012e35bedce"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the availability rate of each product based on the number of times it is in stock when ordered?"}, {"role": "assistant", "content": "SELECT Products.ProductID, COUNT(DISTINCT CASE WHEN UnitsInStock > 0 THEN OrderID END) / COUNT(OrderID) AS ProductAvailabilityRate FROM Products INNER JOIN [Order Details] ON Products.ProductID = [Order Details].ProductID"}], "prompt_id": "ed6a25a3-a2c9-4711-a8b7-d1ea70981003"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the average order fulfillment time for each shipping company?"}, {"role": "assistant", "content": "SELECT Orders.ShipVia, AVG(julianday(Orders.ShippedDate) - julianday(Orders.OrderDate)) AS AvgFulfillmentTime FROM Orders GROUP BY Orders.ShipVia;"}], "prompt_id": "a8731fae-4b16-43b8-ae7c-b898d5bcf49e"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the supplier fill rate for each supplier in the database?"}, {"role": "assistant", "content": "SELECT s.CompanyName, SUM(od.Quantity) / (SELECT SUM(Quantity) FROM [Order Details]) AS FillRate FROM Suppliers s INNER JOIN Products p ON s.SupplierID = p.SupplierID INNER JOIN [Order Details] od ON p.ProductID = od.ProductID GROUP BY s.CompanyName"}], "prompt_id": "74c3fe12-6e41-4151-aeb9-0af344641e63"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the inventory turnover for each product category?"}, {"role": "assistant", "content": "SELECT Categories.CategoryName, (SUM([Order Details].UnitPrice * [Order Details].Quantity) / AVG(Products.UnitsInStock)) AS InventoryTurnover FROM Categories INNER JOIN Products ON Categories.CategoryID = Products.CategoryID INNER JOIN [Order Details] ON Products.ProductID = [Order Details].ProductID GROUP BY Categories.CategoryName;"}], "prompt_id": "d7c4aa49-391f-481e-b90f-1d491c42de47"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the total sales generated by each employee and their corresponding number of orders handled?"}, {"role": "assistant", "content": "SELECT e.EmployeeID, e.LastName, e.FirstName, (SUM(od.UnitPrice * od.Quantity) / COUNT(DISTINCT o.OrderID)) AS SalesPerOrder FROM Employees e INNER JOIN Orders o ON e.EmployeeID = o.EmployeeID INNER JOIN [Order Details] od ON o.OrderID = od.OrderID GROUP BY e.EmployeeID, e.LastName, e.FirstName"}], "prompt_id": "4559ff1e-3092-4511-89a5-5a46a9bb9cfe"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:How does the sales performance of employees vary across different regions?"}, {"role": "assistant", "content": "SELECT Employees.EmployeeID, Employees.FirstName, Employees.LastName, Employees.Region, SUM([Order Details].UnitPrice * [Order Details].Quantity) / COUNT(DISTINCT Orders.OrderID) AS SalesPerformance FROM Employees INNER JOIN Orders ON Employees.EmployeeID = Orders.EmployeeID INNER JOIN [Order Details] ON Orders.OrderID = [Order Details].OrderID GROUP BY Employees.EmployeeID, Employees.FirstName, Employees.LastName, Employees.Region"}], "prompt_id": "abf8aca8-651c-4602-bbfd-240390af6d36"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the geographic distribution of customers based on cities and regions?"}, {"role": "assistant", "content": "SELECT City, COUNT(CustomerID) AS CustomerCount FROM Customers GROUP BY City"}], "prompt_id": "2b7c44e8-cc4f-4ee2-a2d8-1104d3df07de"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the customer lifetime value (CLV) for the top 10% of customers in terms of purchase frequency?"}, {"role": "assistant", "content": "SELECT c.CustomerID, AVG(od.UnitPrice * od.Quantity) * COUNT(o.OrderID) * (julianday(MAX(o.OrderDate)) - julianday(MIN(o.OrderDate))) AS CLV FROM Customers c JOIN Orders o ON c.CustomerID = o.CustomerID JOIN [Order Details] od ON o.OrderID = od.OrderID GROUP BY c.CustomerID ORDER BY CLV DESC LIMIT (SELECT COUNT(CustomerID) * 0.1 FROM Customers)"}], "prompt_id": "47e6ca73-aae8-4144-a9dc-23cc52e592e2"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the order cancellation rate based on the number of canceled orders compared to the total number of orders placed?"}, {"role": "assistant", "content": "SELECT COUNT(CASE WHEN IsCancelled = 'Yes' THEN 1 END) / COUNT(OrderID) AS cancellation_rate FROM Orders"}], "prompt_id": "eedf6d43-22de-4fbf-912c-6a3cb5e58459"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:How often do products hit their reorder level within a specific time frame?"}, {"role": "assistant", "content": "SELECT Products.ProductName, COUNT(CASE WHEN UnitsInStock <= ReorderLevel THEN 1 END) AS ReorderFrequency FROM Products GROUP BY Products.ProductName;"}], "prompt_id": "ec7d6f58-04aa-4888-a4ff-289d3b940470"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the fill rate for each supplier in terms of units received and ordered?"}, {"role": "assistant", "content": "SELECT Suppliers.CompanyName, (SUM([Order Details].Quantity) / SUM(Products.UnitsInStock)) AS FillRate FROM Suppliers LEFT JOIN Products ON Suppliers.SupplierID = Products.SupplierID LEFT JOIN [Order Details] ON Products.ProductID = [Order Details].ProductID GROUP BY Suppliers.CompanyName;"}], "prompt_id": "dd612147-75c3-4cfe-bd10-5c6387e71fbc"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the sales share of each category?"}, {"role": "assistant", "content": "SELECT Categories.CategoryName, SUM([Order Details].UnitPrice * [Order Details].Quantity) / (SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity) FROM [Order Details]) AS SalesShare FROM Categories INNER JOIN Products ON Categories.CategoryID = Products.CategoryID INNER JOIN [Order Details] ON Products.ProductID = [Order Details].ProductID GROUP BY Categories.CategoryName;"}], "prompt_id": "a0898489-8c66-4aac-931c-7d07e0a0d778"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the reorder frequency for each product within the past quarter?"}, {"role": "assistant", "content": "SELECT ProductID, COUNT(ProductID) AS ReorderFrequency FROM Products p INNER JOIN (SELECT ProductID, COUNT(*) AS OrdCount FROM [Order Details] GROUP BY ProductID) o ON p.ProductID = o.ProductID WHERE UnitsInStock < ReorderLevel AND orderDate BETWEEN DATEADD(MONTH, -3, GETDATE()) AND GETDATE() GROUP BY ProductID"}], "prompt_id": "af4c3a4a-d1bd-480f-9db9-21d4969fe5eb"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the order cancellation rate for the last quarter?"}, {"role": "assistant", "content": "SELECT (COUNT(CASE WHEN Orders.ShippedDate IS NULL THEN OrderID END) / COUNT(Orders.OrderID)) * 100 AS CancellationRate FROM Orders WHERE Orders.OrderDate >= DATE('now', '-3 months');"}], "prompt_id": "1b4e0adf-efc7-4c29-9c43-7eef1cc19907"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the revenue growth rate for each period?"}, {"role": "assistant", "content": "SELECT Orders.OrderDate, (SUM([Order Details].UnitPrice * [Order Details].Quantity) - LAG(SUM([Order Details].UnitPrice * [Order Details].Quantity), 1, 0) OVER (ORDER BY Orders.OrderDate)) / LAG(SUM([Order Details].UnitPrice * [Order Details].Quantity), 1, 1) OVER (ORDER BY Orders.OrderDate) AS RevenueGrowth FROM Orders LEFT JOIN [Order Details] ON Orders.OrderID = [Order Details].OrderID"}], "prompt_id": "1e01209d-63cc-447f-a64e-93d64482a884"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:Who are the top performing employees in terms of sales?"}, {"role": "assistant", "content": "SELECT e.EmployeeID, e.FirstName, e.LastName, SUM(od.UnitPrice * od.Quantity) / COUNT(DISTINCT o.OrderID) AS sales_performance FROM Employees e INNER JOIN Orders o ON e.EmployeeID = o.EmployeeID INNER JOIN [Order Details] od ON o.OrderID = od.OrderID GROUP BY e.EmployeeID;"}], "prompt_id": "691777a1-e803-4651-9850-4e4daabd90b8"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:Which products are the most profitable based on the unit price, cost, and quantity sold?"}, {"role": "assistant", "content": "SELECT Products.ProductID, (Products.UnitPrice - Products.Cost) * [Order Details].Quantity AS ProductProfit FROM Products INNER JOIN [Order Details] ON Products.ProductID = [Order Details].ProductID;"}], "prompt_id": "4116a40b-63c3-4083-beb4-c1b2afd28c89"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:How often do products hit their reorder level within the previous quarter?"}, {"role": "assistant", "content": "SELECT ProductID, COUNT(OrderID) AS ReorderFrequency FROM [Order Details] WHERE OrderDate >= DATE('now', '-3 month') GROUP BY ProductID HAVING COUNT(OrderID) > 1;"}], "prompt_id": "c70b8b25-5147-4c79-b52a-9cd2e8d36381"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the customer acquisition rate for the current month?"}, {"role": "assistant", "content": "SELECT COUNT(DISTINCT CustomerID) / COUNT(DISTINCT OrderDate) AS AcquisitionRate FROM Orders WHERE OrderDate >= DATE('now', 'start of month')"}], "prompt_id": "ef98ae37-b270-44cc-b016-e6f89b90c349"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the average inventory turnover for each supplier?"}, {"role": "assistant", "content": "SELECT s.CompanyName, SUM(od.UnitPrice * od.Quantity) / AVG(p.UnitsInStock) AS AvgInventoryTurnover FROM Suppliers s INNER JOIN Products p ON s.SupplierID = p.SupplierID INNER JOIN [Order Details] od ON p.ProductID = od.ProductID GROUP BY s.CompanyName"}], "prompt_id": "8a49e19b-3306-4045-81c3-abaa371faa83"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the order cancellation rate for each city?"}, {"role": "assistant", "content": "SELECT Orders.ShipCity, COUNT(CASE WHEN Orders.ShippedDate IS NULL THEN 1 ELSE 0 END) / COUNT(Orders.OrderID) AS CancellationRate FROM Orders GROUP BY Orders.ShipCity"}], "prompt_id": "b4a14059-c41b-49dc-9033-cf288433620c"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:How does the product availability rate vary based on the products' discontinued status?"}, {"role": "assistant", "content": "SELECT Products.Discontinued, COUNT(CASE WHEN Products.UnitsInStock > 0 THEN 1 END) / COUNT(Orders.OrderID) AS AvailabilityRate FROM Products LEFT JOIN [Order Details] ON Products.ProductID = [Order Details].ProductID LEFT JOIN Orders ON [Order Details].OrderID = Orders.OrderID GROUP BY Products.Discontinued"}], "prompt_id": "f0dd59a0-3be8-4100-9be4-82a378085700"}
{"prompt": "You are querying the MDDX database, what is the SQL query for the following question?", "messages": [{"role": "user", "content": "You are querying the MDDX database, what is the SQL query for the following question?\n###Question:What is the rate of customer complaints per order?"}, {"role": "assistant", "content": "SELECT COUNT(Complaints) / COUNT(OrderID) AS ComplaintRate FROM Orders WHERE OrderDate >= DATE('now', '-3 months') AND Complaints IS NOT NULL"}], "prompt_id": "7f395408-00bc-4270-82c8-f30e4a46cffd"}
